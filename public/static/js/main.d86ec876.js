/*! For license information please see main.d86ec876.js.LICENSE.txt */
!function(){var e={757:function(e,t,n){e.exports=n(727)},725:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,a){for(var o,u,s=i(e),c=1;c<arguments.length;c++){for(var l in o=Object(arguments[c]))n.call(o,l)&&(s[l]=o[l]);if(t){u=t(o);for(var h=0;h<u.length;h++)r.call(o,u[h])&&(s[u[h]]=o[u[h]])}}return s}},463:function(e,t,n){"use strict";var r=n(791),i=n(725),a=n(296);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(o(227));var u=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)u.add(t[e])}var h=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d=Object.prototype.hasOwnProperty,v={},p={};function y(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new y(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new y(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new y(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new y(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new y(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new y(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new y(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new y(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new y(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function k(e){return e[1].toUpperCase()}function _(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(v,e)&&(f.test(e)?p[e]=!0:(v[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,k);m[t]=new y(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,k);m[t]=new y(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,k);m[t]=new y(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new y(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new y(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=60103,x=60106,E=60107,S=60108,C=60114,I=60109,T=60110,N=60112,D=60113,A=60120,P=60115,R=60116,O=60121,L=60128,M=60129,F=60130,V=60131;if("function"===typeof Symbol&&Symbol.for){var q=Symbol.for;b=q("react.element"),x=q("react.portal"),E=q("react.fragment"),S=q("react.strict_mode"),C=q("react.profiler"),I=q("react.provider"),T=q("react.context"),N=q("react.forward_ref"),D=q("react.suspense"),A=q("react.suspense_list"),P=q("react.memo"),R=q("react.lazy"),O=q("react.block"),q("react.scope"),L=q("react.opaque.id"),M=q("react.debug_trace_mode"),F=q("react.offscreen"),V=q("react.legacy_hidden")}var U,j="function"===typeof Symbol&&Symbol.iterator;function B(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=j&&e[j]||e["@@iterator"])?e:null}function z(e){if(void 0===U)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||""}return"\n"+U+e}var W=!1;function K(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(s){var r=s}Reflect.construct(e,[],t)}else{try{t.call()}catch(s){r=s}e.call(t.prototype)}else{try{throw Error()}catch(s){r=s}e()}}catch(s){if(s&&r&&"string"===typeof s.stack){for(var i=s.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,u=a.length-1;1<=o&&0<=u&&i[o]!==a[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==a[u]){if(1!==o||1!==u)do{if(o--,0>--u||i[o]!==a[u])return"\n"+i[o].replace(" at new "," at ")}while(1<=o&&0<=u);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function G(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=K(e.type,!1);case 11:return e=K(e.type.render,!1);case 22:return e=K(e.type._render,!1);case 1:return e=K(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case x:return"Portal";case C:return"Profiler";case S:return"StrictMode";case D:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case P:return H(e.type);case O:return H(e._render);case R:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function Q(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Y(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function $(e){e._valueTracker||(e._valueTracker=function(e){var t=Y(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function X(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Y(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=Q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&ie(e,t.type,Q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ie(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ae(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function oe(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ue(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(o(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(o(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Q(n)}}function ce(e,t){var n=Q(t.value),r=Q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var he="http://www.w3.org/1999/xhtml",fe="http://www.w3.org/2000/svg";function de(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ve(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?de(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var pe,ye,me=(ye=function(e,t){if(e.namespaceURI!==fe||"innerHTML"in e)e.innerHTML=t;else{for((pe=pe||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=pe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ye(e,t)}))}:ye);function ge(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ke={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_e=["Webkit","ms","Moz","O"];function we(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||ke.hasOwnProperty(e)&&ke[e]?(""+t).trim():t+"px"}function be(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=we(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(ke).forEach((function(e){_e.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ke[t]=ke[e]}))}));var xe=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ee(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function Se(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Te=null,Ne=null;function De(e){if(e=ri(e)){if("function"!==typeof Ie)throw Error(o(280));var t=e.stateNode;t&&(t=ai(t),Ie(e.stateNode,e.type,t))}}function Ae(e){Te?Ne?Ne.push(e):Ne=[e]:Te=e}function Pe(){if(Te){var e=Te,t=Ne;if(Ne=Te=null,De(e),t)for(e=0;e<t.length;e++)De(t[e])}}function Re(e,t){return e(t)}function Oe(e,t,n,r,i){return e(t,n,r,i)}function Le(){}var Me=Re,Fe=!1,Ve=!1;function qe(){null===Te&&null===Ne||(Le(),Pe())}function Ue(e,t){var n=e.stateNode;if(null===n)return null;var r=ai(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(o(231,t,typeof n));return n}var je=!1;if(h)try{var Be={};Object.defineProperty(Be,"passive",{get:function(){je=!0}}),window.addEventListener("test",Be,Be),window.removeEventListener("test",Be,Be)}catch(ye){je=!1}function ze(e,t,n,r,i,a,o,u,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var We=!1,Ke=null,Ge=!1,He=null,Qe={onError:function(e){We=!0,Ke=e}};function Ye(e,t,n,r,i,a,o,u,s){We=!1,Ke=null,ze.apply(Qe,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Xe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Je(e){if($e(e)!==e)throw Error(o(188))}function Ze(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(o(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Je(i),e;if(a===r)return Je(i),t;a=a.sibling}throw Error(o(188))}if(n.return!==r.return)n=i,r=a;else{for(var u=!1,s=i.child;s;){if(s===n){u=!0,n=i,r=a;break}if(s===r){u=!0,r=i,n=a;break}s=s.sibling}if(!u){for(s=a.child;s;){if(s===n){u=!0,n=a,r=i;break}if(s===r){u=!0,r=a,n=i;break}s=s.sibling}if(!u)throw Error(o(189))}}if(n.alternate!==r)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,it,at=!1,ot=[],ut=null,st=null,ct=null,lt=new Map,ht=new Map,ft=[],dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vt(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function pt(e,t){switch(e){case"focusin":case"focusout":ut=null;break;case"dragenter":case"dragleave":st=null;break;case"mouseover":case"mouseout":ct=null;break;case"pointerover":case"pointerout":lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ht.delete(t.pointerId)}}function yt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e=vt(t,n,r,i,a),null!==t&&(null!==(t=ri(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function mt(e){var t=ni(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Xe(n)))return e.blockedOn=t,void it(e.lanePriority,(function(){a.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function gt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ri(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function kt(e,t,n){gt(e)&&n.delete(t)}function _t(){for(at=!1;0<ot.length;){var e=ot[0];if(null!==e.blockedOn){null!==(e=ri(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&ot.shift()}null!==ut&&gt(ut)&&(ut=null),null!==st&&gt(st)&&(st=null),null!==ct&&gt(ct)&&(ct=null),lt.forEach(kt),ht.forEach(kt)}function wt(e,t){e.blockedOn===t&&(e.blockedOn=null,at||(at=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,_t)))}function bt(e){function t(t){return wt(t,e)}if(0<ot.length){wt(ot[0],e);for(var n=1;n<ot.length;n++){var r=ot[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==ut&&wt(ut,e),null!==st&&wt(st,e),null!==ct&&wt(ct,e),lt.forEach(t),ht.forEach(t),n=0;n<ft.length;n++)(r=ft[n]).blockedOn===e&&(r.blockedOn=null);for(;0<ft.length&&null===(n=ft[0]).blockedOn;)mt(n),null===n.blockedOn&&ft.shift()}function xt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Et={animationend:xt("Animation","AnimationEnd"),animationiteration:xt("Animation","AnimationIteration"),animationstart:xt("Animation","AnimationStart"),transitionend:xt("Transition","TransitionEnd")},St={},Ct={};function It(e){if(St[e])return St[e];if(!Et[e])return e;var t,n=Et[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ct)return St[e]=n[t];return e}h&&(Ct=document.createElement("div").style,"AnimationEvent"in window||(delete Et.animationend.animation,delete Et.animationiteration.animation,delete Et.animationstart.animation),"TransitionEvent"in window||delete Et.transitionend.transition);var Tt=It("animationend"),Nt=It("animationiteration"),Dt=It("animationstart"),At=It("transitionend"),Pt=new Map,Rt=new Map,Ot=["abort","abort",Tt,"animationEnd",Nt,"animationIteration",Dt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",At,"transitionEnd","waiting","waiting"];function Lt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Rt.set(r,t),Pt.set(r,i),c(i,[r])}}(0,a.unstable_now)();var Mt=8;function Ft(e){if(0!==(1&e))return Mt=15,1;if(0!==(2&e))return Mt=14,2;if(0!==(4&e))return Mt=13,4;var t=24&e;return 0!==t?(Mt=12,t):0!==(32&e)?(Mt=11,32):0!==(t=192&e)?(Mt=10,t):0!==(256&e)?(Mt=9,256):0!==(t=3584&e)?(Mt=8,t):0!==(4096&e)?(Mt=7,4096):0!==(t=4186112&e)?(Mt=6,t):0!==(t=62914560&e)?(Mt=5,t):67108864&e?(Mt=4,67108864):0!==(134217728&e)?(Mt=3,134217728):0!==(t=805306368&e)?(Mt=2,t):0!==(1073741824&e)?(Mt=1,1073741824):(Mt=8,e)}function Vt(e,t){var n=e.pendingLanes;if(0===n)return Mt=0;var r=0,i=0,a=e.expiredLanes,o=e.suspendedLanes,u=e.pingedLanes;if(0!==a)r=a,i=Mt=15;else if(0!==(a=134217727&n)){var s=a&~o;0!==s?(r=Ft(s),i=Mt):0!==(u&=a)&&(r=Ft(u),i=Mt)}else 0!==(a=n&~o)?(r=Ft(a),i=Mt):0!==u&&(r=Ft(u),i=Mt);if(0===r)return 0;if(r=n&((0>(r=31-Wt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&o)){if(Ft(t),i<=Mt)return t;Mt=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-Wt(t)),r|=e[n],t&=~i;return r}function qt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Ut(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=jt(24&~t))?Ut(10,t):e;case 10:return 0===(e=jt(192&~t))?Ut(8,t):e;case 8:return 0===(e=jt(3584&~t))&&(0===(e=jt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=jt(805306368&~t))&&(t=268435456),t}throw Error(o(358,e))}function jt(e){return e&-e}function Bt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function zt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-Wt(t)]=n}var Wt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Kt(e)/Gt|0)|0},Kt=Math.log,Gt=Math.LN2;var Ht=a.unstable_UserBlockingPriority,Qt=a.unstable_runWithPriority,Yt=!0;function $t(e,t,n,r){Fe||Le();var i=Jt,a=Fe;Fe=!0;try{Oe(i,e,t,n,r)}finally{(Fe=a)||qe()}}function Xt(e,t,n,r){Qt(Ht,Jt.bind(null,e,t,n,r))}function Jt(e,t,n,r){var i;if(Yt)if((i=0===(4&t))&&0<ot.length&&-1<dt.indexOf(e))e=vt(null,e,t,n,r),ot.push(e);else{var a=Zt(e,t,n,r);if(null===a)i&&pt(e,r);else{if(i){if(-1<dt.indexOf(e))return e=vt(a,e,t,n,r),void ot.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return ut=yt(ut,e,t,n,r,i),!0;case"dragenter":return st=yt(st,e,t,n,r,i),!0;case"mouseover":return ct=yt(ct,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return lt.set(a,yt(lt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,ht.set(a,yt(ht.get(a)||null,e,t,n,r,i)),!0}return!1}(a,e,t,n,r))return;pt(e,r)}Lr(e,t,r,null,n)}}}function Zt(e,t,n,r){var i=Ce(r);if(null!==(i=ni(i))){var a=$e(i);if(null===a)i=null;else{var o=a.tag;if(13===o){if(null!==(i=Xe(a)))return i;i=null}else if(3===o){if(a.stateNode.hydrate)return 3===a.tag?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return Lr(e,t,r,i,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,i="value"in en?en.value:en.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return nn=i.slice(e,1<t?1-t:void 0)}function an(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function un(){return!1}function sn(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?on:un,this.isPropagationStopped=un,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var cn,ln,hn,fn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=sn(fn),vn=i({},fn,{view:0,detail:0}),pn=sn(vn),yn=i({},vn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==hn&&(hn&&"mousemove"===e.type?(cn=e.screenX-hn.screenX,ln=e.screenY-hn.screenY):ln=cn=0,hn=e),cn)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),mn=sn(yn),gn=sn(i({},yn,{dataTransfer:0})),kn=sn(i({},vn,{relatedTarget:0})),_n=sn(i({},fn,{animationName:0,elapsedTime:0,pseudoElement:0})),wn=i({},fn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(wn),xn=sn(i({},fn,{data:0})),En={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function In(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function Tn(){return In}var Nn=i({},vn,{key:function(e){if(e.key){var t=En[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=an(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?an(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?an(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Dn=sn(Nn),An=sn(i({},yn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=sn(i({},vn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Rn=sn(i({},fn,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=i({},yn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ln=sn(On),Mn=[9,13,27,32],Fn=h&&"CompositionEvent"in window,Vn=null;h&&"documentMode"in document&&(Vn=document.documentMode);var qn=h&&"TextEvent"in window&&!Vn,Un=h&&(!Fn||Vn&&8<Vn&&11>=Vn),jn=String.fromCharCode(32),Bn=!1;function zn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Kn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function Qn(e,t,n,r){Ae(r),0<(t=Fr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Yn=null,$n=null;function Xn(e){Nr(e,0)}function Jn(e){if(X(ii(e)))return e}function Zn(e,t){if("change"===e)return t}var er=!1;if(h){var tr;if(h){var nr="oninput"in document;if(!nr){var rr=document.createElement("div");rr.setAttribute("oninput","return;"),nr="function"===typeof rr.oninput}tr=nr}else tr=!1;er=tr&&(!document.documentMode||9<document.documentMode)}function ir(){Yn&&(Yn.detachEvent("onpropertychange",ar),$n=Yn=null)}function ar(e){if("value"===e.propertyName&&Jn($n)){var t=[];if(Qn(t,$n,e,Ce(e)),e=Xn,Fe)e(t);else{Fe=!0;try{Re(e,t)}finally{Fe=!1,qe()}}}}function or(e,t,n){"focusin"===e?(ir(),$n=n,(Yn=t).attachEvent("onpropertychange",ar)):"focusout"===e&&ir()}function ur(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn($n)}function sr(e,t){if("click"===e)return Jn(t)}function cr(e,t){if("input"===e||"change"===e)return Jn(t)}var lr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},hr=Object.prototype.hasOwnProperty;function fr(e,t){if(lr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!hr.call(t,n[r])||!lr(e[n[r]],t[n[r]]))return!1;return!0}function dr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function vr(e,t){var n,r=dr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dr(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function yr(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var gr=h&&"documentMode"in document&&11>=document.documentMode,kr=null,_r=null,wr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==kr||kr!==J(r)||("selectionStart"in(r=kr)&&mr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},wr&&fr(wr,r)||(wr=r,0<(r=Fr(_r,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=kr)))}Lt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Lt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Lt(Ot,2);for(var Er="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Sr=0;Sr<Er.length;Sr++)Rt.set(Er[Sr],0);l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ir=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cr));function Tr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,u,s,c){if(Ye.apply(this,arguments),We){if(!We)throw Error(o(198));var l=Ke;We=!1,Ke=null,Ge||(Ge=!0,He=l)}}(r,t,void 0,e),e.currentTarget=null}function Nr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],s=u.instance,c=u.currentTarget;if(u=u.listener,s!==a&&i.isPropagationStopped())break e;Tr(i,u,c),a=s}else for(o=0;o<r.length;o++){if(s=(u=r[o]).instance,c=u.currentTarget,u=u.listener,s!==a&&i.isPropagationStopped())break e;Tr(i,u,c),a=s}}}if(Ge)throw e=He,Ge=!1,He=null,e}function Dr(e,t){var n=oi(t),r=e+"__bubble";n.has(r)||(Or(t,e,2,!1),n.add(r))}var Ar="_reactListening"+Math.random().toString(36).slice(2);function Pr(e){e[Ar]||(e[Ar]=!0,u.forEach((function(t){Ir.has(t)||Rr(t,!1,e,null),Rr(t,!0,e,null)})))}function Rr(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,a=n;if("selectionchange"===e&&9!==n.nodeType&&(a=n.ownerDocument),null!==r&&!t&&Ir.has(e)){if("scroll"!==e)return;i|=2,a=r}var o=oi(a),u=e+"__"+(t?"capture":"bubble");o.has(u)||(t&&(i|=4),Or(a,e,i,t),o.add(u))}function Or(e,t,n,r){var i=Rt.get(t);switch(void 0===i?2:i){case 0:i=$t;break;case 1:i=Xt;break;default:i=Jt}n=i.bind(null,t,n,e),i=void 0,!je||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Lr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var u=r.stateNode.containerInfo;if(u===i||8===u.nodeType&&u.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var s=o.tag;if((3===s||4===s)&&((s=o.stateNode.containerInfo)===i||8===s.nodeType&&s.parentNode===i))return;o=o.return}for(;null!==u;){if(null===(o=ni(u)))return;if(5===(s=o.tag)||6===s){r=a=o;continue e}u=u.parentNode}}r=r.return}!function(e,t,n){if(Ve)return e(t,n);Ve=!0;try{Me(e,t,n)}finally{Ve=!1,qe()}}((function(){var r=a,i=Ce(n),o=[];e:{var u=Pt.get(e);if(void 0!==u){var s=dn,c=e;switch(e){case"keypress":if(0===an(n))break e;case"keydown":case"keyup":s=Dn;break;case"focusin":c="focus",s=kn;break;case"focusout":c="blur",s=kn;break;case"beforeblur":case"afterblur":s=kn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Pn;break;case Tt:case Nt:case Dt:s=_n;break;case At:s=Rn;break;case"scroll":s=pn;break;case"wheel":s=Ln;break;case"copy":case"cut":case"paste":s=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=An}var l=0!==(4&t),h=!l&&"scroll"===e,f=l?null!==u?u+"Capture":null:u;l=[];for(var d,v=r;null!==v;){var p=(d=v).stateNode;if(5===d.tag&&null!==p&&(d=p,null!==f&&(null!=(p=Ue(v,f))&&l.push(Mr(v,p,d)))),h)break;v=v.return}0<l.length&&(u=new s(u,c,null,n,i),o.push({event:u,listeners:l}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(u="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(c=n.relatedTarget||n.fromElement)||!ni(c)&&!c[ei])&&(s||u)&&(u=i.window===i?i:(u=i.ownerDocument)?u.defaultView||u.parentWindow:window,s?(s=r,null!==(c=(c=n.relatedTarget||n.toElement)?ni(c):null)&&(c!==(h=$e(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=r),s!==c)){if(l=mn,p="onMouseLeave",f="onMouseEnter",v="mouse","pointerout"!==e&&"pointerover"!==e||(l=An,p="onPointerLeave",f="onPointerEnter",v="pointer"),h=null==s?u:ii(s),d=null==c?u:ii(c),(u=new l(p,v+"leave",s,n,i)).target=h,u.relatedTarget=d,p=null,ni(i)===r&&((l=new l(f,v+"enter",c,n,i)).target=d,l.relatedTarget=h,p=l),h=p,s&&c)e:{for(f=c,v=0,d=l=s;d;d=Vr(d))v++;for(d=0,p=f;p;p=Vr(p))d++;for(;0<v-d;)l=Vr(l),v--;for(;0<d-v;)f=Vr(f),d--;for(;v--;){if(l===f||null!==f&&l===f.alternate)break e;l=Vr(l),f=Vr(f)}l=null}else l=null;null!==s&&qr(o,u,s,l,!1),null!==c&&null!==h&&qr(o,h,c,l,!0)}if("select"===(s=(u=r?ii(r):window).nodeName&&u.nodeName.toLowerCase())||"input"===s&&"file"===u.type)var y=Zn;else if(Hn(u))if(er)y=cr;else{y=ur;var m=or}else(s=u.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===u.type||"radio"===u.type)&&(y=sr);switch(y&&(y=y(e,r))?Qn(o,y,n,i):(m&&m(e,u,r),"focusout"===e&&(m=u._wrapperState)&&m.controlled&&"number"===u.type&&ie(u,"number",u.value)),m=r?ii(r):window,e){case"focusin":(Hn(m)||"true"===m.contentEditable)&&(kr=m,_r=r,wr=null);break;case"focusout":wr=_r=kr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":xr(o,n,i)}var g;if(Fn)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Kn?zn(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Un&&"ko"!==n.locale&&(Kn||"onCompositionStart"!==k?"onCompositionEnd"===k&&Kn&&(g=rn()):(tn="value"in(en=i)?en.value:en.textContent,Kn=!0)),0<(m=Fr(r,k)).length&&(k=new xn(k,e,null,n,i),o.push({event:k,listeners:m}),g?k.data=g:null!==(g=Wn(n))&&(k.data=g))),(g=qn?function(e,t){switch(e){case"compositionend":return Wn(t);case"keypress":return 32!==t.which?null:(Bn=!0,jn);case"textInput":return(e=t.data)===jn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Kn)return"compositionend"===e||!Fn&&zn(e,t)?(e=rn(),nn=tn=en=null,Kn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Fr(r,"onBeforeInput")).length&&(i=new xn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=g))}Nr(o,t)}))}function Mr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Ue(e,n))&&r.unshift(Mr(e,a,i)),null!=(a=Ue(e,t))&&r.push(Mr(e,a,i))),e=e.return}return r}function Vr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var u=n,s=u.alternate,c=u.stateNode;if(null!==s&&s===r)break;5===u.tag&&null!==c&&(u=c,i?null!=(s=Ue(n,a))&&o.unshift(Mr(n,s,u)):i||null!=(s=Ue(n,a))&&o.push(Mr(n,s,u))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}function Ur(){}var jr=null,Br=null;function zr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Wr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Kr="function"===typeof setTimeout?setTimeout:void 0,Gr="function"===typeof clearTimeout?clearTimeout:void 0;function Hr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Qr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Yr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var $r=0;var Xr=Math.random().toString(36).slice(2),Jr="__reactFiber$"+Xr,Zr="__reactProps$"+Xr,ei="__reactContainer$"+Xr,ti="__reactEvents$"+Xr;function ni(e){var t=e[Jr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ei]||n[Jr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Yr(e);null!==e;){if(n=e[Jr])return n;e=Yr(e)}return t}n=(e=n).parentNode}return null}function ri(e){return!(e=e[Jr]||e[ei])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ii(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function ai(e){return e[Zr]||null}function oi(e){var t=e[ti];return void 0===t&&(t=e[ti]=new Set),t}var ui=[],si=-1;function ci(e){return{current:e}}function li(e){0>si||(e.current=ui[si],ui[si]=null,si--)}function hi(e,t){si++,ui[si]=e.current,e.current=t}var fi={},di=ci(fi),vi=ci(!1),pi=fi;function yi(e,t){var n=e.type.contextTypes;if(!n)return fi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function mi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function gi(){li(vi),li(di)}function ki(e,t,n){if(di.current!==fi)throw Error(o(168));hi(di,t),hi(vi,n)}function _i(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(o(108,H(t)||"Unknown",a));return i({},n,r)}function wi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fi,pi=di.current,hi(di,e),hi(vi,vi.current),!0}function bi(e,t,n){var r=e.stateNode;if(!r)throw Error(o(169));n?(e=_i(e,t,pi),r.__reactInternalMemoizedMergedChildContext=e,li(vi),li(di),hi(di,e)):li(vi),hi(vi,n)}var xi=null,Ei=null,Si=a.unstable_runWithPriority,Ci=a.unstable_scheduleCallback,Ii=a.unstable_cancelCallback,Ti=a.unstable_shouldYield,Ni=a.unstable_requestPaint,Di=a.unstable_now,Ai=a.unstable_getCurrentPriorityLevel,Pi=a.unstable_ImmediatePriority,Ri=a.unstable_UserBlockingPriority,Oi=a.unstable_NormalPriority,Li=a.unstable_LowPriority,Mi=a.unstable_IdlePriority,Fi={},Vi=void 0!==Ni?Ni:function(){},qi=null,Ui=null,ji=!1,Bi=Di(),zi=1e4>Bi?Di:function(){return Di()-Bi};function Wi(){switch(Ai()){case Pi:return 99;case Ri:return 98;case Oi:return 97;case Li:return 96;case Mi:return 95;default:throw Error(o(332))}}function Ki(e){switch(e){case 99:return Pi;case 98:return Ri;case 97:return Oi;case 96:return Li;case 95:return Mi;default:throw Error(o(332))}}function Gi(e,t){return e=Ki(e),Si(e,t)}function Hi(e,t,n){return e=Ki(e),Ci(e,t,n)}function Qi(){if(null!==Ui){var e=Ui;Ui=null,Ii(e)}Yi()}function Yi(){if(!ji&&null!==qi){ji=!0;var e=0;try{var t=qi;Gi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),qi=null}catch(n){throw null!==qi&&(qi=qi.slice(e+1)),Ci(Pi,Qi),n}finally{ji=!1}}}var $i=w.ReactCurrentBatchConfig;function Xi(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Ji=ci(null),Zi=null,ea=null,ta=null;function na(){ta=ea=Zi=null}function ra(e){var t=Ji.current;li(Ji),e.type._context._currentValue=t}function ia(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function aa(e,t){Zi=e,ta=ea=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Fo=!0),e.firstContext=null)}function oa(e,t){if(ta!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(ta=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ea){if(null===Zi)throw Error(o(308));ea=t,Zi.dependencies={lanes:0,firstContext:t,responders:null}}else ea=ea.next=t;return e._currentValue}var ua=!1;function sa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ca(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function la(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ha(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function fa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function da(e,t,n,r){var a=e.updateQueue;ua=!1;var o=a.firstBaseUpdate,u=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var c=s,l=c.next;c.next=null,null===u?o=l:u.next=l,u=c;var h=e.alternate;if(null!==h){var f=(h=h.updateQueue).lastBaseUpdate;f!==u&&(null===f?h.firstBaseUpdate=l:f.next=l,h.lastBaseUpdate=c)}}if(null!==o){for(f=a.baseState,u=0,h=l=c=null;;){s=o.lane;var d=o.eventTime;if((r&s)===s){null!==h&&(h=h.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,p=o;switch(s=t,d=n,p.tag){case 1:if("function"===typeof(v=p.payload)){f=v.call(d,f,s);break e}f=v;break e;case 3:v.flags=-4097&v.flags|64;case 0:if(null===(s="function"===typeof(v=p.payload)?v.call(d,f,s):v)||void 0===s)break e;f=i({},f,s);break e;case 2:ua=!0}}null!==o.callback&&(e.flags|=32,null===(s=a.effects)?a.effects=[o]:s.push(o))}else d={eventTime:d,lane:s,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===h?(l=h=d,c=f):h=h.next=d,u|=s;if(null===(o=o.next)){if(null===(s=a.shared.pending))break;o=s.next,s.next=null,a.lastBaseUpdate=s,a.shared.pending=null}}null===h&&(c=f),a.baseState=c,a.firstBaseUpdate=l,a.lastBaseUpdate=h,ju|=u,e.lanes=u,e.memoizedState=f}}function va(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(o(191,i));i.call(r)}}}var pa=(new r.Component).refs;function ya(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ma={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=fs(),i=ds(e),a=la(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),ha(e,a),vs(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=fs(),i=ds(e),a=la(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),ha(e,a),vs(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=fs(),r=ds(e),i=la(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),ha(e,i),vs(e,r,n)}};function ga(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!fr(n,r)||!fr(i,a))}function ka(e,t,n){var r=!1,i=fi,a=t.contextType;return"object"===typeof a&&null!==a?a=oa(a):(i=mi(t)?pi:di.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?yi(e,i):fi),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ma,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function _a(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ma.enqueueReplaceState(t,t.state,null)}function wa(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=pa,sa(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=oa(a):(a=mi(t)?pi:di.current,i.context=yi(e,a)),da(e,n,i,r),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(ya(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ma.enqueueReplaceState(i,i.state,null),da(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4)}var ba=Array.isArray;function xa(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var r=n.stateNode}if(!r)throw Error(o(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===pa&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(o(284));if(!n._owner)throw Error(o(290,e))}return e}function Ea(e,t){if("textarea"!==e.type)throw Error(o(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Sa(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Gs(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function u(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=$s(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=xa(e,t,n),r.return=e,r):((r=Hs(n.type,n.key,n.props,null,e.mode,r)).ref=xa(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Xs(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Qs(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=$s(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case b:return(n=Hs(t.type,t.key,t.props,null,e.mode,n)).ref=xa(e,null,t),n.return=e,n;case x:return(t=Xs(t,e.mode,n)).return=e,t}if(ba(t)||B(t))return(t=Qs(t,e.mode,n,null)).return=e,t;Ea(e,t)}return null}function d(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===i?n.type===E?h(e,t,n.props.children,r,i):c(e,t,n,r):null;case x:return n.key===i?l(e,t,n,r):null}if(ba(n)||B(n))return null!==i?null:h(e,t,n,r,null);Ea(e,n)}return null}function v(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case b:return e=e.get(null===r.key?n:r.key)||null,r.type===E?h(t,e,r.props.children,i,r.key):c(t,e,r,i);case x:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(ba(r)||B(r))return h(t,e=e.get(n)||null,r,i,null);Ea(t,r)}return null}function p(i,o,u,s){for(var c=null,l=null,h=o,p=o=0,y=null;null!==h&&p<u.length;p++){h.index>p?(y=h,h=null):y=h.sibling;var m=d(i,h,u[p],s);if(null===m){null===h&&(h=y);break}e&&h&&null===m.alternate&&t(i,h),o=a(m,o,p),null===l?c=m:l.sibling=m,l=m,h=y}if(p===u.length)return n(i,h),c;if(null===h){for(;p<u.length;p++)null!==(h=f(i,u[p],s))&&(o=a(h,o,p),null===l?c=h:l.sibling=h,l=h);return c}for(h=r(i,h);p<u.length;p++)null!==(y=v(h,i,p,u[p],s))&&(e&&null!==y.alternate&&h.delete(null===y.key?p:y.key),o=a(y,o,p),null===l?c=y:l.sibling=y,l=y);return e&&h.forEach((function(e){return t(i,e)})),c}function y(i,u,s,c){var l=B(s);if("function"!==typeof l)throw Error(o(150));if(null==(s=l.call(s)))throw Error(o(151));for(var h=l=null,p=u,y=u=0,m=null,g=s.next();null!==p&&!g.done;y++,g=s.next()){p.index>y?(m=p,p=null):m=p.sibling;var k=d(i,p,g.value,c);if(null===k){null===p&&(p=m);break}e&&p&&null===k.alternate&&t(i,p),u=a(k,u,y),null===h?l=k:h.sibling=k,h=k,p=m}if(g.done)return n(i,p),l;if(null===p){for(;!g.done;y++,g=s.next())null!==(g=f(i,g.value,c))&&(u=a(g,u,y),null===h?l=g:h.sibling=g,h=g);return l}for(p=r(i,p);!g.done;y++,g=s.next())null!==(g=v(p,i,y,g.value,c))&&(e&&null!==g.alternate&&p.delete(null===g.key?y:g.key),u=a(g,u,y),null===h?l=g:h.sibling=g,h=g);return e&&p.forEach((function(e){return t(i,e)})),l}return function(e,r,a,s){var c="object"===typeof a&&null!==a&&a.type===E&&null===a.key;c&&(a=a.props.children);var l="object"===typeof a&&null!==a;if(l)switch(a.$$typeof){case b:e:{for(l=a.key,c=r;null!==c;){if(c.key===l){if(7===c.tag){if(a.type===E){n(e,c.sibling),(r=i(c,a.props.children)).return=e,e=r;break e}}else if(c.elementType===a.type){n(e,c.sibling),(r=i(c,a.props)).ref=xa(e,c,a),r.return=e,e=r;break e}n(e,c);break}t(e,c),c=c.sibling}a.type===E?((r=Qs(a.props.children,e.mode,s,a.key)).return=e,e=r):((s=Hs(a.type,a.key,a.props,null,e.mode,s)).ref=xa(e,r,a),s.return=e,e=s)}return u(e);case x:e:{for(c=a.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){n(e,r.sibling),(r=i(r,a.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Xs(a,e.mode,s)).return=e,e=r}return u(e)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,a)).return=e,e=r):(n(e,r),(r=$s(a,e.mode,s)).return=e,e=r),u(e);if(ba(a))return p(e,r,a,s);if(B(a))return y(e,r,a,s);if(l&&Ea(e,a),"undefined"===typeof a&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(o(152,H(e.type)||"Component"))}return n(e,r)}}var Ca=Sa(!0),Ia=Sa(!1),Ta={},Na=ci(Ta),Da=ci(Ta),Aa=ci(Ta);function Pa(e){if(e===Ta)throw Error(o(174));return e}function Ra(e,t){switch(hi(Aa,t),hi(Da,e),hi(Na,Ta),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ve(null,"");break;default:t=ve(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}li(Na),hi(Na,t)}function Oa(){li(Na),li(Da),li(Aa)}function La(e){Pa(Aa.current);var t=Pa(Na.current),n=ve(t,e.type);t!==n&&(hi(Da,e),hi(Na,n))}function Ma(e){Da.current===e&&(li(Na),li(Da))}var Fa=ci(0);function Va(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var qa=null,Ua=null,ja=!1;function Ba(e,t){var n=Ws(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function za(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Wa(e){if(ja){var t=Ua;if(t){var n=t;if(!za(e,t)){if(!(t=Qr(n.nextSibling))||!za(e,t))return e.flags=-1025&e.flags|2,ja=!1,void(qa=e);Ba(qa,n)}qa=e,Ua=Qr(t.firstChild)}else e.flags=-1025&e.flags|2,ja=!1,qa=e}}function Ka(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;qa=e}function Ga(e){if(e!==qa)return!1;if(!ja)return Ka(e),ja=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Wr(t,e.memoizedProps))for(t=Ua;t;)Ba(e,t),t=Qr(t.nextSibling);if(Ka(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Ua=Qr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Ua=null}}else Ua=qa?Qr(e.stateNode.nextSibling):null;return!0}function Ha(){Ua=qa=null,ja=!1}var Qa=[];function Ya(){for(var e=0;e<Qa.length;e++)Qa[e]._workInProgressVersionPrimary=null;Qa.length=0}var $a=w.ReactCurrentDispatcher,Xa=w.ReactCurrentBatchConfig,Ja=0,Za=null,eo=null,to=null,no=!1,ro=!1;function io(){throw Error(o(321))}function ao(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function oo(e,t,n,r,i,a){if(Ja=a,Za=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$a.current=null===e||null===e.memoizedState?Ro:Oo,e=n(r,i),ro){a=0;do{if(ro=!1,!(25>a))throw Error(o(301));a+=1,to=eo=null,t.updateQueue=null,$a.current=Lo,e=n(r,i)}while(ro)}if($a.current=Po,t=null!==eo&&null!==eo.next,Ja=0,to=eo=Za=null,no=!1,t)throw Error(o(300));return e}function uo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===to?Za.memoizedState=to=e:to=to.next=e,to}function so(){if(null===eo){var e=Za.alternate;e=null!==e?e.memoizedState:null}else e=eo.next;var t=null===to?Za.memoizedState:to.next;if(null!==t)to=t,eo=e;else{if(null===e)throw Error(o(310));e={memoizedState:(eo=e).memoizedState,baseState:eo.baseState,baseQueue:eo.baseQueue,queue:eo.queue,next:null},null===to?Za.memoizedState=to=e:to=to.next=e}return to}function co(e,t){return"function"===typeof t?t(e):t}function lo(e){var t=so(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=eo,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var u=i.next;i.next=a.next,a.next=u}r.baseQueue=i=a,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var s=u=a=null,c=i;do{var l=c.lane;if((Ja&l)===l)null!==s&&(s=s.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),r=c.eagerReducer===e?c.eagerState:e(r,c.action);else{var h={lane:l,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===s?(u=s=h,a=r):s=s.next=h,Za.lanes|=l,ju|=l}c=c.next}while(null!==c&&c!==i);null===s?a=r:s.next=u,lr(r,t.memoizedState)||(Fo=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=s,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ho(e){var t=so(),n=t.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var u=i=i.next;do{a=e(a,u.action),u=u.next}while(u!==i);lr(a,t.memoizedState)||(Fo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function fo(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(Ja&e)===e)&&(t._workInProgressVersionPrimary=r,Qa.push(t))),e)return n(t._source);throw Qa.push(t),Error(o(350))}function vo(e,t,n,r){var i=Ru;if(null===i)throw Error(o(349));var a=t._getVersion,u=a(t._source),s=$a.current,c=s.useState((function(){return fo(i,t,n)})),l=c[1],h=c[0];c=to;var f=e.memoizedState,d=f.refs,v=d.getSnapshot,p=f.source;f=f.subscribe;var y=Za;return e.memoizedState={refs:d,source:t,subscribe:r},s.useEffect((function(){d.getSnapshot=n,d.setSnapshot=l;var e=a(t._source);if(!lr(u,e)){e=n(t._source),lr(h,e)||(l(e),e=ds(y),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,o=e;0<o;){var s=31-Wt(o),c=1<<s;r[s]|=e,o&=~c}}}),[n,t,r]),s.useEffect((function(){return r(t._source,(function(){var e=d.getSnapshot,n=d.setSnapshot;try{n(e(t._source));var r=ds(y);i.mutableReadLanes|=r&i.pendingLanes}catch(a){n((function(){throw a}))}}))}),[t,r]),lr(v,n)&&lr(p,t)&&lr(f,r)||((e={pending:null,dispatch:null,lastRenderedReducer:co,lastRenderedState:h}).dispatch=l=Ao.bind(null,Za,e),c.queue=e,c.baseQueue=null,h=fo(i,t,n),c.memoizedState=c.baseState=h),h}function po(e,t,n){return vo(so(),e,t,n)}function yo(e){var t=uo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:co,lastRenderedState:e}).dispatch=Ao.bind(null,Za,e),[t.memoizedState,e]}function mo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Za.updateQueue)?(t={lastEffect:null},Za.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function go(e){return e={current:e},uo().memoizedState=e}function ko(){return so().memoizedState}function _o(e,t,n,r){var i=uo();Za.flags|=e,i.memoizedState=mo(1|t,n,void 0,void 0===r?null:r)}function wo(e,t,n,r){var i=so();r=void 0===r?null:r;var a=void 0;if(null!==eo){var o=eo.memoizedState;if(a=o.destroy,null!==r&&ao(r,o.deps))return void mo(t,n,a,r)}Za.flags|=e,i.memoizedState=mo(1|t,n,a,r)}function bo(e,t){return _o(516,4,e,t)}function xo(e,t){return wo(516,4,e,t)}function Eo(e,t){return wo(4,2,e,t)}function So(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Co(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,wo(4,2,So.bind(null,t,e),n)}function Io(){}function To(e,t){var n=so();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ao(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function No(e,t){var n=so();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ao(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Do(e,t){var n=Wi();Gi(98>n?98:n,(function(){e(!0)})),Gi(97<n?97:n,(function(){var n=Xa.transition;Xa.transition=1;try{e(!1),t()}finally{Xa.transition=n}}))}function Ao(e,t,n){var r=fs(),i=ds(e),a={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?a.next=a:(a.next=o.next,o.next=a),t.pending=a,o=e.alternate,e===Za||null!==o&&o===Za)ro=no=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var u=t.lastRenderedState,s=o(u,n);if(a.eagerReducer=o,a.eagerState=s,lr(s,u))return}catch(c){}vs(e,i,r)}}var Po={readContext:oa,useCallback:io,useContext:io,useEffect:io,useImperativeHandle:io,useLayoutEffect:io,useMemo:io,useReducer:io,useRef:io,useState:io,useDebugValue:io,useDeferredValue:io,useTransition:io,useMutableSource:io,useOpaqueIdentifier:io,unstable_isNewReconciler:!1},Ro={readContext:oa,useCallback:function(e,t){return uo().memoizedState=[e,void 0===t?null:t],e},useContext:oa,useEffect:bo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,_o(4,2,So.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _o(4,2,e,t)},useMemo:function(e,t){var n=uo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=uo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Ao.bind(null,Za,e),[r.memoizedState,e]},useRef:go,useState:yo,useDebugValue:Io,useDeferredValue:function(e){var t=yo(e),n=t[0],r=t[1];return bo((function(){var t=Xa.transition;Xa.transition=1;try{r(e)}finally{Xa.transition=t}}),[e]),n},useTransition:function(){var e=yo(!1),t=e[0];return go(e=Do.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=uo();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},vo(r,e,t,n)},useOpaqueIdentifier:function(){if(ja){var e=!1,t=function(e){return{$$typeof:L,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+($r++).toString(36))),Error(o(355))})),n=yo(t)[1];return 0===(2&Za.mode)&&(Za.flags|=516,mo(5,(function(){n("r:"+($r++).toString(36))}),void 0,null)),t}return yo(t="r:"+($r++).toString(36)),t},unstable_isNewReconciler:!1},Oo={readContext:oa,useCallback:To,useContext:oa,useEffect:xo,useImperativeHandle:Co,useLayoutEffect:Eo,useMemo:No,useReducer:lo,useRef:ko,useState:function(){return lo(co)},useDebugValue:Io,useDeferredValue:function(e){var t=lo(co),n=t[0],r=t[1];return xo((function(){var t=Xa.transition;Xa.transition=1;try{r(e)}finally{Xa.transition=t}}),[e]),n},useTransition:function(){var e=lo(co)[0];return[ko().current,e]},useMutableSource:po,useOpaqueIdentifier:function(){return lo(co)[0]},unstable_isNewReconciler:!1},Lo={readContext:oa,useCallback:To,useContext:oa,useEffect:xo,useImperativeHandle:Co,useLayoutEffect:Eo,useMemo:No,useReducer:ho,useRef:ko,useState:function(){return ho(co)},useDebugValue:Io,useDeferredValue:function(e){var t=ho(co),n=t[0],r=t[1];return xo((function(){var t=Xa.transition;Xa.transition=1;try{r(e)}finally{Xa.transition=t}}),[e]),n},useTransition:function(){var e=ho(co)[0];return[ko().current,e]},useMutableSource:po,useOpaqueIdentifier:function(){return ho(co)[0]},unstable_isNewReconciler:!1},Mo=w.ReactCurrentOwner,Fo=!1;function Vo(e,t,n,r){t.child=null===e?Ia(t,null,n,r):Ca(t,e.child,n,r)}function qo(e,t,n,r,i){n=n.render;var a=t.ref;return aa(t,i),r=oo(e,t,n,r,a,i),null===e||Fo?(t.flags|=1,Vo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,au(e,t,i))}function Uo(e,t,n,r,i,a){if(null===e){var o=n.type;return"function"!==typeof o||Ks(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Hs(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,jo(e,t,o,r,i,a))}return o=e.child,0===(i&a)&&(i=o.memoizedProps,(n=null!==(n=n.compare)?n:fr)(i,r)&&e.ref===t.ref)?au(e,t,a):(t.flags|=1,(e=Gs(o,r)).ref=t.ref,e.return=t,t.child=e)}function jo(e,t,n,r,i,a){if(null!==e&&fr(e.memoizedProps,r)&&e.ref===t.ref){if(Fo=!1,0===(a&i))return t.lanes=e.lanes,au(e,t,a);0!==(16384&e.flags)&&(Fo=!0)}return Wo(e,t,n,r,a)}function Bo(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},bs(t,n);else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},bs(t,e),null;t.memoizedState={baseLanes:0},bs(t,null!==a?a.baseLanes:n)}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,bs(t,r);return Vo(e,t,i,n),t.child}function zo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Wo(e,t,n,r,i){var a=mi(n)?pi:di.current;return a=yi(t,a),aa(t,i),n=oo(e,t,n,r,a,i),null===e||Fo?(t.flags|=1,Vo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,au(e,t,i))}function Ko(e,t,n,r,i){if(mi(n)){var a=!0;wi(t)}else a=!1;if(aa(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),ka(t,n,r),wa(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,u=t.memoizedProps;o.props=u;var s=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=oa(c):c=yi(t,c=mi(n)?pi:di.current);var l=n.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==r||s!==c)&&_a(t,o,r,c),ua=!1;var f=t.memoizedState;o.state=f,da(t,r,o,i),s=t.memoizedState,u!==r||f!==s||vi.current||ua?("function"===typeof l&&(ya(t,n,l,r),s=t.memoizedState),(u=ua||ga(t,n,u,r,f,s,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4)):("function"===typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=s),o.props=r,o.state=s,o.context=c,r=u):("function"===typeof o.componentDidMount&&(t.flags|=4),r=!1)}else{o=t.stateNode,ca(e,t),u=t.memoizedProps,c=t.type===t.elementType?u:Xi(t.type,u),o.props=c,h=t.pendingProps,f=o.context,"object"===typeof(s=n.contextType)&&null!==s?s=oa(s):s=yi(t,s=mi(n)?pi:di.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==h||f!==s)&&_a(t,o,r,s),ua=!1,f=t.memoizedState,o.state=f,da(t,r,o,i);var v=t.memoizedState;u!==h||f!==v||vi.current||ua?("function"===typeof d&&(ya(t,n,d,r),v=t.memoizedState),(c=ua||ga(t,n,c,r,f,v,s))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,v,s),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,v,s)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=v),o.props=r,o.state=v,o.context=s,r=c):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&f===e.memoizedState||(t.flags|=256),r=!1)}return Go(e,t,n,r,a,i)}function Go(e,t,n,r,i,a){zo(e,t);var o=0!==(64&t.flags);if(!r&&!o)return i&&bi(t,n,!1),au(e,t,a);r=t.stateNode,Mo.current=t;var u=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ca(t,e.child,null,a),t.child=Ca(t,null,u,a)):Vo(e,t,u,a),t.memoizedState=r.state,i&&bi(t,n,!0),t.child}function Ho(e){var t=e.stateNode;t.pendingContext?ki(0,t.pendingContext,t.pendingContext!==t.context):t.context&&ki(0,t.context,!1),Ra(e,t.containerInfo)}var Qo,Yo,$o,Xo={dehydrated:null,retryLane:0};function Jo(e,t,n){var r,i=t.pendingProps,a=Fa.current,o=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(a|=1),hi(Fa,1&a),null===e?(void 0!==i.fallback&&Wa(t),e=i.children,a=i.fallback,o?(e=Zo(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Xo,e):"number"===typeof i.unstable_expectedLoadTime?(e=Zo(t,e,a,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Xo,t.lanes=33554432,e):((n=Ys({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,o?(i=tu(e,t,i.children,i.fallback,n),o=t.child,a=e.child.memoizedState,o.memoizedState=null===a?{baseLanes:n}:{baseLanes:a.baseLanes|n},o.childLanes=e.childLanes&~n,t.memoizedState=Xo,i):(n=eu(e,t,i.children,n),t.memoizedState=null,n))}function Zo(e,t,n,r){var i=e.mode,a=e.child;return t={mode:"hidden",children:t},0===(2&i)&&null!==a?(a.childLanes=0,a.pendingProps=t):a=Ys(t,i,0,null),n=Qs(n,i,r,null),a.return=e,n.return=e,a.sibling=n,e.child=a,n}function eu(e,t,n,r){var i=e.child;return e=i.sibling,n=Gs(i,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function tu(e,t,n,r,i){var a=t.mode,o=e.child;e=o.sibling;var u={mode:"hidden",children:n};return 0===(2&a)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=u,null!==(o=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Gs(o,u),null!==e?r=Gs(e,r):(r=Qs(r,a,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function nu(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ia(e.return,t)}function ru(e,t,n,r,i,a){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i,o.lastEffect=a)}function iu(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Vo(e,t,r.children,n),0!==(2&(r=Fa.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&nu(e,n);else if(19===e.tag)nu(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(hi(Fa,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Va(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),ru(t,!1,i,n,a,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Va(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}ru(t,!0,n,null,a,t.lastEffect);break;case"together":ru(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function au(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),ju|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(n=Gs(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Gs(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function ou(e,t){if(!ja)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function uu(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return mi(t.type)&&gi(),null;case 3:return Oa(),li(vi),li(di),Ya(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Ga(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Ma(t);var a=Pa(Aa.current);if(n=t.type,null!==e&&null!=t.stateNode)Yo(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(o(166));return null}if(e=Pa(Na.current),Ga(t)){r=t.stateNode,n=t.type;var u=t.memoizedProps;switch(r[Jr]=t,r[Zr]=u,n){case"dialog":Dr("cancel",r),Dr("close",r);break;case"iframe":case"object":case"embed":Dr("load",r);break;case"video":case"audio":for(e=0;e<Cr.length;e++)Dr(Cr[e],r);break;case"source":Dr("error",r);break;case"img":case"image":case"link":Dr("error",r),Dr("load",r);break;case"details":Dr("toggle",r);break;case"input":ee(r,u),Dr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!u.multiple},Dr("invalid",r);break;case"textarea":se(r,u),Dr("invalid",r)}for(var c in Ee(n,u),e=null,u)u.hasOwnProperty(c)&&(a=u[c],"children"===c?"string"===typeof a?r.textContent!==a&&(e=["children",a]):"number"===typeof a&&r.textContent!==""+a&&(e=["children",""+a]):s.hasOwnProperty(c)&&null!=a&&"onScroll"===c&&Dr("scroll",r));switch(n){case"input":$(r),re(r,u,!0);break;case"textarea":$(r),le(r);break;case"select":case"option":break;default:"function"===typeof u.onClick&&(r.onclick=Ur)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(c=9===a.nodeType?a:a.ownerDocument,e===he&&(e=de(n)),e===he?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Jr]=t,e[Zr]=r,Qo(e,t),t.stateNode=e,c=Se(n,r),n){case"dialog":Dr("cancel",e),Dr("close",e),a=r;break;case"iframe":case"object":case"embed":Dr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Cr.length;a++)Dr(Cr[a],e);a=r;break;case"source":Dr("error",e),a=r;break;case"img":case"image":case"link":Dr("error",e),Dr("load",e),a=r;break;case"details":Dr("toggle",e),a=r;break;case"input":ee(e,r),a=Z(e,r),Dr("invalid",e);break;case"option":a=ae(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=i({},r,{value:void 0}),Dr("invalid",e);break;case"textarea":se(e,r),a=ue(e,r),Dr("invalid",e);break;default:a=r}Ee(n,a);var l=a;for(u in l)if(l.hasOwnProperty(u)){var h=l[u];"style"===u?be(e,h):"dangerouslySetInnerHTML"===u?null!=(h=h?h.__html:void 0)&&me(e,h):"children"===u?"string"===typeof h?("textarea"!==n||""!==h)&&ge(e,h):"number"===typeof h&&ge(e,""+h):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?null!=h&&"onScroll"===u&&Dr("scroll",e):null!=h&&_(e,u,h,c))}switch(n){case"input":$(e),re(e,r,!1);break;case"textarea":$(e),le(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(u=r.value)?oe(e,!!r.multiple,u,!1):null!=r.defaultValue&&oe(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Ur)}zr(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)$o(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(o(166));n=Pa(Aa.current),Pa(Na.current),Ga(t)?(r=t.stateNode,n=t.memoizedProps,r[Jr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Jr]=t,t.stateNode=r)}return null;case 13:return li(Fa),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Ga(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Fa.current)?0===Vu&&(Vu=3):(0!==Vu&&3!==Vu||(Vu=4),null===Ru||0===(134217727&ju)&&0===(134217727&Bu)||gs(Ru,Lu))),(r||n)&&(t.flags|=4),null);case 4:return Oa(),null===e&&Pr(t.stateNode.containerInfo),null;case 10:return ra(t),null;case 19:if(li(Fa),null===(r=t.memoizedState))return null;if(u=0!==(64&t.flags),null===(c=r.rendering))if(u)ou(r,!1);else{if(0!==Vu||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(c=Va(e))){for(t.flags|=64,ou(r,!1),null!==(u=c.updateQueue)&&(t.updateQueue=u,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(u=n).flags&=2,u.nextEffect=null,u.firstEffect=null,u.lastEffect=null,null===(c=u.alternate)?(u.childLanes=0,u.lanes=e,u.child=null,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=c.childLanes,u.lanes=c.lanes,u.child=c.child,u.memoizedProps=c.memoizedProps,u.memoizedState=c.memoizedState,u.updateQueue=c.updateQueue,u.type=c.type,e=c.dependencies,u.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return hi(Fa,1&Fa.current|2),t.child}e=e.sibling}null!==r.tail&&zi()>Gu&&(t.flags|=64,u=!0,ou(r,!1),t.lanes=33554432)}else{if(!u)if(null!==(e=Va(c))){if(t.flags|=64,u=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),ou(r,!0),null===r.tail&&"hidden"===r.tailMode&&!c.alternate&&!ja)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*zi()-r.renderingStartTime>Gu&&1073741824!==n&&(t.flags|=64,u=!0,ou(r,!1),t.lanes=33554432);r.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=r.last)?n.sibling=c:t.child=c,r.last=c)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=zi(),n.sibling=null,t=Fa.current,hi(Fa,u?1&t|2:1&t),n):null;case 23:case 24:return xs(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(o(156,t.tag))}function su(e){switch(e.tag){case 1:mi(e.type)&&gi();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Oa(),li(vi),li(di),Ya(),0!==(64&(t=e.flags)))throw Error(o(285));return e.flags=-4097&t|64,e;case 5:return Ma(e),null;case 13:return li(Fa),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return li(Fa),null;case 4:return Oa(),null;case 10:return ra(e),null;case 23:case 24:return xs(),null;default:return null}}function cu(e,t){try{var n="",r=t;do{n+=G(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function lu(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Qo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Yo=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Pa(Na.current);var o,u=null;switch(n){case"input":a=Z(e,a),r=Z(e,r),u=[];break;case"option":a=ae(e,a),r=ae(e,r),u=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),u=[];break;case"textarea":a=ue(e,a),r=ue(e,r),u=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Ur)}for(h in Ee(n,r),n=null,a)if(!r.hasOwnProperty(h)&&a.hasOwnProperty(h)&&null!=a[h])if("style"===h){var c=a[h];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(s.hasOwnProperty(h)?u||(u=[]):(u=u||[]).push(h,null));for(h in r){var l=r[h];if(c=null!=a?a[h]:void 0,r.hasOwnProperty(h)&&l!==c&&(null!=l||null!=c))if("style"===h)if(c){for(o in c)!c.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&c[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(u||(u=[]),u.push(h,n)),n=l;else"dangerouslySetInnerHTML"===h?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(u=u||[]).push(h,l)):"children"===h?"string"!==typeof l&&"number"!==typeof l||(u=u||[]).push(h,""+l):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(s.hasOwnProperty(h)?(null!=l&&"onScroll"===h&&Dr("scroll",e),u||c===l||(u=[])):"object"===typeof l&&null!==l&&l.$$typeof===L?l.toString():(u=u||[]).push(h,l))}n&&(u=u||[]).push("style",n);var h=u;(t.updateQueue=h)&&(t.flags|=4)}},$o=function(e,t,n,r){n!==r&&(t.flags|=4)};var hu="function"===typeof WeakMap?WeakMap:Map;function fu(e,t,n){(n=la(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){$u||($u=!0,Xu=r),lu(0,t)},n}function du(e,t,n){(n=la(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return lu(0,t),r(i)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Ju?Ju=new Set([this]):Ju.add(this),lu(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var vu="function"===typeof WeakSet?WeakSet:Set;function pu(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){Us(e,n)}else t.current=null}function yu(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Xi(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Hr(t.stateNode.containerInfo))}throw Error(o(163))}function mu(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(Fs(n,e),Ms(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Xi(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&va(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}va(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&zr(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&bt(n)))))}throw Error(o(163))}function gu(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=void 0!==i&&null!==i&&i.hasOwnProperty("display")?i.display:null,r.style.display=we("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ku(e,t){if(Ei&&"function"===typeof Ei.onCommitFiberUnmount)try{Ei.onCommitFiberUnmount(xi,t)}catch(a){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!==(4&r))Fs(t,n);else{r=t;try{i()}catch(a){Us(r,a)}}n=n.next}while(n!==e)}break;case 1:if(pu(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(a){Us(t,a)}break;case 5:pu(t);break;case 4:Su(e,t)}}function _u(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function wu(e){return 5===e.tag||3===e.tag||4===e.tag}function bu(e){e:{for(var t=e.return;null!==t;){if(wu(t))break e;t=t.return}throw Error(o(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(o(161))}16&n.flags&&(ge(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||wu(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?xu(e,n,t):Eu(e,n,t)}function xu(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ur));else if(4!==r&&null!==(e=e.child))for(xu(e,t,n),e=e.sibling;null!==e;)xu(e,t,n),e=e.sibling}function Eu(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Eu(e,t,n),e=e.sibling;null!==e;)Eu(e,t,n),e=e.sibling}function Su(e,t){for(var n,r,i=t,a=!1;;){if(!a){a=i.return;e:for(;;){if(null===a)throw Error(o(160));switch(n=a.stateNode,a.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}a=a.return}a=!0}if(5===i.tag||6===i.tag){e:for(var u=e,s=i,c=s;;)if(ku(u,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===s)break e;for(;null===c.sibling;){if(null===c.return||c.return===s)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}r?(u=n,s=i.stateNode,8===u.nodeType?u.parentNode.removeChild(s):u.removeChild(s)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(ku(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(a=!1)}i.sibling.return=i.return,i=i.sibling}}function Cu(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var a=t.updateQueue;if(t.updateQueue=null,null!==a){for(n[Zr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Se(e,i),t=Se(e,r),i=0;i<a.length;i+=2){var u=a[i],s=a[i+1];"style"===u?be(n,s):"dangerouslySetInnerHTML"===u?me(n,s):"children"===u?ge(n,s):_(n,u,s,t)}switch(e){case"input":ne(n,r);break;case"textarea":ce(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(a=r.value)?oe(n,!!r.multiple,a,!1):e!==!!r.multiple&&(null!=r.defaultValue?oe(n,!!r.multiple,r.defaultValue,!0):oe(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(o(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,bt(n.containerInfo)));case 13:return null!==t.memoizedState&&(Ku=zi(),gu(t.child,!0)),void Iu(t);case 19:return void Iu(t);case 23:case 24:return void gu(t,null!==t.memoizedState)}throw Error(o(163))}function Iu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new vu),t.forEach((function(t){var r=Bs.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Tu(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Nu=Math.ceil,Du=w.ReactCurrentDispatcher,Au=w.ReactCurrentOwner,Pu=0,Ru=null,Ou=null,Lu=0,Mu=0,Fu=ci(0),Vu=0,qu=null,Uu=0,ju=0,Bu=0,zu=0,Wu=null,Ku=0,Gu=1/0;function Hu(){Gu=zi()+500}var Qu,Yu=null,$u=!1,Xu=null,Ju=null,Zu=!1,es=null,ts=90,ns=[],rs=[],is=null,as=0,os=null,us=-1,ss=0,cs=0,ls=null,hs=!1;function fs(){return 0!==(48&Pu)?zi():-1!==us?us:us=zi()}function ds(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Wi()?1:2;if(0===ss&&(ss=Uu),0!==$i.transition){0!==cs&&(cs=null!==Wu?Wu.pendingLanes:0),e=ss;var t=4186112&~cs;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Wi(),0!==(4&Pu)&&98===e?e=Ut(12,ss):e=Ut(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ss),e}function vs(e,t,n){if(50<as)throw as=0,os=null,Error(o(185));if(null===(e=ps(e,t)))return null;zt(e,t,n),e===Ru&&(Bu|=t,4===Vu&&gs(e,Lu));var r=Wi();1===t?0!==(8&Pu)&&0===(48&Pu)?ks(e):(ys(e,n),0===Pu&&(Hu(),Qi())):(0===(4&Pu)||98!==r&&99!==r||(null===is?is=new Set([e]):is.add(e)),ys(e,n)),Wu=e}function ps(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function ys(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,u=e.pendingLanes;0<u;){var s=31-Wt(u),c=1<<s,l=a[s];if(-1===l){if(0===(c&r)||0!==(c&i)){l=t,Ft(c);var h=Mt;a[s]=10<=h?l+250:6<=h?l+5e3:-1}}else l<=t&&(e.expiredLanes|=c);u&=~c}if(r=Vt(e,e===Ru?Lu:0),t=Mt,0===r)null!==n&&(n!==Fi&&Ii(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Fi&&Ii(n)}15===t?(n=ks.bind(null,e),null===qi?(qi=[n],Ui=Ci(Pi,Yi)):qi.push(n),n=Fi):14===t?n=Hi(99,ks.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(o(358,e))}}(t),n=Hi(n,ms.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function ms(e){if(us=-1,cs=ss=0,0!==(48&Pu))throw Error(o(327));var t=e.callbackNode;if(Ls()&&e.callbackNode!==t)return null;var n=Vt(e,e===Ru?Lu:0);if(0===n)return null;var r=n,i=Pu;Pu|=16;var a=Cs();for(Ru===e&&Lu===r||(Hu(),Es(e,r));;)try{Ns();break}catch(s){Ss(e,s)}if(na(),Du.current=a,Pu=i,null!==Ou?r=0:(Ru=null,Lu=0,r=Vu),0!==(Uu&Bu))Es(e,0);else if(0!==r){if(2===r&&(Pu|=64,e.hydrate&&(e.hydrate=!1,Hr(e.containerInfo)),0!==(n=qt(e))&&(r=Is(e,n))),1===r)throw t=qu,Es(e,0),gs(e,n),ys(e,zi()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(o(345));case 2:case 5:Ps(e);break;case 3:if(gs(e,n),(62914560&n)===n&&10<(r=Ku+500-zi())){if(0!==Vt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){fs(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Kr(Ps.bind(null,e),r);break}Ps(e);break;case 4:if(gs(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var u=31-Wt(n);a=1<<u,(u=r[u])>i&&(i=u),n&=~a}if(n=i,10<(n=(120>(n=zi()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Nu(n/1960))-n)){e.timeoutHandle=Kr(Ps.bind(null,e),n);break}Ps(e);break;default:throw Error(o(329))}}return ys(e,zi()),e.callbackNode===t?ms.bind(null,e):null}function gs(e,t){for(t&=~zu,t&=~Bu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Wt(t),r=1<<n;e[n]=-1,t&=~r}}function ks(e){if(0!==(48&Pu))throw Error(o(327));if(Ls(),e===Ru&&0!==(e.expiredLanes&Lu)){var t=Lu,n=Is(e,t);0!==(Uu&Bu)&&(n=Is(e,t=Vt(e,t)))}else n=Is(e,t=Vt(e,0));if(0!==e.tag&&2===n&&(Pu|=64,e.hydrate&&(e.hydrate=!1,Hr(e.containerInfo)),0!==(t=qt(e))&&(n=Is(e,t))),1===n)throw n=qu,Es(e,0),gs(e,t),ys(e,zi()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ps(e),ys(e,zi()),null}function _s(e,t){var n=Pu;Pu|=1;try{return e(t)}finally{0===(Pu=n)&&(Hu(),Qi())}}function ws(e,t){var n=Pu;Pu&=-2,Pu|=8;try{return e(t)}finally{0===(Pu=n)&&(Hu(),Qi())}}function bs(e,t){hi(Fu,Mu),Mu|=t,Uu|=t}function xs(){Mu=Fu.current,li(Fu)}function Es(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Gr(n)),null!==Ou)for(n=Ou.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&gi();break;case 3:Oa(),li(vi),li(di),Ya();break;case 5:Ma(r);break;case 4:Oa();break;case 13:case 19:li(Fa);break;case 10:ra(r);break;case 23:case 24:xs()}n=n.return}Ru=e,Ou=Gs(e.current,null),Lu=Mu=Uu=t,Vu=0,qu=null,zu=Bu=ju=0}function Ss(e,t){for(;;){var n=Ou;try{if(na(),$a.current=Po,no){for(var r=Za.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}no=!1}if(Ja=0,to=eo=Za=null,ro=!1,Au.current=null,null===n||null===n.return){Vu=1,qu=t,Ou=null;break}e:{var a=e,o=n.return,u=n,s=t;if(t=Lu,u.flags|=2048,u.firstEffect=u.lastEffect=null,null!==s&&"object"===typeof s&&"function"===typeof s.then){var c=s;if(0===(2&u.mode)){var l=u.alternate;l?(u.updateQueue=l.updateQueue,u.memoizedState=l.memoizedState,u.lanes=l.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=0!==(1&Fa.current),f=o;do{var d;if(d=13===f.tag){var v=f.memoizedState;if(null!==v)d=null!==v.dehydrated;else{var p=f.memoizedProps;d=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!h)}}if(d){var y=f.updateQueue;if(null===y){var m=new Set;m.add(c),f.updateQueue=m}else y.add(c);if(0===(2&f.mode)){if(f.flags|=64,u.flags|=16384,u.flags&=-2981,1===u.tag)if(null===u.alternate)u.tag=17;else{var g=la(-1,1);g.tag=2,ha(u,g)}u.lanes|=1;break e}s=void 0,u=t;var k=a.pingCache;if(null===k?(k=a.pingCache=new hu,s=new Set,k.set(c,s)):void 0===(s=k.get(c))&&(s=new Set,k.set(c,s)),!s.has(u)){s.add(u);var _=js.bind(null,a,c,u);c.then(_,_)}f.flags|=4096,f.lanes=t;break e}f=f.return}while(null!==f);s=Error((H(u.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Vu&&(Vu=2),s=cu(s,u),f=o;do{switch(f.tag){case 3:a=s,f.flags|=4096,t&=-t,f.lanes|=t,fa(f,fu(0,a,t));break e;case 1:a=s;var w=f.type,b=f.stateNode;if(0===(64&f.flags)&&("function"===typeof w.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ju||!Ju.has(b)))){f.flags|=4096,t&=-t,f.lanes|=t,fa(f,du(f,a,t));break e}}f=f.return}while(null!==f)}As(n)}catch(x){t=x,Ou===n&&null!==n&&(Ou=n=n.return);continue}break}}function Cs(){var e=Du.current;return Du.current=Po,null===e?Po:e}function Is(e,t){var n=Pu;Pu|=16;var r=Cs();for(Ru===e&&Lu===t||Es(e,t);;)try{Ts();break}catch(i){Ss(e,i)}if(na(),Pu=n,Du.current=r,null!==Ou)throw Error(o(261));return Ru=null,Lu=0,Vu}function Ts(){for(;null!==Ou;)Ds(Ou)}function Ns(){for(;null!==Ou&&!Ti();)Ds(Ou)}function Ds(e){var t=Qu(e.alternate,e,Mu);e.memoizedProps=e.pendingProps,null===t?As(e):Ou=t,Au.current=null}function As(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=uu(n,t,Mu)))return void(Ou=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Mu)||0===(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=su(t)))return n.flags&=2047,void(Ou=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Ou=t);Ou=t=e}while(null!==t);0===Vu&&(Vu=5)}function Ps(e){var t=Wi();return Gi(99,Rs.bind(null,e,t)),null}function Rs(e,t){do{Ls()}while(null!==es);if(0!==(48&Pu))throw Error(o(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(o(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var u=e.eventTimes,s=e.expirationTimes;0<a;){var c=31-Wt(a),l=1<<c;i[c]=0,u[c]=-1,s[c]=-1,a&=~l}if(null!==is&&0===(24&r)&&is.has(e)&&is.delete(e),e===Ru&&(Ou=Ru=null,Lu=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=Pu,Pu|=32,Au.current=null,jr=Yt,mr(u=yr())){if("selectionStart"in u)s={start:u.selectionStart,end:u.selectionEnd};else e:if(s=(s=u.ownerDocument)&&s.defaultView||window,(l=s.getSelection&&s.getSelection())&&0!==l.rangeCount){s=l.anchorNode,a=l.anchorOffset,c=l.focusNode,l=l.focusOffset;try{s.nodeType,c.nodeType}catch(C){s=null;break e}var h=0,f=-1,d=-1,v=0,p=0,y=u,m=null;t:for(;;){for(var g;y!==s||0!==a&&3!==y.nodeType||(f=h+a),y!==c||0!==l&&3!==y.nodeType||(d=h+l),3===y.nodeType&&(h+=y.nodeValue.length),null!==(g=y.firstChild);)m=y,y=g;for(;;){if(y===u)break t;if(m===s&&++v===a&&(f=h),m===c&&++p===l&&(d=h),null!==(g=y.nextSibling))break;m=(y=m).parentNode}y=g}s=-1===f||-1===d?null:{start:f,end:d}}else s=null;s=s||{start:0,end:0}}else s=null;Br={focusedElem:u,selectionRange:s},Yt=!1,ls=null,hs=!1,Yu=r;do{try{Os()}catch(C){if(null===Yu)throw Error(o(330));Us(Yu,C),Yu=Yu.nextEffect}}while(null!==Yu);ls=null,Yu=r;do{try{for(u=e;null!==Yu;){var k=Yu.flags;if(16&k&&ge(Yu.stateNode,""),128&k){var _=Yu.alternate;if(null!==_){var w=_.ref;null!==w&&("function"===typeof w?w(null):w.current=null)}}switch(1038&k){case 2:bu(Yu),Yu.flags&=-3;break;case 6:bu(Yu),Yu.flags&=-3,Cu(Yu.alternate,Yu);break;case 1024:Yu.flags&=-1025;break;case 1028:Yu.flags&=-1025,Cu(Yu.alternate,Yu);break;case 4:Cu(Yu.alternate,Yu);break;case 8:Su(u,s=Yu);var b=s.alternate;_u(s),null!==b&&_u(b)}Yu=Yu.nextEffect}}catch(C){if(null===Yu)throw Error(o(330));Us(Yu,C),Yu=Yu.nextEffect}}while(null!==Yu);if(w=Br,_=yr(),k=w.focusedElem,u=w.selectionRange,_!==k&&k&&k.ownerDocument&&pr(k.ownerDocument.documentElement,k)){null!==u&&mr(k)&&(_=u.start,void 0===(w=u.end)&&(w=_),"selectionStart"in k?(k.selectionStart=_,k.selectionEnd=Math.min(w,k.value.length)):(w=(_=k.ownerDocument||document)&&_.defaultView||window).getSelection&&(w=w.getSelection(),s=k.textContent.length,b=Math.min(u.start,s),u=void 0===u.end?b:Math.min(u.end,s),!w.extend&&b>u&&(s=u,u=b,b=s),s=vr(k,b),a=vr(k,u),s&&a&&(1!==w.rangeCount||w.anchorNode!==s.node||w.anchorOffset!==s.offset||w.focusNode!==a.node||w.focusOffset!==a.offset)&&((_=_.createRange()).setStart(s.node,s.offset),w.removeAllRanges(),b>u?(w.addRange(_),w.extend(a.node,a.offset)):(_.setEnd(a.node,a.offset),w.addRange(_))))),_=[];for(w=k;w=w.parentNode;)1===w.nodeType&&_.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"===typeof k.focus&&k.focus(),k=0;k<_.length;k++)(w=_[k]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Yt=!!jr,Br=jr=null,e.current=n,Yu=r;do{try{for(k=e;null!==Yu;){var x=Yu.flags;if(36&x&&mu(k,Yu.alternate,Yu),128&x){_=void 0;var E=Yu.ref;if(null!==E){var S=Yu.stateNode;Yu.tag,_=S,"function"===typeof E?E(_):E.current=_}}Yu=Yu.nextEffect}}catch(C){if(null===Yu)throw Error(o(330));Us(Yu,C),Yu=Yu.nextEffect}}while(null!==Yu);Yu=null,Vi(),Pu=i}else e.current=n;if(Zu)Zu=!1,es=e,ts=t;else for(Yu=r;null!==Yu;)t=Yu.nextEffect,Yu.nextEffect=null,8&Yu.flags&&((x=Yu).sibling=null,x.stateNode=null),Yu=t;if(0===(r=e.pendingLanes)&&(Ju=null),1===r?e===os?as++:(as=0,os=e):as=0,n=n.stateNode,Ei&&"function"===typeof Ei.onCommitFiberRoot)try{Ei.onCommitFiberRoot(xi,n,void 0,64===(64&n.current.flags))}catch(C){}if(ys(e,zi()),$u)throw $u=!1,e=Xu,Xu=null,e;return 0!==(8&Pu)||Qi(),null}function Os(){for(;null!==Yu;){var e=Yu.alternate;hs||null===ls||(0!==(8&Yu.flags)?et(Yu,ls)&&(hs=!0):13===Yu.tag&&Tu(e,Yu)&&et(Yu,ls)&&(hs=!0));var t=Yu.flags;0!==(256&t)&&yu(e,Yu),0===(512&t)||Zu||(Zu=!0,Hi(97,(function(){return Ls(),null}))),Yu=Yu.nextEffect}}function Ls(){if(90!==ts){var e=97<ts?97:ts;return ts=90,Gi(e,Vs)}return!1}function Ms(e,t){ns.push(t,e),Zu||(Zu=!0,Hi(97,(function(){return Ls(),null})))}function Fs(e,t){rs.push(t,e),Zu||(Zu=!0,Hi(97,(function(){return Ls(),null})))}function Vs(){if(null===es)return!1;var e=es;if(es=null,0!==(48&Pu))throw Error(o(331));var t=Pu;Pu|=32;var n=rs;rs=[];for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1],u=i.destroy;if(i.destroy=void 0,"function"===typeof u)try{u()}catch(c){if(null===a)throw Error(o(330));Us(a,c)}}for(n=ns,ns=[],r=0;r<n.length;r+=2){i=n[r],a=n[r+1];try{var s=i.create;i.destroy=s()}catch(c){if(null===a)throw Error(o(330));Us(a,c)}}for(s=e.current.firstEffect;null!==s;)e=s.nextEffect,s.nextEffect=null,8&s.flags&&(s.sibling=null,s.stateNode=null),s=e;return Pu=t,Qi(),!0}function qs(e,t,n){ha(e,t=fu(0,t=cu(n,t),1)),t=fs(),null!==(e=ps(e,1))&&(zt(e,1,t),ys(e,t))}function Us(e,t){if(3===e.tag)qs(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){qs(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ju||!Ju.has(r))){var i=du(n,e=cu(t,e),1);if(ha(n,i),i=fs(),null!==(n=ps(n,1)))zt(n,1,i),ys(n,i);else if("function"===typeof r.componentDidCatch&&(null===Ju||!Ju.has(r)))try{r.componentDidCatch(t,e)}catch(a){}break}}n=n.return}}function js(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=fs(),e.pingedLanes|=e.suspendedLanes&n,Ru===e&&(Lu&n)===n&&(4===Vu||3===Vu&&(62914560&Lu)===Lu&&500>zi()-Ku?Es(e,0):zu|=n),ys(e,t)}function Bs(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Wi()?1:2:(0===ss&&(ss=Uu),0===(t=jt(62914560&~ss))&&(t=4194304))),n=fs(),null!==(e=ps(e,t))&&(zt(e,t,n),ys(e,n))}function zs(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Ws(e,t,n,r){return new zs(e,t,n,r)}function Ks(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Gs(e,t){var n=e.alternate;return null===n?((n=Ws(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Hs(e,t,n,r,i,a){var u=2;if(r=e,"function"===typeof e)Ks(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case E:return Qs(n.children,i,a,t);case M:u=8,i|=16;break;case S:u=8,i|=1;break;case C:return(e=Ws(12,n,t,8|i)).elementType=C,e.type=C,e.lanes=a,e;case D:return(e=Ws(13,n,t,i)).type=D,e.elementType=D,e.lanes=a,e;case A:return(e=Ws(19,n,t,i)).elementType=A,e.lanes=a,e;case F:return Ys(n,i,a,t);case V:return(e=Ws(24,n,t,i)).elementType=V,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:u=10;break e;case T:u=9;break e;case N:u=11;break e;case P:u=14;break e;case R:u=16,r=null;break e;case O:u=22;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Ws(u,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Qs(e,t,n,r){return(e=Ws(7,e,r,t)).lanes=n,e}function Ys(e,t,n,r){return(e=Ws(23,e,r,t)).elementType=F,e.lanes=n,e}function $s(e,t,n){return(e=Ws(6,e,null,t)).lanes=n,e}function Xs(e,t,n){return(t=Ws(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Js(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Bt(0),this.expirationTimes=Bt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bt(0),this.mutableSourceEagerHydrationData=null}function Zs(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function ec(e,t,n,r){var i=t.current,a=fs(),u=ds(i);e:if(n){t:{if($e(n=n._reactInternals)!==n||1!==n.tag)throw Error(o(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(mi(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(o(171))}if(1===n.tag){var c=n.type;if(mi(c)){n=_i(n,c,s);break e}}n=s}else n=fi;return null===t.context?t.context=n:t.pendingContext=n,(t=la(a,u)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),ha(i,t),vs(i,u,a),u}function tc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function nc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function rc(e,t){nc(e,t),(e=e.alternate)&&nc(e,t)}function ic(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Js(e,t,null!=n&&!0===n.hydrate),t=Ws(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,sa(t),e[ei]=n.current,Pr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function ac(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function oc(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a._internalRoot;if("function"===typeof i){var u=i;i=function(){var e=tc(o);u.call(e)}}ec(t,o,e,i)}else{if(a=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new ic(e,0,t?{hydrate:!0}:void 0)}(n,r),o=a._internalRoot,"function"===typeof i){var s=i;i=function(){var e=tc(o);s.call(e)}}ws((function(){ec(t,o,e,i)}))}return tc(o)}function uc(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ac(t))throw Error(o(200));return Zs(e,t,null,n)}Qu=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||vi.current)Fo=!0;else{if(0===(n&r)){switch(Fo=!1,t.tag){case 3:Ho(t),Ha();break;case 5:La(t);break;case 1:mi(t.type)&&wi(t);break;case 4:Ra(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;hi(Ji,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Jo(e,t,n):(hi(Fa,1&Fa.current),null!==(t=au(e,t,n))?t.sibling:null);hi(Fa,1&Fa.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return iu(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),hi(Fa,Fa.current),r)break;return null;case 23:case 24:return t.lanes=0,Bo(e,t,n)}return au(e,t,n)}Fo=0!==(16384&e.flags)}else Fo=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=yi(t,di.current),aa(t,n),i=oo(null,t,r,e,i,n),t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,mi(r)){var a=!0;wi(t)}else a=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,sa(t);var u=r.getDerivedStateFromProps;"function"===typeof u&&ya(t,r,u,e),i.updater=ma,t.stateNode=i,i._reactInternals=t,wa(t,r,e,n),t=Go(null,t,r,!0,a,n)}else t.tag=0,Vo(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"===typeof e)return Ks(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===P)return 14}return 2}(i),e=Xi(i,e),a){case 0:t=Wo(null,t,i,e,n);break e;case 1:t=Ko(null,t,i,e,n);break e;case 11:t=qo(null,t,i,e,n);break e;case 14:t=Uo(null,t,i,Xi(i.type,e),r,n);break e}throw Error(o(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Wo(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ko(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 3:if(Ho(t),r=t.updateQueue,null===e||null===r)throw Error(o(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,ca(e,t),da(t,r,null,n),(r=t.memoizedState.element)===i)Ha(),t=au(e,t,n);else{if((a=(i=t.stateNode).hydrate)&&(Ua=Qr(t.stateNode.containerInfo.firstChild),qa=t,a=ja=!0),a){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(a=e[i])._workInProgressVersionPrimary=e[i+1],Qa.push(a);for(n=Ia(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Vo(e,t,r,n),Ha();t=t.child}return t;case 5:return La(t),null===e&&Wa(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,u=i.children,Wr(r,i)?u=null:null!==a&&Wr(r,a)&&(t.flags|=16),zo(e,t),Vo(e,t,u,n),t.child;case 6:return null===e&&Wa(t),null;case 13:return Jo(e,t,n);case 4:return Ra(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ca(t,null,r,n):Vo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,qo(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 7:return Vo(e,t,t.pendingProps,n),t.child;case 8:case 12:return Vo(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,u=t.memoizedProps,a=i.value;var s=t.type._context;if(hi(Ji,s._currentValue),s._currentValue=a,null!==u)if(s=u.value,0===(a=lr(s,a)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(s,a):1073741823))){if(u.children===i.children&&!vi.current){t=au(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){u=s.child;for(var l=c.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&a)){1===s.tag&&((l=la(-1,n&-n)).tag=2,ha(s,l)),s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ia(s.return,n),c.lanes|=n;break}l=l.next}}else u=10===s.tag&&s.type===t.type?null:s.child;if(null!==u)u.return=s;else for(u=s;null!==u;){if(u===t){u=null;break}if(null!==(s=u.sibling)){s.return=u.return,u=s;break}u=u.return}s=u}Vo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(a=t.pendingProps).children,aa(t,n),r=r(i=oa(i,a.unstable_observedBits)),t.flags|=1,Vo(e,t,r,n),t.child;case 14:return a=Xi(i=t.type,t.pendingProps),Uo(e,t,i,a=Xi(i.type,a),r,n);case 15:return jo(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Xi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,mi(r)?(e=!0,wi(t)):e=!1,aa(t,n),ka(t,r,i),wa(t,r,i,n),Go(null,t,r,!0,e,n);case 19:return iu(e,t,n);case 23:case 24:return Bo(e,t,n)}throw Error(o(156,t.tag))},ic.prototype.render=function(e){ec(e,this._internalRoot,null,null)},ic.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;ec(null,e,null,(function(){t[ei]=null}))},tt=function(e){13===e.tag&&(vs(e,4,fs()),rc(e,4))},nt=function(e){13===e.tag&&(vs(e,67108864,fs()),rc(e,67108864))},rt=function(e){if(13===e.tag){var t=fs(),n=ds(e);vs(e,n,t),rc(e,n)}},it=function(e,t){return t()},Ie=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ai(r);if(!i)throw Error(o(90));X(r),ne(r,i)}}}break;case"textarea":ce(e,n);break;case"select":null!=(t=n.value)&&oe(e,!!n.multiple,t,!1)}},Re=_s,Oe=function(e,t,n,r,i){var a=Pu;Pu|=4;try{return Gi(98,e.bind(null,t,n,r,i))}finally{0===(Pu=a)&&(Hu(),Qi())}},Le=function(){0===(49&Pu)&&(function(){if(null!==is){var e=is;is=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,ys(e,zi())}))}Qi()}(),Ls())},Me=function(e,t){var n=Pu;Pu|=2;try{return e(t)}finally{0===(Pu=n)&&(Hu(),Qi())}};var sc={Events:[ri,ii,ai,Ae,Pe,Ls,{current:!1}]},cc={findFiberByHostInstance:ni,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},lc={bundleType:cc.bundleType,version:cc.version,rendererPackageName:cc.rendererPackageName,rendererConfig:cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:cc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var hc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hc.isDisabled&&hc.supportsFiber)try{xi=hc.inject(lc),Ei=hc}catch(ye){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sc,t.createPortal=uc,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw Error(o(268,Object.keys(e)))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Pu;if(0!==(48&n))return e(t);Pu|=1;try{if(e)return Gi(99,e.bind(null,t))}finally{Pu=n,Qi()}},t.hydrate=function(e,t,n){if(!ac(t))throw Error(o(200));return oc(null,e,t,!0,n)},t.render=function(e,t,n){if(!ac(t))throw Error(o(200));return oc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!ac(e))throw Error(o(40));return!!e._reactRootContainer&&(ws((function(){oc(null,null,e,!1,(function(){e._reactRootContainer=null,e[ei]=null}))})),!0)},t.unstable_batchedUpdates=_s,t.unstable_createPortal=function(e,t){return uc(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ac(n))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return oc(e,t,n,!1,r)},t.version="17.0.2"},164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:function(e,t,n){"use strict";n(725);var r=n(791),i=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var a=Symbol.for;i=a("react.element"),t.Fragment=a("react.fragment")}var o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u=Object.prototype.hasOwnProperty,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)u.call(t,r)&&!s.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:l,props:a,_owner:o.current}}t.jsx=c,t.jsxs=c},117:function(e,t,n){"use strict";var r=n(725),i=60103,a=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var o=60109,u=60110,s=60112;t.Suspense=60113;var c=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var h=Symbol.for;i=h("react.element"),a=h("react.portal"),t.Fragment=h("react.fragment"),t.StrictMode=h("react.strict_mode"),t.Profiler=h("react.profiler"),o=h("react.provider"),u=h("react.context"),s=h("react.forward_ref"),t.Suspense=h("react.suspense"),c=h("react.memo"),l=h("react.lazy")}var f="function"===typeof Symbol&&Symbol.iterator;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p={};function y(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||v}function m(){}function g(e,t,n){this.props=e,this.context=t,this.refs=p,this.updater=n||v}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(d(85));this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=y.prototype;var k=g.prototype=new m;k.constructor=g,r(k,y.prototype),k.isPureReactComponent=!0;var _={current:null},w=Object.prototype.hasOwnProperty,b={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,n){var r,a={},o=null,u=null;if(null!=t)for(r in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,r)&&!b.hasOwnProperty(r)&&(a[r]=t[r]);var s=arguments.length-2;if(1===s)a.children=n;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];a.children=c}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===a[r]&&(a[r]=s[r]);return{$$typeof:i,type:e,key:o,ref:u,props:a,_owner:_.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var S=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,n,r,o){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case i:case a:s=!0}}if(s)return o=o(s=e),e=""===r?"."+C(s,0):r,Array.isArray(o)?(n="",null!=e&&(n=e.replace(S,"$&/")+"/"),I(o,t,n,"",(function(e){return e}))):null!=o&&(E(o)&&(o=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,n+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(S,"$&/")+"/")+e)),t.push(o)),1;if(s=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=r+C(u=e[c],c);s+=I(u,t,n,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=I(u=u.value,t,n,l=r+C(u,c++),o);else if("object"===u)throw t=""+e,Error(d(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return s}function T(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function N(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var D={current:null};function A(){var e=D.current;if(null===e)throw Error(d(321));return e}var P={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:_,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error(d(143));return e}},t.Component=y,t.PureComponent=g,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(d(267,e));var a=r({},e.props),o=e.key,u=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(u=t.ref,s=_.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)w.call(t,l)&&!b.hasOwnProperty(l)&&(a[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){c=Array(l);for(var h=0;h<l;h++)c[h]=arguments[h+2];a.children=c}return{$$typeof:i,type:e.type,key:o,ref:u,props:a,_owner:s}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:u,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:s,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return A().useCallback(e,t)},t.useContext=function(e,t){return A().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return A().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return A().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return A().useLayoutEffect(e,t)},t.useMemo=function(e,t){return A().useMemo(e,t)},t.useReducer=function(e,t,n){return A().useReducer(e,t,n)},t.useRef=function(e){return A().useRef(e)},t.useState=function(e){return A().useState(e)},t.version="17.0.2"},791:function(e,t,n){"use strict";e.exports=n(117)},184:function(e,t,n){"use strict";e.exports=n(374)},727:function(e){var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(A){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),o=new T(r||[]);return a._invoke=function(e,t,n){var r=h;return function(i,a){if(r===d)throw new Error("Generator is already running");if(r===v){if("throw"===i)throw a;return D()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=S(o,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=l(e,t,n);if("normal"===s.type){if(r=n.done?v:f,s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=v,n.method="throw",n.arg=s.arg)}}}(e,n,o),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(A){return{type:"throw",arg:A}}}e.wrap=c;var h="suspendedStart",f="suspendedYield",d="executing",v="completed",p={};function y(){}function m(){}function g(){}var k={};s(k,a,(function(){return this}));var _=Object.getPrototypeOf,w=_&&_(_(N([])));w&&w!==n&&r.call(w,a)&&(k=w);var b=g.prototype=y.prototype=Object.create(k);function x(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,a,o,u){var s=l(e[i],e,a);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"===typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,u)}),(function(e){n("throw",e,o,u)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,u)}))}u(s.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function N(e){if(e){var n=e[a];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:D}}function D(){return{value:t,done:!0}}return m.prototype=g,s(b,"constructor",g),s(g,"constructor",m),m.displayName=s(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},x(E.prototype),s(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new E(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},x(b),s(b,u,"Generator"),s(b,a,(function(){return this})),s(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],u=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=t}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},813:function(e,t){"use strict";var n,r,i,a;if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,s=u.now();t.unstable_now=function(){return u.now()-s}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var c=null,l=null,h=function e(){if(null!==c)try{var n=t.unstable_now();c(!0,n),c=null}catch(r){throw setTimeout(e,0),r}};n=function(e){null!==c?setTimeout(n,0,e):(c=e,setTimeout(h,0))},r=function(e,t){l=setTimeout(e,t)},i=function(){clearTimeout(l)},t.unstable_shouldYield=function(){return!1},a=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,d=window.clearTimeout;if("undefined"!==typeof console){var v=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var p=!1,y=null,m=-1,g=5,k=0;t.unstable_shouldYield=function(){return t.unstable_now()>=k},a=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):g=0<e?Math.floor(1e3/e):5};var _=new MessageChannel,w=_.port2;_.port1.onmessage=function(){if(null!==y){var e=t.unstable_now();k=e+g;try{y(!0,e)?w.postMessage(null):(p=!1,y=null)}catch(n){throw w.postMessage(null),n}}else p=!1},n=function(e){y=e,p||(p=!0,w.postMessage(null))},r=function(e,n){m=f((function(){e(t.unstable_now())}),n)},i=function(){d(m),m=-1}}function b(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<S(i,t)))break e;e[r]=t,e[n]=i,n=r}}function x(e){return void 0===(e=e[0])?null:e}function E(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var a=2*(r+1)-1,o=e[a],u=a+1,s=e[u];if(void 0!==o&&0>S(o,n))void 0!==s&&0>S(s,o)?(e[r]=s,e[u]=n,r=u):(e[r]=o,e[a]=n,r=a);else{if(!(void 0!==s&&0>S(s,n)))break e;e[r]=s,e[u]=n,r=u}}}return t}return null}function S(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var C=[],I=[],T=1,N=null,D=3,A=!1,P=!1,R=!1;function O(e){for(var t=x(I);null!==t;){if(null===t.callback)E(I);else{if(!(t.startTime<=e))break;E(I),t.sortIndex=t.expirationTime,b(C,t)}t=x(I)}}function L(e){if(R=!1,O(e),!P)if(null!==x(C))P=!0,n(M);else{var t=x(I);null!==t&&r(L,t.startTime-e)}}function M(e,n){P=!1,R&&(R=!1,i()),A=!0;var a=D;try{for(O(n),N=x(C);null!==N&&(!(N.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=N.callback;if("function"===typeof o){N.callback=null,D=N.priorityLevel;var u=o(N.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?N.callback=u:N===x(C)&&E(C),O(n)}else E(C);N=x(C)}if(null!==N)var s=!0;else{var c=x(I);null!==c&&r(L,c.startTime-n),s=!1}return s}finally{N=null,D=a,A=!1}}var F=a;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){P||A||(P=!0,n(M))},t.unstable_getCurrentPriorityLevel=function(){return D},t.unstable_getFirstCallbackNode=function(){return x(C)},t.unstable_next=function(e){switch(D){case 1:case 2:case 3:var t=3;break;default:t=D}var n=D;D=t;try{return e()}finally{D=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=F,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=D;D=e;try{return t()}finally{D=n}},t.unstable_scheduleCallback=function(e,a,o){var u=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?u+o:u:o=u,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:T++,callback:a,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>u?(e.sortIndex=o,b(I,e),null===x(C)&&e===x(I)&&(R?i():R=!0,r(L,o-u))):(e.sortIndex=s,b(C,e),P||A||(P=!0,n(M))),e},t.unstable_wrapCallback=function(e){var t=D;return function(){var n=D;D=t;try{return e.apply(this,arguments)}finally{D=n}}}},296:function(e,t,n){"use strict";e.exports=n(813)},721:function(e,t,n){"use strict";e.exports=n.p+"static/media/banner.d1068db869b4b87d697b.png"}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",function(){"use strict";var e={};n.r(e),n.d(e,{FirebaseError:function(){return Be},SDK_VERSION:function(){return Kt},_DEFAULT_ENTRY_NAME:function(){return Pt},_addComponent:function(){return Mt},_addOrOverwriteComponent:function(){return Ft},_apps:function(){return Ot},_clearComponents:function(){return jt},_components:function(){return Lt},_getProvider:function(){return qt},_registerComponent:function(){return Vt},_removeServiceInstance:function(){return Ut},deleteApp:function(){return Yt},getApp:function(){return Ht},getApps:function(){return Qt},initializeApp:function(){return Gt},onLog:function(){return Jt},registerVersion:function(){return Xt},setLogLevel:function(){return Zt}});var t,r=n(791),i=n(164);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(s){u=!0,i=s}finally{try{o||null==n.return||n.return()}finally{if(u)throw i}}return a}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(t||(t={}));var c=function(e){return e};var l="beforeunload",h="popstate";function f(e){e.preventDefault(),e.returnValue=""}function d(){var e=[];return{get length(){return e.length},push:function(t){return e.push(t),function(){e=e.filter((function(e){return e!==t}))}},call:function(t){e.forEach((function(e){return e&&e(t)}))}}}function v(){return Math.random().toString(36).substr(2,8)}function p(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,i=void 0===r?"":r,a=e.hash,o=void 0===a?"":a;return i&&"?"!==i&&(n+="?"===i.charAt(0)?i:"?"+i),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function y(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function m(e,t){if(!e)throw new Error(t)}var g=(0,r.createContext)(null);var k=(0,r.createContext)(null);var _=(0,r.createContext)({outlet:null,matches:[]});function w(e){m(!1)}function b(e){var n=e.basename,i=void 0===n?"/":n,a=e.children,o=void 0===a?null:a,u=e.location,s=e.navigationType,c=void 0===s?t.Pop:s,l=e.navigator,h=e.static,f=void 0!==h&&h;S()&&m(!1);var d=U(i),v=(0,r.useMemo)((function(){return{basename:d,navigator:l,static:f}}),[d,l,f]);"string"===typeof u&&(u=y(u));var p=u,_=p.pathname,w=void 0===_?"/":_,b=p.search,x=void 0===b?"":b,E=p.hash,C=void 0===E?"":E,I=p.state,T=void 0===I?null:I,N=p.key,D=void 0===N?"default":N,A=(0,r.useMemo)((function(){var e=V(w,d);return null==e?null:{pathname:e,search:x,hash:C,state:T,key:D}}),[d,w,x,C,T,D]);return null==A?null:(0,r.createElement)(g.Provider,{value:v},(0,r.createElement)(k.Provider,{children:o,value:{location:A,navigationType:c}}))}function x(e){var t=e.children,n=e.location;return function(e,t){S()||m(!1);var n=(0,r.useContext)(_).matches,i=n[n.length-1],a=i?i.params:{},o=(i&&i.pathname,i?i.pathnameBase:"/");i&&i.route;0;var u,s=C();if(t){var c,l="string"===typeof t?y(t):t;"/"===o||(null==(c=l.pathname)?void 0:c.startsWith(o))||m(!1),u=l}else u=s;var h=u.pathname||"/",f="/"===o?h:h.slice(o.length)||"/",d=function(e,t,n){void 0===n&&(n="/");var r=V(("string"===typeof t?y(t):t).pathname||"/",n);if(null==r)return null;var i=D(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(i);for(var a=null,o=0;null==a&&o<i.length;++o)a=O(i[o],r);return a}(e,{pathname:f});0;return L(d&&d.map((function(e){return Object.assign({},e,{params:Object.assign({},a,e.params),pathname:q([o,e.pathname]),pathnameBase:"/"===e.pathnameBase?o:q([o,e.pathnameBase])})})),n)}(N(t),n)}function E(e){S()||m(!1);var t=(0,r.useContext)(g),n=t.basename,i=t.navigator,a=T(e),o=a.hash,u=a.pathname,s=a.search,c=u;if("/"!==n){var l=function(e){return""===e||""===e.pathname?"/":"string"===typeof e?y(e).pathname:e.pathname}(e),h=null!=l&&l.endsWith("/");c="/"===u?n+(h?"/":""):q([n,u])}return i.createHref({pathname:c,search:s,hash:o})}function S(){return null!=(0,r.useContext)(k)}function C(){return S()||m(!1),(0,r.useContext)(k).location}function I(){S()||m(!1);var e=(0,r.useContext)(g),t=e.basename,n=e.navigator,i=(0,r.useContext)(_).matches,a=C().pathname,o=JSON.stringify(i.map((function(e){return e.pathnameBase}))),u=(0,r.useRef)(!1);(0,r.useEffect)((function(){u.current=!0}));var s=(0,r.useCallback)((function(e,r){if(void 0===r&&(r={}),u.current)if("number"!==typeof e){var i=F(e,JSON.parse(o),a);"/"!==t&&(i.pathname=q([t,i.pathname])),(r.replace?n.replace:n.push)(i,r.state)}else n.go(e)}),[t,n,o,a]);return s}function T(e){var t=(0,r.useContext)(_).matches,n=C().pathname,i=JSON.stringify(t.map((function(e){return e.pathnameBase})));return(0,r.useMemo)((function(){return F(e,JSON.parse(i),n)}),[e,i,n])}function N(e){var t=[];return r.Children.forEach(e,(function(e){if((0,r.isValidElement)(e))if(e.type!==r.Fragment){e.type!==w&&m(!1);var n={caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path};e.props.children&&(n.children=N(e.props.children)),t.push(n)}else t.push.apply(t,N(e.props.children))})),t}function D(e,t,n,r){return void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r=""),e.forEach((function(e,i){var a={relativePath:e.path||"",caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};a.relativePath.startsWith("/")&&(a.relativePath.startsWith(r)||m(!1),a.relativePath=a.relativePath.slice(r.length));var o=q([r,a.relativePath]),u=n.concat(a);e.children&&e.children.length>0&&(!0===e.index&&m(!1),D(e.children,t,u,o)),(null!=e.path||e.index)&&t.push({path:o,score:R(o,e.index),routesMeta:u})})),t}var A=/^:\w+$/,P=function(e){return"*"===e};function R(e,t){var n=e.split("/"),r=n.length;return n.some(P)&&(r+=-2),t&&(r+=2),n.filter((function(e){return!P(e)})).reduce((function(e,t){return e+(A.test(t)?3:""===t?1:10)}),r)}function O(e,t){for(var n=e.routesMeta,r={},i="/",a=[],o=0;o<n.length;++o){var u=n[o],s=o===n.length-1,c="/"===i?t:t.slice(i.length)||"/",l=M({path:u.relativePath,caseSensitive:u.caseSensitive,end:s},c);if(!l)return null;Object.assign(r,l.params);var h=u.route;a.push({params:r,pathname:q([i,l.pathname]),pathnameBase:U(q([i,l.pathnameBase])),route:h}),"/"!==l.pathnameBase&&(i=q([i,l.pathnameBase]))}return a}function L(e,t){return void 0===t&&(t=[]),null==e?null:e.reduceRight((function(n,i,a){return(0,r.createElement)(_.Provider,{children:void 0!==i.route.element?i.route.element:n,value:{outlet:n,matches:t.concat(e.slice(0,a+1))}})}),null)}function M(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);var r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(function(e,t){return r.push(t),"([^\\/]+)"}));e.endsWith("*")?(r.push("*"),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):i+=n?"\\/*$":"(?:(?=[.~-]|%[0-9A-F]{2})|\\b|\\/|$)";return[new RegExp(i,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),r=u(n,2),i=r[0],a=r[1],o=t.match(i);if(!o)return null;var s=o[0],c=s.replace(/(.)\/+$/,"$1"),l=o.slice(1);return{params:a.reduce((function(e,t,n){if("*"===t){var r=l[n]||"";c=s.slice(0,s.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(Pn){return e}}(l[n]||""),e}),{}),pathname:s,pathnameBase:c,pattern:e}}function F(e,t,n){var r,i="string"===typeof e?y(e):e,a=""===e||""===i.pathname?"/":i.pathname;if(null==a)r=n;else{var o=t.length-1;if(a.startsWith("..")){for(var u=a.split("/");".."===u[0];)u.shift(),o-=1;i.pathname=u.join("/")}r=o>=0?t[o]:"/"}var s=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?y(e):e,r=n.pathname,i=n.search,a=void 0===i?"":i,o=n.hash,u=void 0===o?"":o,s=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:s,search:j(a),hash:B(u)}}(i,r);return a&&"/"!==a&&a.endsWith("/")&&!s.pathname.endsWith("/")&&(s.pathname+="/"),s}function V(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=e.charAt(t.length);return n&&"/"!==n?null:e.slice(t.length)||"/"}var q=function(e){return e.join("/").replace(/\/\/+/g,"/")},U=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},j=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},B=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""};function z(){return z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z.apply(this,arguments)}function W(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}var K=["onClick","reloadDocument","replace","state","target","to"],G=["aria-current","caseSensitive","className","end","style","to","children"];function H(e){var n=e.basename,i=e.children,a=e.window,o=(0,r.useRef)();null==o.current&&(o.current=function(e){void 0===e&&(e={});var n=e.window,r=void 0===n?document.defaultView:n,i=r.history;function a(){var e=r.location,t=e.pathname,n=e.search,a=e.hash,o=i.state||{};return[o.idx,c({pathname:t,search:n,hash:a,state:o.usr||null,key:o.key||"default"})]}var o=null;r.addEventListener(h,(function(){if(o)w.call(o),o=null;else{var e=t.Pop,n=a(),r=n[0],i=n[1];if(w.length){if(null!=r){var u=g-r;u&&(o={action:e,location:i,retry:function(){I(-1*u)}},I(u))}}else C(e)}}));var u=t.Pop,m=a(),g=m[0],k=m[1],_=d(),w=d();function b(e){return"string"===typeof e?e:p(e)}function x(e,t){return void 0===t&&(t=null),c(s({pathname:k.pathname,hash:"",search:""},"string"===typeof e?y(e):e,{state:t,key:v()}))}function E(e,t){return[{usr:e.state,key:e.key,idx:t},b(e)]}function S(e,t,n){return!w.length||(w.call({action:e,location:t,retry:n}),!1)}function C(e){u=e;var t=a();g=t[0],k=t[1],_.call({action:u,location:k})}function I(e){i.go(e)}null==g&&(g=0,i.replaceState(s({},i.state,{idx:g}),""));var T={get action(){return u},get location(){return k},createHref:b,push:function e(n,a){var o=t.Push,u=x(n,a);if(S(o,u,(function(){e(n,a)}))){var s=E(u,g+1),c=s[0],l=s[1];try{i.pushState(c,"",l)}catch(Pn){r.location.assign(l)}C(o)}},replace:function e(n,r){var a=t.Replace,o=x(n,r);if(S(a,o,(function(){e(n,r)}))){var u=E(o,g),s=u[0],c=u[1];i.replaceState(s,"",c),C(a)}},go:I,back:function(){I(-1)},forward:function(){I(1)},listen:function(e){return _.push(e)},block:function(e){var t=w.push(e);return 1===w.length&&r.addEventListener(l,f),function(){t(),w.length||r.removeEventListener(l,f)}}};return T}({window:a}));var m=o.current,g=u((0,r.useState)({action:m.action,location:m.location}),2),k=g[0],_=g[1];return(0,r.useLayoutEffect)((function(){return m.listen(_)}),[m]),(0,r.createElement)(b,{basename:n,children:i,location:k.location,navigationType:k.action,navigator:m})}var Q=(0,r.forwardRef)((function(e,t){var n=e.onClick,i=e.reloadDocument,a=e.replace,o=void 0!==a&&a,u=e.state,s=e.target,c=e.to,l=W(e,K),h=E(c),f=function(e,t){var n=void 0===t?{}:t,i=n.target,a=n.replace,o=n.state,u=I(),s=C(),c=T(e);return(0,r.useCallback)((function(t){if(0===t.button&&(!i||"_self"===i)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(t)){t.preventDefault();var n=!!a||p(s)===p(c);u(e,{replace:n,state:o})}}),[s,u,c,a,o,i,e])}(c,{replace:o,state:u,target:s});return(0,r.createElement)("a",z({},l,{href:h,onClick:function(e){n&&n(e),e.defaultPrevented||i||f(e)},ref:t,target:s}))}));var Y=(0,r.forwardRef)((function(e,t){var n=e["aria-current"],i=void 0===n?"page":n,a=e.caseSensitive,o=void 0!==a&&a,u=e.className,s=void 0===u?"":u,c=e.end,l=void 0!==c&&c,h=e.style,f=e.to,d=e.children,v=W(e,G),p=C(),y=T(f),m=p.pathname,g=y.pathname;o||(m=m.toLowerCase(),g=g.toLowerCase());var k,_=m===g||!l&&m.startsWith(g)&&"/"===m.charAt(g.length),w=_?i:void 0;k="function"===typeof s?s({isActive:_}):[s,_?"active":null].filter(Boolean).join(" ");var b="function"===typeof h?h({isActive:_}):h;return(0,r.createElement)(Q,z({},v,{"aria-current":w,className:k,ref:t,style:b,to:f}),"function"===typeof d?d({isActive:_}):d)}));var $=n(721),X=n(184);function J(){return(0,X.jsx)("div",{className:"cover-container d-flex w-100 h-100 p-3 mx-auto flex-column",children:(0,X.jsx)("header",{className:"mb-auto",children:(0,X.jsxs)("div",{children:[(0,X.jsx)(Q,{className:"float-md-start mb-0",to:"/",children:(0,X.jsx)("img",{height:"30",src:$,alt:"banner",className:"navbarImage"})}),(0,X.jsxs)("nav",{className:"nav nav-masthead justify-content-center float-md-end",children:[(0,X.jsx)(Y,{className:"nav-link",to:"/",children:"Inicio"}),(0,X.jsx)(Y,{className:"nav-link",to:"/actuaciones",children:"Actuaciones"}),(0,X.jsx)(Y,{className:"nav-link",to:"/about",children:"About"})]})]})})})}function Z(){return(0,X.jsxs)("div",{className:"container",children:[(0,X.jsx)("h1",{children:"Nace BMM STATS"}),(0,X.jsxs)("p",{children:["BMM STATS es un proyecto de la"," ",(0,X.jsx)("a",{className:"text-white",href:"https://municipaldemairena.com",target:"_blank",children:"Banda Municipal de M\xfasica de Mairena del Alcor"})," y ha sido desarrollado por completo por su equipo de comunicaci\xf3n."]}),(0,X.jsx)("p",{children:"Son muchas las personas que, cuando escuchan alguna de las composiciones que nuestra banda interpreta y no conocen su nombre, se acercan a nuestros m\xfasicos a preguntar qu\xe9 composici\xf3n acababa de sonar."}),(0,X.jsx)("p",{children:"A trav\xe9s de esta aplicaci\xf3n web, se podr\xe1 consultar qu\xe9 se encuentra interpretando nuestra banda con actualizaciones en tiempo real."}),(0,X.jsx)("p",{children:"Para gestionar toda la informaci\xf3n que se ofrece en esta web, nuestro equipo ha desarrolado una aplicaci\xf3n m\xf3vil de administraci\xf3n con la que se actualizan los datos con tan s\xf3lo introducir 1 dato identificador."}),(0,X.jsx)("p",{children:"En fechas futuras, se podr\xe1 hacer b\xfasquedas por actuaciones, composiciones o compositores."}),(0,X.jsx)("p",{children:"#suenaMairena"})]})}function ee(){var e=I();return(0,X.jsxs)("div",{children:[(0,X.jsx)("h1",{children:"Dashboard"}),(0,X.jsx)("button",{onClick:function(){e("/")},children:"Logout"}),(0,X.jsx)(x,{children:(0,X.jsx)(w,{path:"/welcome",element:(0,X.jsx)("p",{children:"Welcome!"})})})]})}function te(){return(0,X.jsxs)("div",{className:"px-3 align-items-stretch p-5",children:[(0,X.jsx)("h1",{children:"BMM STATS"}),(0,X.jsx)("p",{className:"lead p-3",children:"Descrubre qu\xe9 est\xe1 tocando nuestra banda en este momento. Composiciones, ubicaci\xf3n y todos los detalles de cada actuaci\xf3n"}),(0,X.jsx)("p",{className:"font-weight-light p-3",children:"Actualizaciones en tiempo real de las interpretaciones de nuestra banda en tu dispositivo."}),(0,X.jsx)("p",{className:"lead p-3",children:(0,X.jsx)(Q,{to:"/actuaciones",id:"mainButton",className:"btn btn-lg btn-secondary fw-bold border-white bg-white",children:"Actuaciones"})})]})}function ne(){return(0,X.jsx)("div",{children:"P\xe1gina no encontrada"})}function re(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(Pn){return void n(Pn)}u.done?t(s):Promise.resolve(s).then(r,i)}function ie(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){re(a,r,i,o,u,"next",e)}function u(e){re(a,r,i,o,u,"throw",e)}o(void 0)}))}}var ae=n(757),oe=n.n(ae);function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function se(e,t){return se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},se(e,t)}function ce(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&se(e,t)}function le(e){return le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},le(e)}function he(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function de(e,t){if(t&&("object"===fe(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ue(e)}function ve(e){var t=he();return function(){var n,r=le(e);if(t){var i=le(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return de(this,n)}}function pe(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw a}}}}function me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ke(e,t,n){return t&&ge(e.prototype,t),n&&ge(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e,t,n){return we=he()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&se(i,n.prototype),i},we.apply(null,arguments)}function be(e){var t="function"===typeof Map?new Map:void 0;return be=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return we(e,arguments,le(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),se(n,e)},be(e)}var xe=!1,Ee=!1,Se="${JSCORE_VERSION}",Ce=function(e,t){if(!e)throw Ie(t)},Ie=function(e){return new Error("Firebase Database ("+Se+") INTERNAL ASSERT FAILED: "+e)},Te=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Ne={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,u=o?e[i+1]:0,s=i+2<e.length,c=s?e[i+2]:0,l=a>>2,h=(3&a)<<4|u>>4,f=(15&u)<<2|c>>6,d=63&c;s||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Te(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var u=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&u)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,u=++i<e.length?n[e.charAt(i)]:64,s=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==u||null==s)throw Error();var c=a<<2|o>>4;if(r.push(c),64!==u){var l=o<<4&240|u>>2;if(r.push(l),64!==s){var h=u<<6&192|s;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},De=function(e){var t=Te(e);return Ne.encodeByteArray(t,!0)},Ae=function(e){return De(e).replace(/\./g,"")},Pe=function(e){try{return Ne.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Re(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=Re(e[n],t[n]));return e}var Oe=function(){function e(){var t=this;me(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return ke(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function Le(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ae(JSON.stringify({alg:"none",type:"JWT"})),Ae(JSON.stringify(a)),""].join(".")}function Me(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Fe(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Me())}function Ve(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function qe(){return!0===xe||!0===Ee}function Ue(){return!function(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function je(){return"object"===typeof indexedDB}var Be=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(ue(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(ue(a),ze.prototype.create),a}return ke(n)}(be(Error)),ze=function(){function e(t,n,r){me(this,e),this.service=t,this.serviceName=n,this.errors=r}return ke(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?We(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,")."),o=new Be(n,a,t);return o}}]),e}();function We(e,t){return e.replace(Ke,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var Ke=/\{\$([^}]+)}/g;function Ge(e){return JSON.parse(e)}function He(e){return JSON.stringify(e)}var Qe=function(e){var t={},n={},r={},i="";try{var a=e.split(".");t=Ge(Pe(a[0])||""),n=Ge(Pe(a[1])||""),i=a[2],r=n.d||{},delete n.d}catch(o){}return{header:t,claims:n,data:r,signature:i}};function Ye(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function $e(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Xe(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Je(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function Ze(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var u=e[o],s=t[o];if(et(u)&&et(s)){if(!Ze(u,s))return!1}else if(u!==s)return!1}for(var c=0,l=r;c<l.length;c++){var h=l[c];if(!n.includes(h))return!1}return!0}function et(e){return null!==e&&"object"===typeof e}function tt(e){for(var t=[],n=function(){var e=u(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}var nt=function(){function e(){me(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return ke(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var a=16;a<80;a++){var o=n[a-3]^n[a-8]^n[a-14]^n[a-16];n[a]=4294967295&(o<<1|o>>>31)}for(var u,s,c=this.chain_[0],l=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],v=0;v<80;v++){v<40?v<20?(u=f^l&(h^f),s=1518500249):(u=l^h^f,s=1859775393):v<60?(u=l&h|f&(l|h),s=2400959708):(u=l^h^f,s=3395469782);var p=(c<<5|c>>>27)+u+d+s+n[v]&4294967295;d=f,f=h,h=4294967295&(l<<30|l>>>2),l=c,c=p}this.chain_[0]=this.chain_[0]+c&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,a=this.inbuf_;r<t;){if(0===a)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[a]=e.charCodeAt(r),++r,++a===this.blockSize){this.compress_(i),a=0;break}}else for(;r<t;)if(i[a]=e[r],++r,++a===this.blockSize){this.compress_(i),a=0;break}}this.inbuf_=a,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var a=24;a>=0;a-=8)e[r]=this.chain_[i]>>a&255,++r;return e}}]),e}();function rt(e,t){var n=new it(e,t);return n.subscribe.bind(n)}var it=function(){function e(t,n){var r=this;me(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return ke(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=ye(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i in e&&"function"===typeof e[i])return!0}}catch(a){r.e(a)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=at),void 0===r.error&&(r.error=at),void 0===r.complete&&(r.complete=at);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function at(){}function ot(e,t){return"".concat(e," failed: ").concat(t," argument ")}var ut=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function st(e){return e&&e._delegate?e._delegate:e}function ct(e,t){return new Promise((function(n,r){e.onsuccess=function(e){n(e.target.result)},e.onerror=function(e){var n;r("".concat(t,": ").concat(null===(n=e.target.error)||void 0===n?void 0:n.message))}}))}var lt=function(){function e(t){me(this,e),this._db=t,this.objectStoreNames=this._db.objectStoreNames}return ke(e,[{key:"transaction",value:function(e,t){return new ht(this._db.transaction.call(this._db,e,t))}},{key:"createObjectStore",value:function(e,t){return new ft(this._db.createObjectStore(e,t))}},{key:"close",value:function(){this._db.close()}}]),e}(),ht=function(){function e(t){var n=this;me(this,e),this._transaction=t,this.complete=new Promise((function(e,t){n._transaction.oncomplete=function(){e()},n._transaction.onerror=function(){t(n._transaction.error)},n._transaction.onabort=function(){t(n._transaction.error)}}))}return ke(e,[{key:"objectStore",value:function(e){return new ft(this._transaction.objectStore(e))}}]),e}(),ft=function(){function e(t){me(this,e),this._store=t}return ke(e,[{key:"index",value:function(e){return new dt(this._store.index(e))}},{key:"createIndex",value:function(e,t,n){return new dt(this._store.createIndex(e,t,n))}},{key:"get",value:function(e){return ct(this._store.get(e),"Error reading from IndexedDB")}},{key:"put",value:function(e,t){return ct(this._store.put(e,t),"Error writing to IndexedDB")}},{key:"delete",value:function(e){return ct(this._store.delete(e),"Error deleting from IndexedDB")}},{key:"clear",value:function(){return ct(this._store.clear(),"Error clearing IndexedDB object store")}}]),e}(),dt=function(){function e(t){me(this,e),this._index=t}return ke(e,[{key:"get",value:function(e){return ct(this._index.get(e),"Error reading from IndexedDB")}}]),e}();var vt=function(){function e(t,n,r){me(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return ke(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),pt="[DEFAULT]",yt=function(){function e(t,n){me(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return ke(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Oe;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:pt})}catch(c){}var t,n=ye(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=u(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=ie(ae.mark((function e(){var t;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(pe(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),pe(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=ye(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=u(i.value,2),c=s[0],l=s[1],h=this.normalizeInstanceIdentifier(c);r===h&&l.resolve(a)}}catch(f){o.e(f)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=ye(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(fw){}}}catch(o){i.e(o)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===pt?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(fw){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt;return this.component?this.component.multipleInstances?e:pt:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var mt,gt,kt=function(){function e(t){me(this,e),this.name=t,this.providers=new Map}return ke(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new yt(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),_t=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(gt||(gt={}));var wt,bt,xt={debug:gt.DEBUG,verbose:gt.VERBOSE,info:gt.INFO,warn:gt.WARN,error:gt.ERROR,silent:gt.SILENT},Et=gt.INFO,St=(_e(mt={},gt.DEBUG,"log"),_e(mt,gt.VERBOSE,"log"),_e(mt,gt.INFO,"info"),_e(mt,gt.WARN,"warn"),_e(mt,gt.ERROR,"error"),mt),Ct=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=St[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i,a=arguments.length,o=new Array(a>2?a-2:0),u=2;u<a;u++)o[u-2]=arguments[u];(i=console)[r].apply(i,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},It=function(){function e(t){me(this,e),this.name=t,this._logLevel=Et,this._logHandler=Ct,this._userLogHandler=null,_t.push(this)}return ke(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in gt))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?xt[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gt.DEBUG].concat(t)),this._logHandler.apply(this,[this,gt.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gt.VERBOSE].concat(t)),this._logHandler.apply(this,[this,gt.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gt.INFO].concat(t)),this._logHandler.apply(this,[this,gt.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gt.WARN].concat(t)),this._logHandler.apply(this,[this,gt.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,gt.ERROR].concat(t)),this._logHandler.apply(this,[this,gt.ERROR].concat(t))}}]),e}();var Tt=function(){function e(t){me(this,e),this.container=t}return ke(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var Nt="@firebase/app",Dt="0.7.20",At=new It("@firebase/app"),Pt="[DEFAULT]",Rt=(_e(wt={},Nt,"fire-core"),_e(wt,"@firebase/app-compat","fire-core-compat"),_e(wt,"@firebase/analytics","fire-analytics"),_e(wt,"@firebase/analytics-compat","fire-analytics-compat"),_e(wt,"@firebase/app-check","fire-app-check"),_e(wt,"@firebase/app-check-compat","fire-app-check-compat"),_e(wt,"@firebase/auth","fire-auth"),_e(wt,"@firebase/auth-compat","fire-auth-compat"),_e(wt,"@firebase/database","fire-rtdb"),_e(wt,"@firebase/database-compat","fire-rtdb-compat"),_e(wt,"@firebase/functions","fire-fn"),_e(wt,"@firebase/functions-compat","fire-fn-compat"),_e(wt,"@firebase/installations","fire-iid"),_e(wt,"@firebase/installations-compat","fire-iid-compat"),_e(wt,"@firebase/messaging","fire-fcm"),_e(wt,"@firebase/messaging-compat","fire-fcm-compat"),_e(wt,"@firebase/performance","fire-perf"),_e(wt,"@firebase/performance-compat","fire-perf-compat"),_e(wt,"@firebase/remote-config","fire-rc"),_e(wt,"@firebase/remote-config-compat","fire-rc-compat"),_e(wt,"@firebase/storage","fire-gcs"),_e(wt,"@firebase/storage-compat","fire-gcs-compat"),_e(wt,"@firebase/firestore","fire-fst"),_e(wt,"@firebase/firestore-compat","fire-fst-compat"),_e(wt,"fire-js","fire-js"),_e(wt,"firebase","fire-js-all"),wt),Ot=new Map,Lt=new Map;function Mt(e,t){try{e.container.addComponent(t)}catch(n){At.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Ft(e,t){e.container.addOrOverwriteComponent(t)}function Vt(e){var t=e.name;if(Lt.has(t))return At.debug("There were multiple attempts to register component ".concat(t,".")),!1;Lt.set(t,e);var n,r=ye(Ot.values());try{for(r.s();!(n=r.n()).done;){Mt(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function qt(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ut(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pt;qt(e,t).clearInstance(n)}function jt(){Lt.clear()}var Bt=(_e(bt={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),_e(bt,"bad-app-name","Illegal App name: '{$appName}"),_e(bt,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),_e(bt,"app-deleted","Firebase App named '{$appName}' already deleted"),_e(bt,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),_e(bt,"invalid-log-argument","First argument to `onLog` must be null or a function."),_e(bt,"storage-open","Error thrown when opening storage. Original error: {$originalErrorMessage}."),_e(bt,"storage-get","Error thrown when reading from storage. Original error: {$originalErrorMessage}."),_e(bt,"storage-set","Error thrown when writing to storage. Original error: {$originalErrorMessage}."),_e(bt,"storage-delete","Error thrown when deleting from storage. Original error: {$originalErrorMessage}."),bt),zt=new ze("app","Firebase",Bt),Wt=function(){function e(t,n,r){var i=this;me(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new vt("app",(function(){return i}),"PUBLIC"))}return ke(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw zt.create("app-deleted",{appName:this._name})}}]),e}(),Kt="9.6.10";function Gt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==typeof t){var n=t;t={name:n}}var r=Object.assign({name:Pt,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw zt.create("bad-app-name",{appName:String(i)});var a=Ot.get(i);if(a){if(Ze(e,a.options)&&Ze(r,a.config))return a;throw zt.create("duplicate-app",{appName:i})}var o,u=new kt(i),s=ye(Lt.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;u.addComponent(c)}}catch(h){s.e(h)}finally{s.f()}var l=new Wt(e,r,u);return Ot.set(i,l),l}function Ht(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=Ot.get(e);if(!t)throw zt.create("no-app",{appName:e});return t}function Qt(){return Array.from(Ot.values())}function Yt(e){return $t.apply(this,arguments)}function $t(){return $t=ie(ae.mark((function e(t){var n;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,!Ot.has(n)){e.next=6;break}return Ot.delete(n),e.next=5,Promise.all(t.container.getProviders().map((function(e){return e.delete()})));case 5:t.isDeleted=!0;case 6:case"end":return e.stop()}}),e)}))),$t.apply(this,arguments)}function Xt(e,t,n){var r,i=null!==(r=Rt[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var u=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&u.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&u.push("and"),o&&u.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void At.warn(u.join(" "))}Vt(new vt("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function Jt(e,t){if(null!==e&&"function"!==typeof e)throw zt.create("invalid-log-argument");!function(e,t){var n,r=ye(_t);try{var i=function(){var r=n.value,i=null;t&&t.level&&(i=xt[t.level]),r.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,a=new Array(r>2?r-2:0),o=2;o<r;o++)a[o-2]=arguments[o];var u=a.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==i&&void 0!==i?i:t.logLevel)&&e({level:gt[n].toLowerCase(),message:u,args:a,type:t.name})}};for(r.s();!(n=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}}(e,t)}function Zt(e){var t;t=e,_t.forEach((function(e){e.setLogLevel(t)}))}var en="firebase-heartbeat-store",tn=null;function nn(){var e,t,n;return tn||(tn=(e="firebase-heartbeat-database",t=1,n=function(e,t){0===t&&e.createObjectStore(en)},new Promise((function(r,i){try{var a=indexedDB.open(e,t);a.onsuccess=function(e){r(new lt(e.target.result))},a.onerror=function(e){var t;i("Error opening indexedDB: ".concat(null===(t=e.target.error)||void 0===t?void 0:t.message))},a.onupgradeneeded=function(e){n(new lt(a.result),e.oldVersion,e.newVersion,new ht(a.transaction))}}catch(o){i("Error opening indexedDB: ".concat(o.message))}}))).catch((function(e){throw zt.create("storage-open",{originalErrorMessage:e.message})}))),tn}function rn(e){return an.apply(this,arguments)}function an(){return an=ie(ae.mark((function e(t){var n;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn();case 3:return n=e.sent,e.abrupt("return",n.transaction(en).objectStore(en).get(sn(t)));case 7:throw e.prev=7,e.t0=e.catch(0),zt.create("storage-get",{originalErrorMessage:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),an.apply(this,arguments)}function on(e,t){return un.apply(this,arguments)}function un(){return un=ie(ae.mark((function e(t,n){var r,i,a;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,nn();case 3:return r=e.sent,i=r.transaction(en,"readwrite"),a=i.objectStore(en),e.next=8,a.put(n,sn(t));case 8:return e.abrupt("return",i.complete);case 11:throw e.prev=11,e.t0=e.catch(0),zt.create("storage-set",{originalErrorMessage:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),un.apply(this,arguments)}function sn(e){return"".concat(e.name,"!").concat(e.options.appId)}var cn=function(){function e(t){var n=this;me(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new dn(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return ke(e,[{key:"triggerHeartbeat",value:function(){var e=ie(ae.mark((function e(){var t,n,r;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=ln(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=ie(ae.mark((function e(){var t,n,r,i,a;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=ln(),n=hn(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,a=Ae(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(i.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=i,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function ln(){return(new Date).toISOString().substring(0,10)}function hn(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=ye(e);try{var o=function(){var e=t.value,a=r.find((function(t){return t.agent===e.agent}));if(a){if(a.dates.push(e.date),vn(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),vn(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var u=o();if("break"===u)break}}catch(s){a.e(s)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}var fn,dn=function(){function e(t){me(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return ke(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=ie(ae.mark((function e(){return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(je()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(Pn){t(Pn)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=ie(ae.mark((function e(){var t;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,rn(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=ie(ae.mark((function e(t){var n,r;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",on(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=ie(ae.mark((function e(t){var n,r;return ae.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",on(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(pe(r.heartbeats),pe(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function vn(e){return Ae(JSON.stringify({version:2,heartbeats:e})).length}fn="",Vt(new vt("platform-logger",(function(e){return new Tt(e)}),"PRIVATE")),Vt(new vt("heartbeat",(function(e){return new cn(e)}),"PRIVATE")),Xt(Nt,Dt,fn),Xt(Nt,Dt,"esm2017"),Xt("fire-js","");var pn="@firebase/database",yn="0.12.7",mn="";var gn=function(){function e(t){me(this,e),this.domStorage_=t,this.prefix_="firebase:"}return ke(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),He(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Ge(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),kn=function(){function e(){me(this,e),this.cache_={},this.isInMemoryStorage=!0}return ke(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return Ye(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),_n=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new gn(t)}}catch(n){}return new kn},wn=_n("localStorage"),bn=_n("sessionStorage"),xn=new It("@firebase/database"),En=function(){var e=1;return function(){return e++}}(),Sn=function(e){var t=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,Ce(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new nt;n.update(t);var r=n.digest();return Ne.encodeByteArray(r)},Cn=function e(){for(var t="",n=0;n<arguments.length;n++){var r=n<0||arguments.length<=n?void 0:arguments[n];Array.isArray(r)||r&&"object"===typeof r&&"number"===typeof r.length?t+=e.apply(null,r):t+="object"===typeof r?He(r):r,t+=" "}return t},In=null,Tn=!0,Nn=function(e,t){Ce(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(xn.logLevel=gt.VERBOSE,In=xn.log.bind(xn),t&&bn.set("logging_enabled",!0)):"function"===typeof e?In=e:(In=null,bn.remove("logging_enabled"))},Dn=function(){if(!0===Tn&&(Tn=!1,null===In&&!0===bn.get("logging_enabled")&&Nn(!0)),In){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Cn.apply(null,t);In(r)}},An=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Dn.apply(void 0,[e].concat(n))}},Pn=function(){var e="FIREBASE INTERNAL ERROR: "+Cn.apply(void 0,arguments);xn.error(e)},Rn=function(){var e="FIREBASE FATAL ERROR: ".concat(Cn.apply(void 0,arguments));throw xn.error(e),new Error(e)},On=function(){var e="FIREBASE WARNING: "+Cn.apply(void 0,arguments);xn.warn(e)},Ln=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Mn="[MIN_NAME]",Fn="[MAX_NAME]",Vn=function(e,t){if(e===t)return 0;if(e===Mn||t===Fn)return-1;if(t===Mn||e===Fn)return 1;var n=Qn(e),r=Qn(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},qn=function(e,t){return e===t?0:e<t?-1:1},Un=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+He(t))},jn=function e(t){if("object"!==typeof t||null===t)return He(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=He(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},Bn=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function zn(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var Wn=function(e){Ce(!Ln(e),"Invalid JSON number");var t,n,r,i,a,o=1023;0===e?(n=0,r=0,t=1/e===-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),o))+o,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var u=[];for(a=52;a;a-=1)u.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)u.push(n%2?1:0),n=Math.floor(n/2);u.push(t?1:0),u.reverse();var s=u.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(s.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()};var Kn=new RegExp("^-?(0*)\\d{1,10}$"),Gn=-2147483648,Hn=2147483647,Qn=function(e){if(Kn.test(e)){var t=Number(e);if(t>=Gn&&t<=Hn)return t}return null},Yn=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw On("Exception was thrown by user callback.",e),t}),Math.floor(0))}},$n=function(e,t){var n=setTimeout(e,t);return"object"===typeof n&&n.unref&&n.unref(),n},Xn=function(){function e(t,n){var r=this;me(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null===n||void 0===n?void 0:n.getImmediate({optional:!0}),this.appCheck||null===n||void 0===n||n.get().then((function(e){return r.appCheck=e}))}return ke(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){setTimeout((function(){t.appCheck?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){On('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),e}(),Jn=function(){function e(t,n,r){var i=this;me(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit((function(e){return i.auth_=e}))}return ke(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(Dn("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){setTimeout((function(){t.auth_?t.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',On(e)}}]),e}(),Zn=function(){function e(t){me(this,e),this.accessToken=t}return ke(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();Zn.OWNER="owner";var er="5",tr=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,nr="websocket",rr="long_polling",ir=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];me(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=o,this.includeNamespaceInQueryParams=u,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=wn.get("host:"+t)||this._host}return ke(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&wn.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),e}();function ar(e,t,n){var r;if(Ce("string"===typeof t,"typeof type must == string"),Ce("object"===typeof n,"typeof params must == object"),t===nr)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==rr)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return zn(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}var or=function(){function e(){me(this,e),this.counters_={}}return ke(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Ye(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return Re(void 0,this.counters_)}}]),e}(),ur={},sr={};function cr(e){var t=e.toString();return ur[t]||(ur[t]=new or),ur[t]}var lr=function(){function e(t){me(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return ke(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=n.pendingResponses[n.currentResponseNum];delete n.pendingResponses[n.currentResponseNum];for(var t=function(t){e[t]&&Yn((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(n.currentResponseNum===n.closeAfterResponse)return n.onClose&&(n.onClose(),n.onClose=null),"break";n.currentResponseNum++};this.pendingResponses[this.currentResponseNum];){if("break"===r())break}}}]),e}(),hr="start",fr="close",dr=function(){function e(t,n,r,i,a,o,u){var s=this;me(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=o,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=An(t),this.stats_=cr(n),this.urlFn=function(e){return s.appCheckToken&&(e.ac=s.appCheckToken),ar(n,rr,e)}}return ke(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new lr(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(qe()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new vr((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1],o=t[2];t[3],t[4];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===hr)n.id=a,n.password=o;else{if(i!==fr)throw new Error("Unrecognized command received: "+i);a?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(a,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0],a=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,a)}),(function(){n.onClosed_()}),n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v=er,n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),n.appCheckToken&&(e.ac=n.appCheckToken),"undefined"!==typeof location&&location.hostname&&tr.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=He(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=De(t),r=Bn(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!qe()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=He(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!qe()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}}]),e}(),vr=function(){function e(t,n,r,i){if(me(this,e),this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,qe())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=En(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a='<script>document.domain="'+document.domain+'";<\/script>';var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(u){Dn("frame writing exception"),u.stack&&Dn(u.stack),Dn(u)}}}return ke(e,[{key:"close",value:function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))}},{key:"addTag",value:function(e,t){var n=this;qe()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){Dn("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Dn("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),pr=null;"undefined"!==typeof MozWebSocket?pr=MozWebSocket:"undefined"!==typeof WebSocket&&(pr=WebSocket);var yr=function(){function e(t,n,r,i,a,o,u){me(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=An(this.connId),this.stats_=cr(n),this.connURL=e.connectionURL_(n,o,u,i),this.nodeAdmin=n.nodeAdmin}return ke(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,wn.set("previous_websocket_failure",!0);try{if(qe()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/".concat(er,"/").concat(mn,"/").concat(process.platform,"/").concat(r),"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},o=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(i.proxy={origin:o}),this.mySock=new pr(this.connURL,[],i)}else{var u={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new pr(this.connURL,[],u)}}catch(c){this.log_("Error instantiating WebSocket.");var s=c.message||c.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){wn.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Ge(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(Ce(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=He(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=Bn(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r){var i={};return i.v=er,!qe()&&"undefined"!==typeof location&&location.hostname&&tr.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i.ac=r),ar(e,nr,i)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==pr&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return wn.isInMemoryStorage||!0===wn.get("previous_websocket_failure")}}]),e}();yr.responsesRequiredToBeHealthy=2,yr.healthyTimeout=3e4;var mr=function(){function e(t){me(this,e),this.initTransports_(t)}return ke(e,[{key:"initTransports_",value:function(t){var n=yr&&yr.isAvailable(),r=n&&!yr.previouslyFailed();if(t.webSocketOnly&&(n||On("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[yr];else{var i,a=this.transports_=[],o=ye(e.ALL_TRANSPORTS);try{for(o.s();!(i=o.n()).done;){var u=i.value;u&&u.isAvailable()&&a.push(u)}}catch(s){o.e(s)}finally{o.f()}}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[dr,yr]}}]),e}(),gr=function(){function e(t,n,r,i,a,o,u,s,c,l){me(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=o,this.onReady_=u,this.onDisconnect_=s,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=An("c:"+this.id+":"),this.transportManager_=new mr(n),this.log_("Connection created"),this.start_()}return ke(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=$n((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=Un("t",e),n=Un("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=Un("t",e),n=Un("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=Un("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Pn("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Pn("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),er!==n&&On("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),$n((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):$n((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(wn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),kr=function(){function e(){me(this,e)}return ke(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),_r=function(){function e(t){me(this,e),this.allowedEvents_=t,this.listeners_={},Ce(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return ke(e,[{key:"trigger",value:function(e){if(Array.isArray(this.listeners_[e])){for(var t=pe(this.listeners_[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var a=0;a<t.length;a++)t[a].callback.apply(t[a].context,r)}}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){Ce(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),e}(),wr=function(e){ce(n,e);var t=ve(n);function n(){var e;return me(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Fe()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return ke(n,[{key:"getInitialEvent",value:function(e){return Ce("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(_r),br=function(){function e(t,n){if(me(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return ke(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function xr(){return new br("")}function Er(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Sr(e){return e.pieces_.length-e.pieceNum_}function Cr(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new br(e.pieces_,t)}function Ir(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Tr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function Nr(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new br(t,0)}function Dr(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof br)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var a=t.split("/"),o=0;o<a.length;o++)a[o].length>0&&n.push(a[o]);return new br(n,0)}function Ar(e){return e.pieceNum_>=e.pieces_.length}function Pr(e,t){var n=Er(e),r=Er(t);if(null===n)return t;if(n===r)return Pr(Cr(e),Cr(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Rr(e,t){if(Sr(e)!==Sr(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Or(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(Sr(e)>Sr(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var Lr=ke((function e(t,n){me(this,e),this.errorPrefix_=n,this.parts_=Tr(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=ut(this.parts_[r]);Mr(this)}));function Mr(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Fr(e))}function Fr(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var Vr=function(e){ce(n,e);var t=ve(n);function n(){var e,r,i;return me(this,n),e=t.call(this,["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(i="visibilitychange",r="hidden"):"undefined"!==typeof document.mozHidden?(i="mozvisibilitychange",r="mozHidden"):"undefined"!==typeof document.msHidden?(i="msvisibilitychange",r="msHidden"):"undefined"!==typeof document.webkitHidden&&(i="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,i&&document.addEventListener(i,(function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))}),!1),e}return ke(n,[{key:"getInitialEvent",value:function(e){return Ce("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(_r),qr=1e3,Ur=function(e){ce(n,e);var t=ve(n);function n(e,r,i,a,o,u,s,c){var l;if(me(this,n),(l=t.call(this)).repoInfo_=e,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=u,l.appCheckTokenProvider_=s,l.authOverride_=c,l.id=n.nextPersistentConnectionId_++,l.log_=An("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=qr,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.appCheckToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.invalidAppCheckTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,c&&!qe())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Vr.getInstance().on("visible",l.onVisible_,ue(l)),-1===e.host.indexOf("fblocal")&&wr.getInstance().on("online",l.onOnline_,ue(l)),l}return ke(n,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(He(i)),Ce(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){var t=this;this.initConnection_();var n=new Oe,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var e=t.outstandingGets_[a];void 0!==e&&i===e&&(delete t.outstandingGets_[a],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),Ce(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ce(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,r=e.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=r._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,(function(o){var u=o.d,s=o.s;n.warnOnListenWarnings_(u,r),(t.listens.get(i)&&t.listens.get(i).get(a))===e&&(t.log_("listen response",o),"ok"!==s&&t.removeListen_(i,a),e.onComplete&&e.onComplete(s,u))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||function(e){var t=Qe(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=function(e){var t=Qe(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Ce(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var a={p:t,d:n};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:r}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))}},{key:"reportStats",value:function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+He(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Pn("Unrecognized action received from server: "+He(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;Ce(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=qr,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=qr,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=qr),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=ie(oe().mark((function e(){var t,r,i,a,o,s,c,l,h,f,d,v,p,y,m=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldReconnect_()){e.next=30;break}return this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,s=!1,c=null,l=function(){c?c.close():(s=!0,i())},h=function(e){Ce(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)},this.realtime_={close:l,sendRequest:h},f=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,e.prev=16,e.next=19,Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);case 19:d=e.sent,v=u(d,2),p=v[0],y=v[1],s?Dn("getToken() completed but was canceled"):(Dn("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=y&&y.token,c=new gr(a,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,(function(e){On(e+" ("+m.repoInfo_.toString()+")"),m.interrupt("server_kill")}),o)),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(16),this.log_("Failed to get token: "+e.t0),s||(this.repoInfo_.nodeAdmin&&On(e.t0),l());case 30:case"end":return e.stop()}}),e,this,[[16,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"interrupt",value:function(e){Dn("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){Dn("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Xe(this.interruptReasons_)&&(this.reconnectDelay_=qr,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return jn(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new br(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){Dn("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){Dn("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e,t=ye(this.listens.values());try{for(t.s();!(e=t.n()).done;){var n,r=ye(e.value.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;this.sendListen_(i)}}catch(s){r.e(s)}finally{r.f()}}}catch(s){t.e(s)}finally{t.f()}for(var a=0;a<this.outstandingPuts_.length;a++)this.outstandingPuts_[a]&&this.sendPut_(a);for(;this.onDisconnectRequestQueue_.length;){var o=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(o.action,o.pathString,o.data,o.onComplete)}for(var u=0;u<this.outstandingGets_.length;u++)this.outstandingGets_[u]&&this.sendGet_(u)}},{key:"sendConnectStats_",value:function(){var e={},t="js";qe()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+mn.replace(/\./g,"-")]=1,Fe()?e["framework.cordova"]=1:Ve()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=wr.getInstance().currentlyOnline();return Xe(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"===typeof e&&Ye(e,"w")){var n=$e(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();On("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(i," to your security rules for better performance."))}}}}]),n}(kr);Ur.nextPersistentConnectionId_=0,Ur.nextConnectionId_=0;var jr,Br=function(){function e(t,n){me(this,e),this.name=t,this.node=n}return ke(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),zr=function(){function e(){me(this,e)}return ke(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new Br(Mn,e),r=new Br(Mn,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return Br.MIN}}]),e}(),Wr=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"compare",value:function(e,t){return Vn(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw Ie("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return Br.MIN}},{key:"maxPost",value:function(){return new Br(Fn,jr)}},{key:"makePost",value:function(e,t){return Ce("string"===typeof e,"KeyIndex indexValue must always be a string."),new Br(e,jr)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return jr},set:function(e){jr=e}}]),n}(zr),Kr=new Wr,Gr=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;me(this,e),this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return ke(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),Hr=function(){function e(t,n,r,i,a){me(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:$r.EMPTY_NODE,this.right=null!=a?a:$r.EMPTY_NODE}return ke(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return $r.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return $r.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();Hr.RED=!0,Hr.BLACK=!1;var Qr,Yr=function(){function e(){me(this,e)}return ke(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new Hr(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}(),$r=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;me(this,e),this.comparator_=t,this.root_=n}return ke(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Hr.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Hr.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new Gr(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new Gr(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new Gr(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new Gr(this.root_,null,this.comparator_,!0,e)}}]),e}();function Xr(e,t){return Vn(e.name,t.name)}function Jr(e,t){return Vn(e,t)}$r.EMPTY_NODE=new Yr;var Zr,ei,ti,ni=function(e){return"number"===typeof e?"number:"+Wn(e):"string:"+e},ri=function(e){if(e.isLeafNode()){var t=e.val();Ce("string"===typeof t||"number"===typeof t||"object"===typeof t&&Ye(t,".sv"),"Priority must be a string or number.")}else Ce(e===Qr||e.isEmpty(),"priority of unexpected type.");Ce(e===Qr||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},ii=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;me(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,Ce(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ri(this.priorityNode_)}return ke(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return Ar(t)?this:".priority"===Er(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=Er(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(Ce(".priority"!==r||1===Sr(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(Cr(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+ni(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?Wn(this.value_):this.value_,this.lazyHash_=Sn(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(Ce(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return Ce(i>=0,"Unknown leaf type: "+n),Ce(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return Zr},set:function(e){Zr=e}}]),e}();ii.VALUE_TYPE_ORDER=["object","boolean","number","string"];var ai,oi,ui=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Vn(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return Br.MIN}},{key:"maxPost",value:function(){return new Br(Fn,new ii("[PRIORITY-POST]",ti))}},{key:"makePost",value:function(e,t){var n=ei(e);return new Br(t,new ii("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(zr),si=new ui,ci=Math.log(2),li=function(){function e(t){me(this,e);var n;this.count=(n=t+1,parseInt(Math.log(n)/ci,10)),this.current_=this.count-1;var r,i=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=t+1&i}return ke(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),hi=function(e,t,n,r){e.sort(t);var i=function t(r,i){var a,o,u=i-r;if(0===u)return null;if(1===u)return a=e[r],o=n?n(a):a,new Hr(o,a.node,Hr.BLACK,null,null);var s=parseInt(u/2,10)+r,c=t(r,s),l=t(s+1,i);return a=e[s],o=n?n(a):a,new Hr(o,a.node,Hr.BLACK,c,l)},a=function(t){for(var r=null,a=null,o=e.length,u=function(t,r){var a=o-t,u=o;o-=t;var c=i(a+1,u),l=e[a],h=n?n(l):l;s(new Hr(h,l.node,r,null,c))},s=function(e){r?(r.left=e,r=e):(a=e,r=e)},c=0;c<t.count;++c){var l=t.nextBitIsOne(),h=Math.pow(2,t.count-(c+1));l?u(h,Hr.BLACK):(u(h,Hr.BLACK),u(h,Hr.RED))}return a}(new li(e.length));return new $r(r||t,a)},fi={},di=function(){function e(t,n){me(this,e),this.indexes_=t,this.indexSet_=n}return ke(e,[{key:"get",value:function(e){var t=$e(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof $r?t:null}},{key:"hasIndex",value:function(e){return Ye(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){Ce(t!==Kr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,o=n.getIterator(Br.Wrap),u=o.getNext();u;)a=a||t.isDefinedOn(u.node),i.push(u),u=o.getNext();r=a?hi(i,t.getCompare()):fi;var s=t.toString(),c=Object.assign({},this.indexSet_);c[s]=t;var l=Object.assign({},this.indexes_);return l[s]=r,new e(l,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(Je(this.indexes_,(function(e,i){var a=$e(r.indexSet_,i);if(Ce(a,"Missing index implementation for "+i),e===fi){if(a.isDefinedOn(t.node)){for(var o=[],u=n.getIterator(Br.Wrap),s=u.getNext();s;)s.name!==t.name&&o.push(s),s=u.getNext();return o.push(t),hi(o,a.getCompare())}return fi}var c=n.get(t.name),l=e;return c&&(l=l.remove(new Br(t.name,c))),l.insert(t,t.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(Je(this.indexes_,(function(e){if(e===fi)return e;var r=n.get(t.name);return r?e.remove(new Br(t.name,r)):e})),this.indexSet_)}}],[{key:"Default",get:function(){return Ce(fi&&si,"ChildrenNode.ts has not been loaded"),ai=ai||new e({".priority":fi},{".priority":si})}}]),e}(),vi=function(){function e(t,n,r){me(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&ri(this.priorityNode_),this.children_.isEmpty()&&Ce(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return ke(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||oi}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?oi:t}},{key:"getChild",value:function(e){var t=Er(e);return null===t?this:this.getImmediateChild(t).getChild(Cr(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(Ce(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,a=new Br(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(a,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(a,this.children_));var o=r.isEmpty()?oi:this.priorityNode_;return new e(r,o,i)}},{key:"updateChild",value:function(e,t){var n=Er(e);if(null===n)return t;Ce(".priority"!==Er(e)||1===Sr(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(Cr(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,a=!0;if(this.forEachChild(si,(function(o,u){n[o]=u.val(t),r++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1})),!t&&a&&i<2*r){var o=[];for(var u in n)o[u]=n[u];return o}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+ni(this.getPriority().val())+":"),this.forEachChild(si,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Sn(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Br(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new Br(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new Br(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,Br.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,Br.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===pi?-1:0}},{key:"withIndex",value:function(t){if(t===Kr||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===Kr||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(si),r=t.getIterator(si),i=n.getNext(),a=r.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=n.getNext(),a=r.getNext()}return null===i&&null===a}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===Kr?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return oi||(oi=new e(new $r(Jr),null,di.Default))}}]),e}();vi.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var pi=new(function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.call(this,new $r(Jr),vi.EMPTY_NODE,di.Default)}return ke(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return vi.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(vi));Object.defineProperties(Br,{MIN:{value:new Br(Mn,vi.EMPTY_NODE)},MAX:{value:new Br(Fn,pi)}}),Wr.__EMPTY_NODE=vi.EMPTY_NODE,ii.__childrenNodeConstructor=vi,Qr=pi,function(e){ti=e}(pi);function yi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return vi.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),Ce(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){var n=e;return new ii(n,yi(t))}if(e instanceof Array){var r=vi.EMPTY_NODE;return zn(e,(function(t,n){if(Ye(e,t)&&"."!==t.substring(0,1)){var i=yi(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(t,i))}})),r.updatePriority(yi(t))}var i=[],a=!1,o=e;if(zn(o,(function(e,t){if("."!==e.substring(0,1)){var n=yi(t);n.isEmpty()||(a=a||!n.getPriority().isEmpty(),i.push(new Br(e,n)))}})),0===i.length)return vi.EMPTY_NODE;var u=hi(i,Xr,(function(e){return e.name}),Jr);if(a){var s=hi(i,si.getCompare());return new vi(u,yi(t),new di({".priority":s},{".priority":si}))}return new vi(u,yi(t),di.Default)}!function(e){ei=e}(yi);var mi=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this)).indexPath_=e,Ce(!Ar(e)&&".priority"!==Er(e),"Can't create PathIndex with empty path or .priority key"),r}return ke(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Vn(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=yi(e),r=vi.EMPTY_NODE.updateChild(this.indexPath_,n);return new Br(t,r)}},{key:"maxPost",value:function(){var e=vi.EMPTY_NODE.updateChild(this.indexPath_,pi);return new Br(Fn,e)}},{key:"toString",value:function(){return Tr(this.indexPath_,0).join("/")}}]),n}(zr),gi=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?Vn(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return Br.MIN}},{key:"maxPost",value:function(){return Br.MAX}},{key:"makePost",value:function(e,t){var n=yi(e);return new Br(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(zr),ki=new gi,_i="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){var e=0,t=[]}();function wi(e){return{type:"value",snapshotNode:e}}function bi(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function xi(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Ei(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var Si=function(){function e(t){me(this,e),this.index_=t}return ke(e,[{key:"updateChild",value:function(e,t,n,r,i,a){Ce(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=a&&(n.isEmpty()?e.hasChild(t)?a.trackChildChange(xi(t,o)):Ce(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(bi(t,n)):a.trackChildChange(Ei(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}},{key:"updateFullNode",value:function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(si,(function(e,r){t.hasChild(e)||n.trackChildChange(xi(e,r))})),t.isLeafNode()||t.forEachChild(si,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Ei(t,r,i))}else n.trackChildChange(bi(t,r))}))),t.withIndex(this.index_)}},{key:"updatePriority",value:function(e,t){return e.isEmpty()?vi.EMPTY_NODE:e.updatePriority(t)}},{key:"filtersNodes",value:function(){return!1}},{key:"getIndexedFilter",value:function(){return this}},{key:"getIndex",value:function(){return this.index_}}]),e}(),Ci=function(){function e(t){me(this,e),this.indexedFilter_=new Si(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return ke(e,[{key:"getStartPost",value:function(){return this.startPost_}},{key:"getEndPost",value:function(){return this.endPost_}},{key:"matches",value:function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}},{key:"updateChild",value:function(e,t,n,r,i,a){return this.matches(new Br(t,n))||(n=vi.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,a)}},{key:"updateFullNode",value:function(e,t,n){t.isLeafNode()&&(t=vi.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(vi.EMPTY_NODE);var i=this;return t.forEachChild(si,(function(e,t){i.matches(new Br(e,t))||(r=r.updateImmediateChild(e,vi.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.indexedFilter_}},{key:"getIndex",value:function(){return this.index_}}],[{key:"getStartPost_",value:function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}},{key:"getEndPost_",value:function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}]),e}(),Ii=function(){function e(t){me(this,e),this.rangedFilter_=new Ci(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return ke(e,[{key:"updateChild",value:function(e,t,n,r,i,a){return this.rangedFilter_.matches(new Br(t,n))||(n=vi.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,a):this.fullLimitUpdateChild_(e,t,n,i,a)}},{key:"updateFullNode",value:function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=vi.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var i;r=vi.EMPTY_NODE.withIndex(this.index_),i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;i.hasNext()&&a<this.limit_;){var o=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),o)<=0:this.index_.compare(o,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(o.name,o.node),a++}}else{var u,s,c,l;if(r=(r=t.withIndex(this.index_)).updatePriority(vi.EMPTY_NODE),this.reverse_){l=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),s=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(e,t){return h(t,e)}}else l=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),s=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();for(var f=0,d=!1;l.hasNext();){var v=l.getNext();!d&&c(u,v)<=0&&(d=!0),d&&f<this.limit_&&c(v,s)<=0?f++:r=r.updateImmediateChild(v.name,vi.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.rangedFilter_.getIndexedFilter()}},{key:"getIndex",value:function(){return this.index_}},{key:"fullLimitUpdateChild_",value:function(e,t,n,r,i){var a;if(this.reverse_){var o=this.index_.getCompare();a=function(e,t){return o(t,e)}}else a=this.index_.getCompare();var u=e;Ce(u.numChildren()===this.limit_,"");var s=new Br(t,n),c=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),l=this.rangedFilter_.matches(s);if(u.hasChild(t)){for(var h=u.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===t||u.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:a(f,s);if(l&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(Ei(t,n,h)),u.updateImmediateChild(t,n);null!=i&&i.trackChildChange(xi(t,h));var v=u.updateImmediateChild(t,vi.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(bi(f.name,f.node)),v.updateImmediateChild(f.name,f.node)):v}return n.isEmpty()?e:l&&a(c,s)>=0?(null!=i&&(i.trackChildChange(xi(c.name,c.node)),i.trackChildChange(bi(t,n))),u.updateImmediateChild(t,n).updateImmediateChild(c.name,vi.EMPTY_NODE)):e}}]),e}(),Ti=function(){function e(){me(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=si}return ke(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"hasStartAfter",value:function(){return this.startAfterSet_}},{key:"hasEndBefore",value:function(){return this.endBeforeSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return Ce(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return Ce(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Mn}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return Ce(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return Ce(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Fn}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return Ce(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===si}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();function Ni(e){var t,n={};return e.isDefault()||(e.index_===si?t="$priority":e.index_===ki?t="$value":e.index_===Kr?t="$key":(Ce(e.index_ instanceof mi,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=He(t),e.startSet_&&(n.startAt=He(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+He(e.indexStartName_))),e.endSet_&&(n.endAt=He(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+He(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function Di(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==si&&(t.i=e.index_.toString()),t}var Ai=function(e){ce(n,e);var t=ve(n);function n(e,r,i,a){var o;return me(this,n),(o=t.call(this)).repoInfo_=e,o.onDataUpdate_=r,o.authTokenProvider_=i,o.appCheckTokenProvider_=a,o.log_=An("p:rest:"),o.listens_={},o}return ke(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var a=this,o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);var u=n.getListenId_(e,r),s={};this.listens_[u]=s;var c=Ni(e._queryParams);this.restRequest_(o+".json",c,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(o,n,!1,r),$e(a.listens_,u)===s)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=Ni(e._queryParams),r=e._path.toString(),i=new Oe;return this.restRequest_(r+".json",n,(function(e,n){var a=n;404===e&&(a=null,e=null),null===e?(t.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))})),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var a=u(i,2),o=a[0],s=a[1];o&&o.accessToken&&(n.auth=o.accessToken),s&&s.token&&(n.ac=s.token);var c=(t.repoInfo_.secure?"https://":"http://")+t.repoInfo_.host+e+"?ns="+t.repoInfo_.namespace+tt(n);t.log_("Sending REST request for "+c);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(r&&4===l.readyState){t.log_("REST Response for "+c+" received. status:",l.status,"response:",l.responseText);var e=null;if(l.status>=200&&l.status<300){try{e=Ge(l.responseText)}catch(n){On("Failed to parse JSON response for "+c+": "+l.responseText)}r(null,e)}else 401!==l.status&&404!==l.status&&On("Got unsuccessful REST response for "+c+" Status: "+l.status),r(l.status);r=null}},l.open("GET",c,!0),l.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(Ce(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(kr),Pi=function(){function e(){me(this,e),this.rootNode_=vi.EMPTY_NODE}return ke(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();function Ri(){return{value:null,children:new Map}}function Oi(e,t,n){if(Ar(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=Er(t);e.children.has(r)||e.children.set(r,Ri()),Oi(e.children.get(r),t=Cr(t),n)}}function Li(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}(e,(function(e,r){Li(r,new br(t.toString()+"/"+e),n)}))}var Mi,Fi=function(){function e(t){me(this,e),this.collection_=t,this.last_=null}return ke(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&zn(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),e}(),Vi=function(){function e(t,n){me(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new Fi(t);var r=1e4+2e4*Math.random();$n(this.reportStats_.bind(this),Math.floor(r))}return ke(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;zn(t,(function(t,i){i>0&&Ye(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),$n(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}();function qi(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Mi||(Mi={}));var Ui,ji=function(){function e(t,n,r){me(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=Mi.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return ke(e,[{key:"operationForChild",value:function(t){if(Ar(this.path)){if(null!=this.affectedTree.value)return Ce(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new br(t));return new e(xr(),n,this.revert)}return Ce(Er(this.path)===t,"operationForChild called for unrelated child."),new e(Cr(this.path),this.affectedTree,this.revert)}}]),e}(),Bi=function(){function e(t,n){me(this,e),this.source=t,this.path=n,this.type=Mi.LISTEN_COMPLETE}return ke(e,[{key:"operationForChild",value:function(t){return Ar(this.path)?new e(this.source,xr()):new e(this.source,Cr(this.path))}}]),e}(),zi=function(){function e(t,n,r){me(this,e),this.source=t,this.path=n,this.snap=r,this.type=Mi.OVERWRITE}return ke(e,[{key:"operationForChild",value:function(t){return Ar(this.path)?new e(this.source,xr(),this.snap.getImmediateChild(t)):new e(this.source,Cr(this.path),this.snap)}}]),e}(),Wi=function(){function e(t,n,r){me(this,e),this.source=t,this.path=n,this.children=r,this.type=Mi.MERGE}return ke(e,[{key:"operationForChild",value:function(t){if(Ar(this.path)){var n=this.children.subtree(new br(t));return n.isEmpty()?null:n.value?new zi(this.source,xr(),n.value):new e(this.source,xr(),n)}return Ce(Er(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,Cr(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),Ki=function(){function e(t,n,r){me(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return ke(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(Ar(e))return this.isFullyInitialized()&&!this.filtered_;var t=Er(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}(),Gi=ke((function e(t){me(this,e),this.query_=t,this.index_=this.query_._queryParams.getIndex()}));function Hi(e,t,n,r,i,a){var o=r.filter((function(e){return e.type===n}));o.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw Ie("Should only compare child_ events.");var r=new Br(t.childName,t.snapshotNode),i=new Br(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)})),o.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Qi(e,t){return{eventCache:e,serverCache:t}}function Yi(e,t,n,r){return Qi(new Ki(t,n,r),e.serverCache)}function $i(e,t,n,r){return Qi(e.eventCache,new Ki(t,n,r))}function Xi(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ji(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var Zi=function(){return Ui||(Ui=new $r(qn)),Ui},ea=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zi();me(this,e),this.value=t,this.children=n}return ke(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:xr(),value:this.value};if(Ar(e))return null;var n=Er(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(Cr(e),t);return null!=i?{path:Dr(new br(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(t){if(Ar(t))return this;var n=Er(t),r=this.children.get(n);return null!==r?r.subtree(Cr(t)):new e(null)}},{key:"set",value:function(t,n){if(Ar(t))return new e(n,this.children);var r=Er(t),i=(this.children.get(r)||new e(null)).set(Cr(t),n),a=this.children.insert(r,i);return new e(this.value,a)}},{key:"remove",value:function(t){if(Ar(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=Er(t),r=this.children.get(n);if(r){var i,a=r.remove(Cr(t));return i=a.isEmpty()?this.children.remove(n):this.children.insert(n,a),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(Ar(e))return this.value;var t=Er(e),n=this.children.get(t);return n?n.get(Cr(e)):null}},{key:"setTree",value:function(t,n){if(Ar(t))return n;var r,i=Er(t),a=(this.children.get(i)||new e(null)).setTree(Cr(t),n);return r=a.isEmpty()?this.children.remove(i):this.children.insert(i,a),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(xr(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Dr(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,xr(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(Ar(e))return null;var i=Er(e),a=this.children.get(i);return a?a.findOnPath_(Cr(e),Dr(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,xr(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(Ar(t))return this;this.value&&r(n,this.value);var i=Er(t),a=this.children.get(i);return a?a.foreachOnPath_(Cr(t),Dr(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(xr(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(Dr(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(t){var n=new e(null);return zn(t,(function(e,t){n=n.set(new br(e),t)})),n}}]),e}(),ta=function(){function e(t){me(this,e),this.writeTree_=t}return ke(e,null,[{key:"empty",value:function(){return new e(new ea(null))}}]),e}();function na(e,t,n){if(Ar(t))return new ta(new ea(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,a=r.value,o=Pr(i,t);return a=a.updateChild(o,n),new ta(e.writeTree_.set(i,a))}var u=new ea(n),s=e.writeTree_.setTree(t,u);return new ta(s)}function ra(e,t,n){var r=e;return zn(n,(function(e,n){r=na(r,Dr(t,e),n)})),r}function ia(e,t){if(Ar(t))return ta.empty();var n=e.writeTree_.setTree(t,new ea(null));return new ta(n)}function aa(e,t){return null!=oa(e,t)}function oa(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Pr(n.path,t)):null}function ua(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(si,(function(e,n){t.push(new Br(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new Br(e,n.value))})),t}function sa(e,t){if(Ar(t))return e;var n=oa(e,t);return new ta(null!=n?new ea(n):e.writeTree_.subtree(t))}function ca(e){return e.writeTree_.isEmpty()}function la(e,t){return ha(xr(),e.writeTree_,t)}function ha(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(Ce(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=ha(Dr(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Dr(e,".priority"),r)),n}function fa(e,t){return Ca(t,e)}function da(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}function va(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));Ce(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,o=e.allWrites.length-1;i&&o>=0;){var u=e.allWrites[o];u.visible&&(o>=n&&pa(u,r.path)?i=!1:Or(r.path,u.path)&&(a=!0)),o--}if(i){if(a)return function(e){e.visibleWrites=ma(e.allWrites,ya,xr()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=ia(e.visibleWrites,r.path):zn(r.children,(function(t){e.visibleWrites=ia(e.visibleWrites,Dr(r.path,t))}));return!0}return!1}function pa(e,t){if(e.snap)return Or(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&Or(Dr(e.path,n),t))return!0;return!1}function ya(e){return e.visible}function ma(e,t,n){for(var r=ta.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,u=void 0;if(a.snap)Or(n,o)?r=na(r,u=Pr(n,o),a.snap):Or(o,n)&&(u=Pr(o,n),r=na(r,xr(),a.snap.getChild(u)));else{if(!a.children)throw Ie("WriteRecord should have .snap or .children");if(Or(n,o))r=ra(r,u=Pr(n,o),a.children);else if(Or(o,n))if(Ar(u=Pr(o,n)))r=ra(r,xr(),a.children);else{var s=$e(a.children,Er(u));if(s){var c=s.getChild(Cr(u));r=na(r,xr(),c)}}}}}return r}function ga(e,t,n,r,i){if(r||i){var a=sa(e.visibleWrites,t);if(!i&&ca(a))return n;if(i||null!=n||aa(a,xr())){return la(ma(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Or(e.path,t)||Or(t,e.path))}),t),n||vi.EMPTY_NODE)}return null}var o=oa(e.visibleWrites,t);if(null!=o)return o;var u=sa(e.visibleWrites,t);return ca(u)?n:null!=n||aa(u,xr())?la(u,n||vi.EMPTY_NODE):null}function ka(e,t,n,r){return ga(e.writeTree,e.treePath,t,n,r)}function _a(e,t){return function(e,t,n){var r=vi.EMPTY_NODE,i=oa(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(si,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var a=sa(e.visibleWrites,t);return n.forEachChild(si,(function(e,t){var n=la(sa(a,new br(e)),t);r=r.updateImmediateChild(e,n)})),ua(a).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return ua(sa(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function wa(e,t,n,r){return function(e,t,n,r,i){Ce(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=Dr(t,n);if(aa(e.visibleWrites,a))return null;var o=sa(e.visibleWrites,a);return ca(o)?i.getChild(n):la(o,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function ba(e,t){return function(e,t){return oa(e.visibleWrites,t)}(e.writeTree,Dr(e.treePath,t))}function xa(e,t,n,r,i,a){return function(e,t,n,r,i,a,o){var u,s=sa(e.visibleWrites,t),c=oa(s,xr());if(null!=c)u=c;else{if(null==n)return[];u=la(s,n)}if((u=u.withIndex(o)).isEmpty()||u.isLeafNode())return[];for(var l=[],h=o.getCompare(),f=a?u.getReverseIteratorFrom(r,o):u.getIteratorFrom(r,o),d=f.getNext();d&&l.length<i;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,a)}function Ea(e,t,n){return function(e,t,n,r){var i=Dr(t,n),a=oa(e.visibleWrites,i);return null!=a?a:r.isCompleteForChild(n)?la(sa(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function Sa(e,t){return Ca(Dr(e.treePath,t),e.writeTree)}function Ca(e,t){return{treePath:e,writeTree:t}}var Ia=function(){function e(){me(this,e),this.changeMap=new Map}return ke(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;Ce("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Ce(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Ei(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,xi(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,bi(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ie("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Ei(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),Ta=new(function(){function e(){me(this,e)}return ke(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),Na=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;me(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return ke(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new Ki(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ea(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ji(this.viewCache_),i=xa(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}]),e}();function Da(e,t,n,r,i){var a,o,u=new Ia;if(n.type===Mi.OVERWRITE){var s=n;s.source.fromUser?a=Ra(e,t,s.path,s.snap,r,i,u):(Ce(s.source.fromServer,"Unknown source."),o=s.source.tagged||t.serverCache.isFiltered()&&!Ar(s.path),a=Pa(e,t,s.path,s.snap,r,i,o,u))}else if(n.type===Mi.MERGE){var c=n;c.source.fromUser?a=function(e,t,n,r,i,a,o){var u=t;return r.foreach((function(r,s){var c=Dr(n,r);Oa(t,Er(c))&&(u=Ra(e,u,c,s,i,a,o))})),r.foreach((function(r,s){var c=Dr(n,r);Oa(t,Er(c))||(u=Ra(e,u,c,s,i,a,o))})),u}(e,t,c.path,c.children,r,i,u):(Ce(c.source.fromServer,"Unknown source."),o=c.source.tagged||t.serverCache.isFiltered(),a=Ma(e,t,c.path,c.children,r,i,o,u))}else if(n.type===Mi.ACK_USER_WRITE){var l=n;a=l.revert?function(e,t,n,r,i,a){var o;if(null!=ba(r,n))return t;var u,s=new Na(r,t,i),c=t.eventCache.getNode();if(Ar(n)||".priority"===Er(n)){var l;if(t.serverCache.isFullyInitialized())l=ka(r,Ji(t));else{var h=t.serverCache.getNode();Ce(h instanceof vi,"serverChildren would be complete if leaf node"),l=_a(r,h)}l=l,u=e.filter.updateFullNode(c,l,a)}else{var f=Er(n),d=Ea(r,f,t.serverCache);null==d&&t.serverCache.isCompleteForChild(f)&&(d=c.getImmediateChild(f)),(u=null!=d?e.filter.updateChild(c,f,d,Cr(n),s,a):t.eventCache.getNode().hasChild(f)?e.filter.updateChild(c,f,vi.EMPTY_NODE,Cr(n),s,a):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=ka(r,Ji(t))).isLeafNode()&&(u=e.filter.updateFullNode(u,o,a))}return o=t.serverCache.isFullyInitialized()||null!=ba(r,xr()),Yi(t,u,o,e.filter.filtersNodes())}(e,t,l.path,r,i,u):function(e,t,n,r,i,a,o){if(null!=ba(i,n))return t;var u=t.serverCache.isFiltered(),s=t.serverCache;if(null!=r.value){if(Ar(n)&&s.isFullyInitialized()||s.isCompleteForPath(n))return Pa(e,t,n,s.getNode().getChild(n),i,a,u,o);if(Ar(n)){var c=new ea(null);return s.getNode().forEachChild(Kr,(function(e,t){c=c.set(new br(e),t)})),Ma(e,t,n,c,i,a,u,o)}return t}var l=new ea(null);return r.foreach((function(e,t){var r=Dr(n,e);s.isCompleteForPath(r)&&(l=l.set(e,s.getNode().getChild(r)))})),Ma(e,t,n,l,i,a,u,o)}(e,t,l.path,l.affectedTree,r,i,u)}else{if(n.type!==Mi.LISTEN_COMPLETE)throw Ie("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var a=t.serverCache,o=$i(t,a.getNode(),a.isFullyInitialized()||Ar(n),a.isFiltered());return Aa(e,o,n,r,Ta,i)}(e,t,n.path,r,u)}var h=u.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=Xi(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&n.push(wi(Xi(t)))}}(t,a,h),{viewCache:a,changes:h}}function Aa(e,t,n,r,i,a){var o,u,s=t.eventCache;if(null!=ba(r,n))return t;if(Ar(n))if(Ce(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=Ji(t),l=_a(r,c instanceof vi?c:vi.EMPTY_NODE);o=e.filter.updateFullNode(t.eventCache.getNode(),l,a)}else{var h=ka(r,Ji(t));o=e.filter.updateFullNode(t.eventCache.getNode(),h,a)}else{var f=Er(n);if(".priority"===f){Ce(1===Sr(n),"Can't have a priority with additional path components");var d=s.getNode(),v=wa(r,n,d,u=t.serverCache.getNode());o=null!=v?e.filter.updatePriority(d,v):s.getNode()}else{var p,y=Cr(n);if(s.isCompleteForChild(f)){u=t.serverCache.getNode();var m=wa(r,n,s.getNode(),u);p=null!=m?s.getNode().getImmediateChild(f).updateChild(y,m):s.getNode().getImmediateChild(f)}else p=Ea(r,f,t.serverCache);o=null!=p?e.filter.updateChild(s.getNode(),f,p,y,i,a):s.getNode()}}return Yi(t,o,s.isFullyInitialized()||Ar(n),e.filter.filtersNodes())}function Pa(e,t,n,r,i,a,o,u){var s,c=t.serverCache,l=o?e.filter:e.filter.getIndexedFilter();if(Ar(n))s=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);s=l.updateFullNode(c.getNode(),h,null)}else{var f=Er(n);if(!c.isCompleteForPath(n)&&Sr(n)>1)return t;var d=Cr(n),v=c.getNode().getImmediateChild(f).updateChild(d,r);s=".priority"===f?l.updatePriority(c.getNode(),v):l.updateChild(c.getNode(),f,v,d,Ta,null)}var p=$i(t,s,c.isFullyInitialized()||Ar(n),l.filtersNodes());return Aa(e,p,n,i,new Na(i,p,a),u)}function Ra(e,t,n,r,i,a,o){var u,s,c=t.eventCache,l=new Na(i,t,a);if(Ar(n))s=e.filter.updateFullNode(t.eventCache.getNode(),r,o),u=Yi(t,s,!0,e.filter.filtersNodes());else{var h=Er(n);if(".priority"===h)s=e.filter.updatePriority(t.eventCache.getNode(),r),u=Yi(t,s,c.isFullyInitialized(),c.isFiltered());else{var f,d=Cr(n),v=c.getNode().getImmediateChild(h);if(Ar(d))f=r;else{var p=l.getCompleteChild(h);f=null!=p?".priority"===Ir(d)&&p.getChild(Nr(d)).isEmpty()?p:p.updateChild(d,r):vi.EMPTY_NODE}if(v.equals(f))u=t;else u=Yi(t,e.filter.updateChild(c.getNode(),h,f,d,l,o),c.isFullyInitialized(),e.filter.filtersNodes())}}return u}function Oa(e,t){return e.eventCache.isCompleteForChild(t)}function La(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function Ma(e,t,n,r,i,a,o,u){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var s,c=t;s=Ar(n)?r:new ea(null).setTree(n,r);var l=t.serverCache.getNode();return s.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var s=La(0,t.serverCache.getNode().getImmediateChild(n),r);c=Pa(e,c,new br(n),s,i,a,o,u)}})),s.children.inorderTraversal((function(n,r){var s=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!s){var h=La(0,t.serverCache.getNode().getImmediateChild(n),r);c=Pa(e,c,new br(n),h,i,a,o,u)}})),c}var Fa,Va=function(){function e(t,n){me(this,e),this.query_=t,this.eventRegistrations_=[];var r,i=this.query_._queryParams,a=new Si(i.getIndex()),o=(r=i).loadsAllData()?new Si(r.getIndex()):r.hasLimit()?new Ii(r):new Ci(r);this.processor_=function(e){return{filter:e}}(o);var u=n.serverCache,s=n.eventCache,c=a.updateFullNode(vi.EMPTY_NODE,u.getNode(),null),l=o.updateFullNode(vi.EMPTY_NODE,s.getNode(),null),h=new Ki(c,u.isFullyInitialized(),a.filtersNodes()),f=new Ki(l,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Qi(f,h),this.eventGenerator_=new Gi(this.query_)}return ke(e,[{key:"query",get:function(){return this.query_}}]),e}();function qa(e,t){var n=Ji(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ar(t)&&!n.getImmediateChild(Er(t)).isEmpty())?n.getChild(t):null}function Ua(e){return 0===e.eventRegistrations_.length}function ja(e,t,n){var r=[];if(n){Ce(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var a=[],o=0;o<e.eventRegistrations_.length;++o){var u=e.eventRegistrations_[o];if(u.matches(t)){if(t.hasAnyCallback()){a=a.concat(e.eventRegistrations_.slice(o+1));break}}else a.push(u)}e.eventRegistrations_=a}else e.eventRegistrations_=[];return r}function Ba(e,t,n,r){t.type===Mi.MERGE&&null!==t.source.queryId&&(Ce(Ji(e.viewCache_),"We should always have a full cache before handling merges"),Ce(Xi(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,o=e.viewCache_,u=Da(e.processor_,o,t,n,r);return i=e.processor_,a=u.viewCache,Ce(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),Ce(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),Ce(u.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=u.viewCache,za(e,u.changes,u.viewCache.eventCache.getNode(),null)}function za(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],a=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Hi(e,i,"child_removed",t,r,n),Hi(e,i,"child_added",t,r,n),Hi(e,i,"child_moved",a,r,n),Hi(e,i,"child_changed",t,r,n),Hi(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}var Wa,Ka=ke((function e(){me(this,e),this.views=new Map}));function Ga(e,t,n,r){var i=t.source.queryId;if(null!==i){var a=e.views.get(i);return Ce(null!=a,"SyncTree gave us an op for an invalid query."),Ba(a,t,n,r)}var o,u=[],s=ye(e.views.values());try{for(s.s();!(o=s.n()).done;){var c=o.value;u=u.concat(Ba(c,t,n,r))}}catch(l){s.e(l)}finally{s.f()}return u}function Ha(e,t,n,r,i){var a=t._queryIdentifier,o=e.views.get(a);if(!o){var u=ka(n,i?r:null),s=!1;u?s=!0:r instanceof vi?(u=_a(n,r),s=!1):(u=vi.EMPTY_NODE,s=!1);var c=Qi(new Ki(u,s,!1),new Ki(r,i,!1));return new Va(t,c)}return o}function Qa(e,t,n,r,i,a){var o=Ha(e,t,r,i,a);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(si,(function(e,t){r.push(bi(e,t))})),n.isFullyInitialized()&&r.push(wi(n.getNode())),za(e,r,n.getNode(),t)}(o,n)}function Ya(e,t,n,r){var i=t._queryIdentifier,a=[],o=[],s=eo(e);if("default"===i){var c,l=ye(e.views.entries());try{for(l.s();!(c=l.n()).done;){var h=u(c.value,2),f=h[0],d=h[1];o=o.concat(ja(d,n,r)),Ua(d)&&(e.views.delete(f),d.query._queryParams.loadsAllData()||a.push(d.query))}}catch(p){l.e(p)}finally{l.f()}}else{var v=e.views.get(i);v&&(o=o.concat(ja(v,n,r)),Ua(v)&&(e.views.delete(i),v.query._queryParams.loadsAllData()||a.push(v.query)))}return s&&!eo(e)&&a.push(new(Ce(Fa,"Reference.ts has not been loaded"),Fa)(t._repo,t._path)),{removed:a,events:o}}function $a(e){var t,n=[],r=ye(e.views.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.query._queryParams.loadsAllData()||n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}function Xa(e,t){var n,r=null,i=ye(e.views.values());try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r||qa(a,t)}}catch(o){i.e(o)}finally{i.f()}return r}function Ja(e,t){if(t._queryParams.loadsAllData())return to(e);var n=t._queryIdentifier;return e.views.get(n)}function Za(e,t){return null!=Ja(e,t)}function eo(e){return null!=to(e)}function to(e){var t,n=ye(e.views.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.query._queryParams.loadsAllData())return r}}catch(i){n.e(i)}finally{n.f()}return null}var no=1,ro=ke((function e(t){me(this,e),this.listenProvider_=t,this.syncPointTree_=new ea(null),this.pendingWriteTree_={visibleWrites:ta.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}));function io(e,t,n,r,i){return function(e,t,n,r,i){Ce(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=na(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?lo(e,new zi({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function ao(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=da(e.pendingWriteTree_,t),i=va(e.pendingWriteTree_,t);if(i){var a=new ea(null);return null!=r.snap?a=a.set(xr(),!0):zn(r.children,(function(e){a=a.set(new br(e),!0)})),lo(e,new ji(r.path,a,n))}return[]}function oo(e,t,n){return lo(e,new zi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function uo(e,t,n,r){var i=t._path,a=e.syncPointTree_.get(i),o=[];if(a&&("default"===t._queryIdentifier||Za(a,t))){var u=Ya(a,t,n,r);0===a.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));var s=u.removed;o=u.events;var c=-1!==s.findIndex((function(e){return e._queryParams.loadsAllData()})),l=e.syncPointTree_.findOnPath(i,(function(e,t){return eo(t)}));if(c&&!l){var h=e.syncPointTree_.subtree(i);if(!h.isEmpty())for(var f=function(e){return e.fold((function(e,t,n){if(t&&eo(t))return[to(t)];var r=[];return t&&(r=$a(t)),zn(n,(function(e,t){r=r.concat(t)})),r}))}(h),d=0;d<f.length;++d){var v=f[d],p=v.query,y=vo(e,v);e.listenProvider_.startListening(_o(p),po(e,p),y.hashFn,y.onComplete)}}if(!l&&s.length>0&&!r)if(c){e.listenProvider_.stopListening(_o(t),null)}else s.forEach((function(t){var n=e.queryToTagMap.get(yo(t));e.listenProvider_.stopListening(_o(t),n)}));!function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=yo(r),a=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(a)}}}(e,s)}return o}function so(e,t,n){var r=t._path,i=null,a=!1;e.syncPointTree_.foreachOnPath(r,(function(e,t){var n=Pr(e,r);i=i||Xa(t,n),a=a||eo(t)}));var o,u=e.syncPointTree_.get(r);(u?(a=a||eo(u),i=i||Xa(u,xr())):(u=new Ka,e.syncPointTree_=e.syncPointTree_.set(r,u)),null!=i)?o=!0:(o=!1,i=vi.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild((function(e,t){var n=Xa(t,xr());n&&(i=i.updateImmediateChild(e,n))})));var s=Za(u,t);if(!s&&!t._queryParams.loadsAllData()){var c=yo(t);Ce(!e.queryToTagMap.has(c),"View does not exist, but we have a tag");var l=no++;e.queryToTagMap.set(c,l),e.tagToQueryMap.set(l,c)}var h=Qa(u,t,n,fa(e.pendingWriteTree_,r),i,o);if(!s&&!a){var f=Ja(u,t);h=h.concat(function(e,t,n){var r=t._path,i=po(e,t),a=vo(e,n),o=e.listenProvider_.startListening(_o(t),i,a.hashFn,a.onComplete),u=e.syncPointTree_.subtree(r);if(i)Ce(!eo(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var s=u.fold((function(e,t,n){if(!Ar(e)&&t&&eo(t))return[to(t).query];var r=[];return t&&(r=r.concat($a(t).map((function(e){return e.query})))),zn(n,(function(e,t){r=r.concat(t)})),r})),c=0;c<s.length;++c){var l=s[c];e.listenProvider_.stopListening(_o(l),po(e,l))}return o}(e,t,f))}return h}function co(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=Xa(n,Pr(e,t));if(r)return r}));return ga(r,t,i,n,!0)}function lo(e,t){return ho(t,e.syncPointTree_,null,fa(e.pendingWriteTree_,xr()))}function ho(e,t,n,r){if(Ar(e.path))return fo(e,t,n,r);var i=t.get(xr());null==n&&null!=i&&(n=Xa(i,xr()));var a=[],o=Er(e.path),u=e.operationForChild(o),s=t.children.get(o);if(s&&u){var c=n?n.getImmediateChild(o):null,l=Sa(r,o);a=a.concat(ho(u,s,c,l))}return i&&(a=a.concat(Ga(i,e,r,n))),a}function fo(e,t,n,r){var i=t.get(xr());null==n&&null!=i&&(n=Xa(i,xr()));var a=[];return t.children.inorderTraversal((function(t,i){var o=n?n.getImmediateChild(t):null,u=Sa(r,t),s=e.operationForChild(t);s&&(a=a.concat(fo(s,i,o,u)))})),i&&(a=a.concat(Ga(i,e,r,n))),a}function vo(e,t){var n=t.query,r=po(e,n);return{hashFn:function(){var e=function(e){return e.viewCache_.serverCache.getNode()}(t)||vi.EMPTY_NODE;return e.hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=mo(e,n);if(r){var i=go(r),a=i.path,o=i.queryId,u=Pr(a,t);return ko(e,a,new Bi(qi(o),u))}return[]}(e,n._path,r):function(e,t){return lo(e,new Bi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return uo(e,n,null,i)}}}function po(e,t){var n=yo(t);return e.queryToTagMap.get(n)}function yo(e){return e._path.toString()+"$"+e._queryIdentifier}function mo(e,t){return e.tagToQueryMap.get(t)}function go(e){var t=e.indexOf("$");return Ce(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new br(e.substr(0,t))}}function ko(e,t,n){var r=e.syncPointTree_.get(t);return Ce(r,"Missing sync point for query tag that we're tracking"),Ga(r,n,fa(e.pendingWriteTree_,t),null)}function _o(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Ce(Wa,"Reference.ts has not been loaded"),Wa)(e._repo,e._path):e}var wo=function(){function e(t){me(this,e),this.node_=t}return ke(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),bo=function(){function e(t,n){me(this,e),this.syncTree_=t,this.path_=n}return ke(e,[{key:"getImmediateChild",value:function(t){var n=Dr(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return co(this.syncTree_,this.path_)}}]),e}(),xo=function(e,t,n){return e&&"object"===typeof e?(Ce(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?Eo(e[".sv"],t,n):"object"===typeof e[".sv"]?So(e[".sv"],t):void Ce(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Eo=function(e,t,n){if("timestamp"===e)return n.timestamp;Ce(!1,"Unexpected server value: "+e)},So=function(e,t,n){e.hasOwnProperty("increment")||Ce(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!==typeof r&&Ce(!1,"Unexpected increment value: "+r);var i=t.node();if(Ce(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!==typeof a?r:a+r},Co=function(e,t,n,r){return To(t,new bo(n,e),r)},Io=function(e,t,n){return To(e,new wo(t),n)};function To(e,t,n){var r,i=e.getPriority().val(),a=xo(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var o=e,u=xo(o.getValue(),t,n);return u!==o.getValue()||a!==o.getPriority().val()?new ii(u,yi(a)):e}var s=e;return r=s,a!==s.getPriority().val()&&(r=r.updatePriority(new ii(a))),s.forEachChild(si,(function(e,i){var a=To(i,t.getImmediateChild(e),n);a!==i&&(r=r.updateImmediateChild(e,a))})),r}var No=ke((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};me(this,e),this.name=t,this.parent=n,this.node=r}));function Do(e,t){for(var n=t instanceof br?t:new br(t),r=e,i=Er(n);null!==i;){var a=$e(r.node.children,i)||{children:{},childCount:0};r=new No(i,r,a),i=Er(n=Cr(n))}return r}function Ao(e){return e.node.value}function Po(e,t){e.node.value=t,Fo(e)}function Ro(e){return e.node.childCount>0}function Oo(e,t){zn(e.node.children,(function(n,r){t(new No(n,e,r))}))}function Lo(e,t,n,r){n&&!r&&t(e),Oo(e,(function(e){Lo(e,t,!0,r)})),n&&r&&t(e)}function Mo(e){return new br(null===e.parent?e.name:Mo(e.parent)+"/"+e.name)}function Fo(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===Ao(e)&&!Ro(e)}(n),i=Ye(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Fo(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Fo(e))}(e.parent,e.name,e)}var Vo=/[\[\].#$\/\u0000-\u001F\u007F]/,qo=/[\[\].#$\u0000-\u001F\u007F]/,Uo=10485760,jo=function(e){return"string"===typeof e&&0!==e.length&&!Vo.test(e)},Bo=function(e){return"string"===typeof e&&0!==e.length&&!qo.test(e)},zo=function e(t,n,r){var i=r instanceof br?new Lr(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+Fr(i));if("function"===typeof n)throw new Error(t+"contains a function "+Fr(i)+" with contents = "+n.toString());if(Ln(n))throw new Error(t+"contains "+n.toString()+" "+Fr(i));if("string"===typeof n&&n.length>Uo/3&&ut(n)>Uo)throw new Error(t+"contains a string greater than "+"10485760 utf8 bytes "+Fr(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var a=!1,o=!1;if(zn(n,(function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(o=!0,!jo(n)))throw new Error(t+" contains an invalid key ("+n+") "+Fr(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var u,s;s=n,(u=i).parts_.length>0&&(u.byteLength_+=1),u.parts_.push(s),u.byteLength_+=ut(s),Mr(u),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=ut(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),a&&o)throw new Error(t+' contains ".value" child '+Fr(i)+" in addition to actual children.")}},Wo=function(e,t,n,r){if((!r||void 0!==n)&&!Bo(n))throw new Error(ot(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ko=function(e,t){var n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!jo(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Bo(e)}(n))throw new Error(ot(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Go=ke((function e(){me(this,e),this.eventLists_=[],this.recursionDepth_=0}));function Ho(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],a=i.getPath();null===n||Rr(a,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:a}),n.events.push(i)}n&&e.eventLists_.push(n)}function Qo(e,t,n){Ho(e,n),$o(e,(function(e){return Rr(e,t)}))}function Yo(e,t,n){Ho(e,n),$o(e,(function(e){return Or(e,t)||Or(t,e)}))}function $o(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(Xo(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function Xo(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();In&&Dn("event: "+n.toString()),Yn(r)}}}var Jo="repo_interrupt",Zo=function(){function e(t,n,r,i){me(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Go,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ri(),this.transactionQueueTree_=new No,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return ke(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function eu(e,t,n){if(e.stats_=cr(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Ai(e.repoInfo_,(function(t,n,r,i){ru(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return iu(e,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{He(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new Ur(e.repoInfo_,t,(function(t,n,r,i){ru(e,t,n,r,i)}),(function(t){iu(e,t)}),(function(t){!function(e,t){zn(t,(function(t,n){au(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){var n=e.toString();return sr[n]||(sr[n]=t()),sr[n]}(e.repoInfo_,(function(){return new Vi(e.stats_,e.server_)})),e.infoData_=new Pi,e.infoSyncTree_=new ro({startListening:function(t,n,r,i){var a=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(a=oo(e.infoSyncTree_,t._path,o),setTimeout((function(){i("ok")}),0)),a},stopListening:function(){}}),au(e,"connected",!1),e.serverSyncTree_=new ro({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var a=i(n,r);Yo(e.eventQueue_,t._path,a)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function tu(e){var t=e.infoData_.getNode(new br(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function nu(e){return(t=(t={timestamp:tu(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function ru(e,t,n,r,i){e.dataUpdateCount++;var a=new br(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var o=[];if(i)if(r){var u=Je(n,(function(e){return yi(e)}));o=function(e,t,n,r){var i=mo(e,r);if(i){var a=go(i),o=a.path,u=a.queryId,s=Pr(o,t),c=ea.fromObject(n);return ko(e,o,new Wi(qi(u),s,c))}return[]}(e.serverSyncTree_,a,u,i)}else{var s=yi(n);o=function(e,t,n,r){var i=mo(e,r);if(null!=i){var a=go(i),o=a.path,u=a.queryId,s=Pr(o,t);return ko(e,o,new zi(qi(u),s,n))}return[]}(e.serverSyncTree_,a,s,i)}else if(r){var c=Je(n,(function(e){return yi(e)}));o=function(e,t,n){var r=ea.fromObject(n);return lo(e,new Wi({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,c)}else{var l=yi(n);o=oo(e.serverSyncTree_,a,l)}var h=a;o.length>0&&(h=du(e,a)),Yo(e.eventQueue_,h,o)}function iu(e,t){au(e,"connected",t),!1===t&&function(e){cu(e,"onDisconnectEvents");var t=nu(e),n=Ri();Li(e.onDisconnect_,xr(),(function(r,i){var a=Co(r,i,e.serverSyncTree_,t);Oi(n,r,a)}));var r=[];Li(n,xr(),(function(t,n){r=r.concat(oo(e.serverSyncTree_,t,n));var i=gu(e,t);du(e,i)})),e.onDisconnect_=Ri(),Yo(e.eventQueue_,xr(),r)}(e)}function au(e,t,n){var r=new br("/.info/"+t),i=yi(n);e.infoData_.updateSnapshot(r,i);var a=oo(e.infoSyncTree_,r,i);Yo(e.eventQueue_,r,a)}function ou(e){return e.nextWriteId_++}function uu(e,t,n){var r;r=".info"===Er(t._path)?uo(e.infoSyncTree_,t,n):uo(e.serverSyncTree_,t,n),Qo(e.eventQueue_,t._path,r)}function su(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Jo)}function cu(e){var t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Dn.apply(void 0,[t].concat(r))}function lu(e,t,n){return co(e.serverSyncTree_,t,n)||vi.EMPTY_NODE}function hu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||mu(e,t),Ao(t)){var n=pu(e,t);Ce(n.length>0,"Sending zero length transaction queue");var r=n.every((function(e){return 0===e.status}));r&&fu(e,Mo(t),n)}else Ro(t)&&Oo(t,(function(t){hu(e,t)}))}function fu(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=lu(e,t,r),a=i,o=i.hash(),u=0;u<n.length;u++){var s=n[u];Ce(0===s.status,"tryToSendTransactionQueue_: items in queue should all be run."),s.status=1,s.retryCount++;var c=Pr(t,s.path);a=a.updateChild(c,s.currentOutputSnapshotRaw)}var l=a.val(!0),h=t;e.server_.put(h.toString(),l,(function(r){cu(e,"transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var a=[],o=function(t){n[t].status=2,i=i.concat(ao(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},u=0;u<n.length;u++)o(u);mu(e,Do(e.transactionQueueTree_,t)),hu(e,e.transactionQueueTree_),Yo(e.eventQueue_,t,i);for(var s=0;s<a.length;s++)Yn(a[s])}else{if("datastale"===r)for(var c=0;c<n.length;c++)3===n[c].status?n[c].status=4:n[c].status=0;else{On("transaction at "+h.toString()+" failed: "+r);for(var l=0;l<n.length;l++)n[l].status=4,n[l].abortReason=r}du(e,t)}}),o)}function du(e,t){var n=vu(e,t),r=Mo(n);return function(e,t,n){if(0===t.length)return;for(var r=[],i=[],a=t.filter((function(e){return 0===e.status})),o=a.map((function(e){return e.currentWriteId})),u=function(a){var u,s=t[a],c=Pr(n,s.path),l=!1,h=void 0;if(Ce(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)l=!0,h=s.abortReason,i=i.concat(ao(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=25)l=!0,h="maxretry",i=i.concat(ao(e.serverSyncTree_,s.currentWriteId,!0));else{var f=lu(e,s.path,o);s.currentInputSnapshot=f;var d=t[a].update(f.val());if(void 0!==d){zo("transaction failed: Data returned ",d,s.path);var v=yi(d);"object"===typeof d&&null!=d&&Ye(d,".priority")||(v=v.updatePriority(f.getPriority()));var p=s.currentWriteId,y=nu(e),m=Io(v,f,y);s.currentOutputSnapshotRaw=v,s.currentOutputSnapshotResolved=m,s.currentWriteId=ou(e),o.splice(o.indexOf(p),1),i=(i=i.concat(io(e.serverSyncTree_,s.path,m,s.currentWriteId,s.applyLocally))).concat(ao(e.serverSyncTree_,p,!0))}else l=!0,h="nodata",i=i.concat(ao(e.serverSyncTree_,s.currentWriteId,!0))}Yo(e.eventQueue_,n,i),i=[],l&&(t[a].status=2,u=t[a].unwatcher,setTimeout(u,Math.floor(0)),t[a].onComplete&&("nodata"===h?r.push((function(){return t[a].onComplete(null,!1,t[a].currentInputSnapshot)})):r.push((function(){return t[a].onComplete(new Error(h),!1,null)}))))},s=0;s<t.length;s++)u(s);mu(e,e.transactionQueueTree_);for(var c=0;c<r.length;c++)Yn(r[c]);hu(e,e.transactionQueueTree_)}(e,pu(e,n),r),r}function vu(e,t){var n,r=e.transactionQueueTree_;for(n=Er(t);null!==n&&void 0===Ao(r);)r=Do(r,n),n=Er(t=Cr(t));return r}function pu(e,t){var n=[];return yu(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function yu(e,t,n){var r=Ao(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Oo(t,(function(t){yu(e,t,n)}))}function mu(e,t){var n=Ao(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Po(t,n.length>0?n:void 0)}Oo(t,(function(t){mu(e,t)}))}function gu(e,t){var n=Mo(vu(e,t)),r=Do(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){ku(e,t)})),ku(e,r),Lo(r,(function(t){ku(e,t)})),n}function ku(e,t){var n=Ao(t);if(n){for(var r=[],i=[],a=-1,o=0;o<n.length;o++)3===n[o].status||(1===n[o].status?(Ce(a===o-1,"All SENT items should be at beginning of queue."),a=o,n[o].status=3,n[o].abortReason="set"):(Ce(0===n[o].status,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ao(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));-1===a?Po(t,void 0):n.length=a+1,Yo(e.eventQueue_,Mo(t),i);for(var u=0;u<r.length;u++)Yn(r[u])}}var _u=function(e,t){var n=wu(e),r=n.namespace;"firebase.com"===n.domain&&Rn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Rn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&On("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new ir(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new br(n.pathString)}},wu=function(e){var t="",n="",r="",i="",a="",o=!0,u="https",s=443;if("string"===typeof e){var c=e.indexOf("//");c>=0&&(u=e.substring(0,c-1),e=e.substring(c+2));var l=e.indexOf("/");-1===l&&(l=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}(e.substring(l,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n,r=ye(e.split("&"));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):On("Invalid query segment '".concat(i,"' in query '").concat(e,"'"))}}}catch(o){r.e(o)}finally{r.f()}return t}(e.substring(Math.min(e.length,h)));(c=t.indexOf(":"))>=0?(o="https"===u||"wss"===u,s=parseInt(t.substring(c+1),10)):c=t.length;var d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=t.indexOf(".");r=t.substring(0,v).toLowerCase(),n=t.substring(v+1),a=r}"ns"in f&&(a=f.ns)}return{host:t,port:s,domain:n,subdomain:r,secure:o,scheme:u,pathString:i,namespace:a}},bu=function(){function e(t,n,r,i){me(this,e),this.eventType=t,this.eventRegistration=n,this.snapshot=r,this.prevName=i}return ke(e,[{key:"getPath",value:function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}},{key:"getEventType",value:function(){return this.eventType}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.getPath().toString()+":"+this.eventType+":"+He(this.snapshot.exportVal())}}]),e}(),xu=function(){function e(t,n,r){me(this,e),this.eventRegistration=t,this.error=n,this.path=r}return ke(e,[{key:"getPath",value:function(){return this.path}},{key:"getEventType",value:function(){return"cancel"}},{key:"getEventRunner",value:function(){return this.eventRegistration.getEventRunner(this)}},{key:"toString",value:function(){return this.path.toString()+":cancel"}}]),e}(),Eu=function(){function e(t,n){me(this,e),this.snapshotCallback=t,this.cancelCallback=n}return ke(e,[{key:"onValue",value:function(e,t){this.snapshotCallback.call(null,e,t)}},{key:"onCancel",value:function(e){return Ce(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}},{key:"hasCancelCallback",get:function(){return!!this.cancelCallback}},{key:"matches",value:function(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}]),e}(),Su=function(){function e(t,n,r,i){me(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}return ke(e,[{key:"key",get:function(){return Ar(this._path)?null:Ir(this._path)}},{key:"ref",get:function(){return new Cu(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=Di(this._queryParams),t=jn(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return Di(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=st(t))instanceof e))return!1;var n=this._repo===t._repo,r=Rr(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}();var Cu=function(e){ce(n,e);var t=ve(n);function n(e,r){return me(this,n),t.call(this,e,r,new Ti,!1)}return ke(n,[{key:"parent",get:function(){var e=Nr(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(Su),Iu=function(){function e(t,n,r){me(this,e),this._node=t,this.ref=n,this._index=r}return ke(e,[{key:"priority",get:function(){return this._node.getPriority().val()}},{key:"key",get:function(){return this.ref.key}},{key:"size",get:function(){return this._node.numChildren()}},{key:"child",value:function(t){var n=new br(t),r=Nu(this.ref,t);return new e(this._node.getChild(n),r,si)}},{key:"exists",value:function(){return!this._node.isEmpty()}},{key:"exportVal",value:function(){return this._node.val(!0)}},{key:"forEach",value:function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return t(new e(i,Nu(n.ref,r),si))}))}},{key:"hasChild",value:function(e){var t=new br(e);return!this._node.getChild(t).isEmpty()}},{key:"hasChildren",value:function(){return!this._node.isLeafNode()&&!this._node.isEmpty()}},{key:"toJSON",value:function(){return this.exportVal()}},{key:"val",value:function(){return this._node.val()}}]),e}();function Tu(e,t){return(e=st(e))._checkNotDeleted("ref"),void 0!==t?Nu(e._root,t):e._root}function Nu(e,t){var n,r,i,a;return null===Er((e=st(e))._path)?(n="child",r="path",a=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),Wo(n,r,i,a)):Wo("child","path",t,!1),new Cu(e._repo,Dr(e._path,t))}var Du=function(){function e(t){me(this,e),this.callbackContext=t}return ke(e,[{key:"respondsTo",value:function(e){return"value"===e}},{key:"createEvent",value:function(e,t){var n=t._queryParams.getIndex();return new bu("value",this,new Iu(e.snapshotNode,new Cu(t._repo,t._path),n))}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new xu(this,e,t):null}},{key:"matches",value:function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}},{key:"hasAnyCallback",value:function(){return null!==this.callbackContext}}]),e}(),Au=function(){function e(t,n){me(this,e),this.eventType=t,this.callbackContext=n}return ke(e,[{key:"respondsTo",value:function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}},{key:"createCancelEvent",value:function(e,t){return this.callbackContext.hasCancelCallback?new xu(this,e,t):null}},{key:"createEvent",value:function(e,t){Ce(null!=e.childName,"Child events should have a childName.");var n=Nu(new Cu(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new bu(e.type,this,new Iu(e.snapshotNode,n,r),e.prevName)}},{key:"getEventRunner",value:function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,e.prevName)}}},{key:"matches",value:function(t){return t instanceof e&&(this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)))}},{key:"hasAnyCallback",value:function(){return!!this.callbackContext}}]),e}();function Pu(e,t,n,r,i){var a;if("object"===typeof r&&(a=void 0,i=r),"function"===typeof r&&(a=r),i&&i.onlyOnce){var o=n,u=function(t,n){uu(e._repo,e,c),o(t,n)};u.userCallback=n.userCallback,u.context=n.context,n=u}var s=new Eu(n,a||void 0),c="value"===t?new Du(s):new Au(t,s);return function(e,t,n){var r;r=".info"===Er(t._path)?so(e.infoSyncTree_,t,n):so(e.serverSyncTree_,t,n),Qo(e.eventQueue_,t._path,r)}(e._repo,e,c),function(){return uu(e._repo,e,c)}}function Ru(e,t,n,r){return Pu(e,"value",t,n,r)}!function(e){Ce(!Fa,"__referenceConstructor has already been defined"),Fa=e}(Cu),function(e){Ce(!Wa,"__referenceConstructor has already been defined"),Wa=e}(Cu);var Ou={},Lu=!1;function Mu(e,t,n,r,i){var a=r||e.options.databaseURL;void 0===a&&(e.options.projectId||Rn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Dn("Using default host for project ",e.options.projectId),a="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var o,u=_u(a,i),s=u.repoInfo,c=void 0;"undefined"!==typeof process&&(c={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),c?(o=!0,a="http://".concat(c,"?ns=").concat(s.namespace),s=(u=_u(a,i)).repoInfo):o=!u.repoInfo.secure;var l=i&&o?new Zn(Zn.OWNER):new Jn(e.name,e.options,t);Ko("Invalid Firebase Database URL",u),Ar(u.path)||Rn("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(e,t,n,r){var i=Ou[t.name];i||(i={},Ou[t.name]=i);var a=i[e.toURLString()];a&&Rn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return a=new Zo(e,Lu,n,r),i[e.toURLString()]=a,a}(s,e,l,new Xn(e.name,n));return new Fu(h,e)}var Fu=function(){function e(t,n){me(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return ke(e,[{key:"_repo",get:function(){return this._instanceStarted||(eu(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new Cu(this._repo,xr())),this._rootInternal}},{key:"_delete",value:function(){return null!==this._rootInternal&&(!function(e,t){var n=Ou[t];n&&n[e.key]===e||Rn("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),su(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&Rn("Cannot call "+e+" on a deleted database.")}}]),e}();function Vu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht(),t=arguments.length>1?arguments[1]:void 0;return qt(e,"database").getImmediate({identifier:t})}Ur.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Ur.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var qu;!function(e){!function(e){mn=e}(Kt),Vt(new vt("database",(function(e,t){var n=t.instanceIdentifier;return Mu(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),Xt(pn,yn,e),Xt(pn,yn,"esm2017")}();var Uu=function(){function e(t,n){var r=this;me(this,e),this._delegate=t,this.firebase=n,Mt(t,new vt("app-compat",(function(){return r}),"PUBLIC")),this.container=t.container}return ke(e,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),Yt(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){Mt(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){Ft(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),e}(),ju=(_e(qu={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),_e(qu,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),qu),Bu=new ze("app-compat","Firebase",ju);var zu=function t(){var n=function(t){var n={},r={__esModule:!0,initializeApp:function(e){var i=Gt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(Ye(n,i.name))return n[i.name];var a=new t(i,r);return n[i.name]=a,a},app:i,registerVersion:Xt,setLogLevel:Zt,onLog:Jt,apps:null,SDK_VERSION:Kt,INTERNAL:{registerComponent:function(e){var n=e.name,a=n.replace("-compat","");if(Vt(e)&&"PUBLIC"===e.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[a])throw Bu.create("invalid-app-argument",{appName:n});return e[a]()};void 0!==e.serviceProps&&Re(o,e.serviceProps),r[a]=o,t.prototype[a]=function(){for(var t=this._getService.bind(this,n),r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t.apply(this,e.multipleInstances?i:[])}}return"PUBLIC"===e.type?r[a]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:e}};function i(e){if(!Ye(n,e=e||Pt))throw Bu.create("no-app",{appName:e});return n[e]}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((function(e){return n[e]}))}}),i.App=t,r}(Uu);return n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(e){Re(n,e)},createSubscribe:rt,ErrorFactory:ze,deepExtend:Re}),n}(),Wu=new It("@firebase/app-compat");if("object"===typeof self&&self.self===self&&void 0!==self.firebase){Wu.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Ku=self.firebase.SDK_VERSION;Ku&&Ku.indexOf("LITE")>=0&&Wu.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Gu=zu;!function(e){Xt("@firebase/app-compat","0.1.21",e)}();function Hu(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=le(e)););return e}function Qu(){return Qu="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Hu(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Qu.apply(this,arguments)}Gu.registerVersion("firebase","9.6.10","app-compat");var Yu,$u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Xu={},Ju=Ju||{},Zu=$u||self;function es(){}function ts(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function ns(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var rs="closure_uid_"+(1e9*Math.random()>>>0),is=0;function as(e,t,n){return e.call.apply(e.bind,arguments)}function os(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function us(e,t,n){return(us=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?as:os).apply(null,arguments)}function ss(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function cs(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function ls(){this.s=this.s,this.o=this.o}var hs={};ls.prototype.s=!1,ls.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,rs)&&e[rs]||(e[rs]=++is)}(this);delete hs[e]}},ls.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var fs=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},ds=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"===typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function vs(e){return Array.prototype.concat.apply([],arguments)}function ps(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function ys(e){return/^[\s\xa0]*$/.test(e)}var ms,gs=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function ks(e,t){return-1!=e.indexOf(t)}function _s(e,t){return e<t?-1:e>t?1:0}e:{var ws=Zu.navigator;if(ws){var bs=ws.userAgent;if(bs){ms=bs;break e}}ms=""}function xs(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Es(e){var t={};for(var n in e)t[n]=e[n];return t}var Ss="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Cs(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<Ss.length;a++)n=Ss[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Is(e){return Is[" "](e),e}Is[" "]=es;var Ts,Ns=ks(ms,"Opera"),Ds=ks(ms,"Trident")||ks(ms,"MSIE"),As=ks(ms,"Edge"),Ps=As||Ds,Rs=ks(ms,"Gecko")&&!(ks(ms.toLowerCase(),"webkit")&&!ks(ms,"Edge"))&&!(ks(ms,"Trident")||ks(ms,"MSIE"))&&!ks(ms,"Edge"),Os=ks(ms.toLowerCase(),"webkit")&&!ks(ms,"Edge");function Ls(){var e=Zu.document;return e?e.documentMode:void 0}e:{var Ms="",Fs=function(){var e=ms;return Rs?/rv:([^\);]+)(\)|;)/.exec(e):As?/Edge\/([\d\.]+)/.exec(e):Ds?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Os?/WebKit\/(\S+)/.exec(e):Ns?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Fs&&(Ms=Fs?Fs[1]:""),Ds){var Vs=Ls();if(null!=Vs&&Vs>parseFloat(Ms)){Ts=String(Vs);break e}}Ts=Ms}var qs,Us={};function js(){return function(e){var t=Us;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=gs(String(Ts)).split("."),n=gs("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=_s(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||_s(0==a[2].length,0==o[2].length)||_s(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}))}if(Zu.document&&Ds){var Bs=Ls();qs=Bs||(parseInt(Ts,10)||void 0)}else qs=void 0;var zs=qs,Ws=function(){if(!Zu.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Zu.addEventListener("test",es,t),Zu.removeEventListener("test",es,t)}catch(n){}return e}();function Ks(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function Gs(e,t){if(Ks.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Rs){e:{try{Is(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Hs[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Gs.Z.h.call(this)}}Ks.prototype.h=function(){this.defaultPrevented=!0},cs(Gs,Ks);var Hs={2:"touch",3:"pen",4:"mouse"};Gs.prototype.h=function(){Gs.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Qs="closure_listenable_"+(1e6*Math.random()|0),Ys=0;function $s(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++Ys,this.ca=this.fa=!1}function Xs(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function Js(e){this.src=e,this.g={},this.h=0}function Zs(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=fs(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(Xs(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function ec(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}Js.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=ec(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new $s(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var tc="closure_lm_"+(1e6*Math.random()|0),nc={};function rc(e,t,n,r,i){if(r&&r.once)return ac(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)rc(e,t[a],n,r,i);return null}return n=fc(n),e&&e[Qs]?e.N(t,n,ns(r)?!!r.capture:!!r,i):ic(e,t,n,!1,r,i)}function ic(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=ns(i)?!!i.capture:!!i,u=lc(e);if(u||(e[tc]=u=new Js(e)),(n=u.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=cc;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Ws||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(sc(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ac(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)ac(e,t[a],n,r,i);return null}return n=fc(n),e&&e[Qs]?e.O(t,n,ns(r)?!!r.capture:!!r,i):ic(e,t,n,!0,r,i)}function oc(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)oc(e,t[a],n,r,i);else r=ns(r)?!!r.capture:!!r,n=fc(n),e&&e[Qs]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=ec(a=e.g[t],n,r,i))&&(Xs(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=lc(e))&&(t=e.g[t.toString()],e=-1,t&&(e=ec(t,n,r,i)),(n=-1<e?t[e]:null)&&uc(n))}function uc(e){if("number"!==typeof e&&e&&!e.ca){var t=e.src;if(t&&t[Qs])Zs(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(sc(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=lc(t))?(Zs(n,e),0==n.h&&(n.src=null,t[tc]=null)):Xs(e)}}}function sc(e){return e in nc?nc[e]:nc[e]="on"+e}function cc(e,t){if(e.ca)e=!0;else{t=new Gs(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&uc(e),e=n.call(r,t)}return e}function lc(e){return(e=e[tc])instanceof Js?e:null}var hc="__closure_events_fn_"+(1e9*Math.random()>>>0);function fc(e){return"function"===typeof e?e:(e[hc]||(e[hc]=function(t){return e.handleEvent(t)}),e[hc])}function dc(){ls.call(this),this.i=new Js(this),this.P=this,this.I=null}function vc(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"===typeof t)t=new Ks(t,e);else if(t instanceof Ks)t.target=t.target||e;else{var i=t;Cs(t=new Ks(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=pc(o,r,!0,t)&&i}if(i=pc(o=t.g=e,r,!0,t)&&i,i=pc(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=pc(o=t.g=n[a],r,!1,t)&&i}function pc(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var u=o.listener,s=o.ia||o.src;o.fa&&Zs(e.i,o),i=!1!==u.call(s,r)&&i}}return i&&!r.defaultPrevented}cs(dc,ls),dc.prototype[Qs]=!0,dc.prototype.removeEventListener=function(e,t,n,r){oc(this,e,t,n,r)},dc.prototype.M=function(){if(dc.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Xs(n[r]);delete t.g[e],t.h--}}this.I=null},dc.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},dc.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var yc=Zu.JSON.stringify;function mc(){var e=Sc,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var gc,kc=function(){function e(){me(this,e),this.h=this.g=null}return ke(e,[{key:"add",value:function(e,t){var n=_c.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),_c=new(function(){function e(t,n){me(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return ke(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())((function(){return new wc}),(function(e){return e.reset()})),wc=function(){function e(){me(this,e),this.next=this.g=this.h=null}return ke(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function bc(e){Zu.setTimeout((function(){throw e}),0)}function xc(e,t){gc||function(){var e=Zu.Promise.resolve(void 0);gc=function(){e.then(Cc)}}(),Ec||(gc(),Ec=!0),Sc.add(e,t)}var Ec=!1,Sc=new kc;function Cc(){for(var e;e=mc();){try{e.h.call(e.g)}catch(n){bc(n)}var t=_c;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ec=!1}function Ic(e,t){dc.call(this),this.h=e||1,this.g=t||Zu,this.j=us(this.kb,this),this.l=Date.now()}function Tc(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function Nc(e,t,n){if("function"===typeof e)n&&(e=us(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=us(e.handleEvent,e)}return 2147483647<Number(t)?-1:Zu.setTimeout(e,t||0)}function Dc(e){e.g=Nc((function(){e.g=null,e.i&&(e.i=!1,Dc(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}cs(Ic,dc),(Yu=Ic.prototype).da=!1,Yu.S=null,Yu.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),vc(this,"tick"),this.da&&(Tc(this),this.start()))}},Yu.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Yu.M=function(){Ic.Z.M.call(this),Tc(this),delete this.g};var Ac=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return ke(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:Dc(this)}},{key:"M",value:function(){Qu(le(n.prototype),"M",this).call(this),this.g&&(Zu.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(ls);function Pc(e){ls.call(this),this.h=e,this.g={}}cs(Pc,ls);var Rc=[];function Oc(e,t,n,r){Array.isArray(n)||(n&&(Rc[0]=n.toString()),n=Rc);for(var i=0;i<n.length;i++){var a=rc(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function Lc(e){xs(e.g,(function(e,t){this.g.hasOwnProperty(t)&&uc(e)}),e),e.g={}}function Mc(){this.g=!0}function Fc(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return yc(n)}catch(u){return t}}(e,n)+(r?" "+r:"")}))}Pc.prototype.M=function(){Pc.Z.M.call(this),Lc(this)},Pc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Mc.prototype.Aa=function(){this.g=!1},Mc.prototype.info=function(){};var Vc={},qc=null;function Uc(){return qc=qc||new dc}function jc(e){Ks.call(this,Vc.Ma,e)}function Bc(e){var t=Uc();vc(t,new jc(t,e))}function zc(e,t){Ks.call(this,Vc.STAT_EVENT,e),this.stat=t}function Wc(e){var t=Uc();vc(t,new zc(t,e))}function Kc(e,t){Ks.call(this,Vc.Na,e),this.size=t}function Gc(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return Zu.setTimeout((function(){e()}),t)}Vc.Ma="serverreachability",cs(jc,Ks),Vc.STAT_EVENT="statevent",cs(zc,Ks),Vc.Na="timingevent",cs(Kc,Ks);var Hc={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Qc={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Yc(){}function $c(e){return e.h||(e.h=e.i())}function Xc(){}Yc.prototype.h=null;var Jc,Zc={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function el(){Ks.call(this,"d")}function tl(){Ks.call(this,"c")}function nl(){}function rl(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new Pc(this),this.P=al,e=Ps?125:void 0,this.W=new Ic(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new il}function il(){this.i=null,this.g="",this.h=!1}cs(el,Ks),cs(tl,Ks),cs(nl,Yc),nl.prototype.g=function(){return new XMLHttpRequest},nl.prototype.i=function(){return{}},Jc=new nl;var al=45e3,ol={},ul={};function sl(e,t,n){e.K=1,e.v=Al(Sl(t)),e.s=n,e.U=!0,cl(e,null)}function cl(e,t){e.F=Date.now(),dl(e),e.A=Sl(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),Wl(n.h,"t",r),e.C=0,n=e.l.H,e.h=new il,e.g=Gh(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Ac(us(e.Ia,e,e.g),e.O)),Oc(e.V,e.g,"readystatechange",e.gb),t=e.H?Es(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Bc(1),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",u=a.split("&"),s=0;s<u.length;s++){var c=u[s].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function ll(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function hl(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=fl(e,n))==ul){4==t&&(e.o=4,Wc(14),i=!1),Fc(e.j,e.m,null,"[Incomplete Response]");break}if(r==ol){e.o=4,Wc(15),Fc(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Fc(e.j,e.m,r,null),gl(e,r)}ll(e)&&r!=ul&&r!=ol&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Wc(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Vh(t),t.L=!0,Wc(11))):(Fc(e.j,e.m,n,"[Invalid Chunked Response]"),ml(e),yl(e))}function fl(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?ul:(n=Number(t.substring(n,r)),isNaN(n)?ol:(r+=1)+n>t.length?ul:(t=t.substr(r,n),e.C=r+n,t))}function dl(e){e.Y=Date.now()+e.P,vl(e,e.P)}function vl(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Gc(us(e.eb,e),t)}function pl(e){e.B&&(Zu.clearTimeout(e.B),e.B=null)}function yl(e){0==e.l.G||e.I||jh(e.l,e)}function ml(e){pl(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Tc(e.W),Lc(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function gl(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||Jl(n.i,e)))if(n.I=e.N,!e.J&&Jl(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;Uh(n),Nh(n)}Fh(n),Wc(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=Gc(us(n.ab,n),6e3));if(1>=Xl(n.i)&&n.ka){try{n.ka()}catch(a){}n.ka=void 0}}else zh(n,11)}else if((e.J||n.g==e)&&Uh(n),!ys(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var u=a[4];null!=u&&(n.za=u,n.h.info("SVER="+n.za));var s=a[5];null!=s&&"number"===typeof s&&0<s&&(r=1.5*s,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(ks(l,"spdy")||ks(l,"quic")||ks(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(Zl(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,Dl(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=Kh(r,r.H?r.la:null,r.W),d.J){eh(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(pl(v),dl(v)),r.g=d}else Mh(r);0<n.l.length&&Ph(n)}else"stop"!=a[0]&&"close"!=a[0]||zh(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?zh(n,7):Th(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}Bc(4)}catch(a){}}function kl(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(ts(e)||"string"===typeof e)ds(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(ts(e)||"string"===typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"===typeof e)return e.split("");if(ts(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function _l(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof _l)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function wl(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];bl(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)bl(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function bl(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(Yu=rl.prototype).setTimeout=function(e){this.P=e},Yu.gb=function(e){e=e.target;var t=this.L;t&&3==xh(e)?t.l():this.Ia(e)},Yu.Ia=function(e){try{if(e==this.g)e:{var t=xh(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||Ps||this.g&&(this.h.h||this.g.ga()||Eh(this.g)))){this.I||4!=t||7==n||Bc(8==n||0>=r?3:2),pl(this);var i=this.g.ba();this.N=i;t:if(ll(this)){var a=Eh(this.g);e="";var o=a.length,u=4==xh(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){ml(this),yl(this);var s="";break t}this.h.i=new Zu.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:u&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ys(c)){var h=c;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,Wc(12),ml(this),yl(this);break e}Fc(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,gl(this,i)}this.U?(hl(this,t,s),Ps&&this.i&&3==t&&(Oc(this.V,this.W,"tick",this.fb),this.W.start())):(Fc(this.j,this.m,s,null),gl(this,s)),4==t&&ml(this),this.i&&!this.I&&(4==t?jh(this.l,this):(this.i=!1,dl(this)))}else 400==i&&0<s.indexOf("Unknown SID")?(this.o=3,Wc(12)):(this.o=0,Wc(13)),ml(this),yl(this)}}}catch(t){}},Yu.fb=function(){if(this.g){var e=xh(this.g),t=this.g.ga();this.C<t.length&&(pl(this),hl(this,e,t),this.i&&4!=e&&dl(this))}},Yu.cancel=function(){this.I=!0,ml(this)},Yu.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(Bc(3),Wc(17)),ml(this),this.o=2,yl(this)):vl(this,this.Y-e)},(Yu=_l.prototype).R=function(){wl(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},Yu.T=function(){return wl(this),this.g.concat()},Yu.get=function(e,t){return bl(this.h,e)?this.h[e]:t},Yu.set=function(e,t){bl(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},Yu.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var xl=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function El(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof El){this.g=void 0!==t?t:e.g,Cl(this,e.j),this.s=e.s,Il(this,e.i),Tl(this,e.m),this.l=e.l,t=e.h;var n=new Ul;n.i=t.i,t.g&&(n.g=new _l(t.g),n.h=t.h),Nl(this,n),this.o=e.o}else e&&(n=String(e).match(xl))?(this.g=!!t,Cl(this,n[1]||"",!0),this.s=Pl(n[2]||""),Il(this,n[3]||"",!0),Tl(this,n[4]),this.l=Pl(n[5]||"",!0),Nl(this,n[6]||"",!0),this.o=Pl(n[7]||"")):(this.g=!!t,this.h=new Ul(null,this.g))}function Sl(e){return new El(e)}function Cl(e,t,n){e.j=n?Pl(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Il(e,t,n){e.i=n?Pl(t,!0):t}function Tl(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Nl(e,t,n){t instanceof Ul?(e.h=t,function(e,t){t&&!e.j&&(jl(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Bl(this,t),Wl(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=Rl(t,Vl)),e.h=new Ul(t,e.g))}function Dl(e,t,n){e.h.set(t,n)}function Al(e){return Dl(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Pl(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Rl(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Ol),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Ol(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}El.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Rl(t,Ll,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Rl(t,Ll,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(Rl(n,"/"==n.charAt(0)?Fl:Ml,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Rl(n,ql)),e.join("")};var Ll=/[#\/\?@]/g,Ml=/[#\?:]/g,Fl=/[#\?]/g,Vl=/[#\?@]/g,ql=/#/g;function Ul(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function jl(e){e.g||(e.g=new _l,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Bl(e,t){jl(e),t=Kl(e,t),bl(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,bl((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&wl(e)))}function zl(e,t){return jl(e),t=Kl(e,t),bl(e.g.h,t)}function Wl(e,t,n){Bl(e,t),0<n.length&&(e.i=null,e.g.set(Kl(e,t),ps(n)),e.h+=n.length)}function Kl(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Yu=Ul.prototype).add=function(e,t){jl(this),this.i=null,e=Kl(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Yu.forEach=function(e,t){jl(this),this.g.forEach((function(n,r){ds(n,(function(n){e.call(t,n,r,this)}),this)}),this)},Yu.T=function(){jl(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},Yu.R=function(e){jl(this);var t=[];if("string"===typeof e)zl(this,e)&&(t=vs(t,this.g.get(Kl(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=vs(t,e[n])}return t},Yu.set=function(e,t){return jl(this),this.i=null,zl(this,e=Kl(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Yu.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},Yu.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var Gl=ke((function e(t,n){me(this,e),this.h=t,this.g=n}));function Hl(e){this.l=e||Yl,Zu.PerformanceNavigationTiming?e=0<(e=Zu.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Zu.g&&Zu.g.Ea&&Zu.g.Ea()&&Zu.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Ql,Yl=10;function $l(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xl(e){return e.h?1:e.g?e.g.size:0}function Jl(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Zl(e,t){e.g?e.g.add(t):e.h=t}function eh(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function th(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=ye(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return ps(e.i)}function nh(){}function rh(){this.g=new nh}function ih(e,t,n){var r=n||"";try{kl(e,(function(e,n){var i=e;ns(e)&&(i=yc(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function ah(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function oh(e){this.l=e.$b||null,this.j=e.ib||!1}function uh(e,t){dc.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=sh,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Hl.prototype.cancel=function(){if(this.i=th(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=ye(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},nh.prototype.stringify=function(e){return Zu.JSON.stringify(e,void 0)},nh.prototype.parse=function(e){return Zu.JSON.parse(e,void 0)},cs(oh,Yc),oh.prototype.g=function(){return new uh(this.l,this.j)},oh.prototype.i=(Ql={},function(){return Ql}),cs(uh,dc);var sh=0;function ch(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function lh(e){e.readyState=4,e.l=null,e.j=null,e.A=null,hh(e)}function hh(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Yu=uh.prototype).open=function(e,t){if(this.readyState!=sh)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,hh(this)},Yu.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Zu).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},Yu.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,lh(this)),this.readyState=sh},Yu.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,hh(this)),this.g&&(this.readyState=3,hh(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof Zu.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ch(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},Yu.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?lh(this):hh(this),3==this.readyState&&ch(this)}},Yu.Ua=function(e){this.g&&(this.response=this.responseText=e,lh(this))},Yu.Ta=function(e){this.g&&(this.response=e,lh(this))},Yu.ha=function(){this.g&&lh(this)},Yu.setRequestHeader=function(e,t){this.v.append(e,t)},Yu.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Yu.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(uh.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var fh=Zu.JSON.parse;function dh(e){dc.call(this),this.headers=new _l,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=vh,this.K=this.L=!1}cs(dh,dc);var vh="",ph=/^https?$/i,yh=["POST","PUT"];function mh(e){return"content-type"==e.toLowerCase()}function gh(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,kh(e),wh(e)}function kh(e){e.D||(e.D=!0,vc(e,"complete"),vc(e,"error"))}function _h(e){if(e.h&&"undefined"!=typeof Ju&&(!e.C[1]||4!=xh(e)||2!=e.ba()))if(e.v&&4==xh(e))Nc(e.Fa,0,e);else if(vc(e,"readystatechange"),4==xh(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(xl)[1]||null;if(!a&&Zu.self&&Zu.self.location){var o=Zu.self.location.protocol;a=o.substr(0,o.length-1)}i=!ph.test(a?a.toLowerCase():"")}t=i}if(t)vc(e,"complete"),vc(e,"success");else{e.m=6;try{var u=2<xh(e)?e.g.statusText:""}catch(s){u=""}e.j=u+" ["+e.ba()+"]",kh(e)}}finally{wh(e)}}}function wh(e,t){if(e.g){bh(e);var n=e.g,r=e.C[0]?es:null;e.g=null,e.C=null,t||vc(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function bh(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Zu.clearTimeout(e.A),e.A=null)}function xh(e){return e.g?e.g.readyState:0}function Eh(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case vh:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Sh(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return xs(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Dl(e,t,n))}function Ch(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Ih(e){this.za=0,this.l=[],this.h=new Mc,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Ch("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Ch("baseRetryDelayMs",5e3,e),this.$a=Ch("retryDelaySeedMs",1e4,e),this.Ya=Ch("forwardChannelMaxRetries",2,e),this.ra=Ch("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new Hl(e&&e.concurrentRequestLimit),this.Ca=new rh,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Th(e){if(Dh(e),3==e.G){var t=e.V++,n=Sl(e.F);Dl(n,"SID",e.J),Dl(n,"RID",t),Dl(n,"TYPE","terminate"),Oh(e,n),(t=new rl(e,e.h,t,void 0)).K=2,t.v=Al(Sl(n)),n=!1,Zu.navigator&&Zu.navigator.sendBeacon&&(n=Zu.navigator.sendBeacon(t.v.toString(),"")),!n&&Zu.Image&&((new Image).src=t.v,n=!0),n||(t.g=Gh(t.l,null),t.g.ea(t.v)),t.F=Date.now(),dl(t)}Wh(e)}function Nh(e){e.g&&(Vh(e),e.g.cancel(),e.g=null)}function Dh(e){Nh(e),e.u&&(Zu.clearTimeout(e.u),e.u=null),Uh(e),e.i.cancel(),e.m&&("number"===typeof e.m&&Zu.clearTimeout(e.m),e.m=null)}function Ah(e,t){e.l.push(new Gl(e.Za++,t)),3==e.G&&Ph(e)}function Ph(e){$l(e.i)||e.m||(e.m=!0,xc(e.Ha,e),e.C=0)}function Rh(e,t){var n;n=t?t.m:e.V++;var r=Sl(e.F);Dl(r,"SID",e.J),Dl(r,"RID",n),Dl(r,"AID",e.U),Oh(e,r),e.o&&e.s&&Sh(r,e.o,e.s),n=new rl(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Lh(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),Zl(e.i,n),sl(n,r,t)}function Oh(e,t){e.j&&kl({},(function(e,n){Dl(t,n,e)}))}function Lh(e,t,n){n=Math.min(e.l.length,n);var r=e.j?us(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var u=!0,s=0;s<n;s++){var c=i[s].h,l=i[s].g;if(0>(c-=a))a=Math.max(0,i[s].h-100),u=!1;else try{ih(l,o,"req"+c+"_")}catch(_f){r&&r(l)}}if(u){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function Mh(e){e.g||e.u||(e.Y=1,xc(e.Ga,e),e.A=0)}function Fh(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=Gc(us(e.Ga,e),Bh(e,e.A)),e.A++,!0)}function Vh(e){null!=e.B&&(Zu.clearTimeout(e.B),e.B=null)}function qh(e){e.g=new rl(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=Sl(e.oa);Dl(t,"RID","rpc"),Dl(t,"SID",e.J),Dl(t,"CI",e.N?"0":"1"),Dl(t,"AID",e.U),Oh(e,t),Dl(t,"TYPE","xmlhttp"),e.o&&e.s&&Sh(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=Al(Sl(t)),n.s=null,n.U=!0,cl(n,e)}function Uh(e){null!=e.v&&(Zu.clearTimeout(e.v),e.v=null)}function jh(e,t){var n=null;if(e.g==t){Uh(e),Vh(e),e.g=null;var r=2}else{if(!Jl(e.i,t))return;n=t.D,eh(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;vc(r=Uc(),new Kc(r,n,t,i)),Ph(e)}else Mh(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(Xl(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.l=t.D.concat(e.l),!0):!(1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya))&&(e.m=Gc(us(e.Ha,e,t),Bh(e,e.C)),e.C++,!0))}(e,t)||2==r&&Fh(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:zh(e,5);break;case 4:zh(e,10);break;case 3:zh(e,6);break;default:zh(e,2)}}function Bh(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function zh(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=us(e.jb,e);n||(n=new El("//www.google.com/images/cleardot.gif"),Zu.location&&"http"==Zu.location.protocol||Cl(n,"https"),Al(n)),function(e,t){var n=new Mc;if(Zu.Image){var r=new Image;r.onload=ss(ah,n,r,"TestLoadImage: loaded",!0,t),r.onerror=ss(ah,n,r,"TestLoadImage: error",!1,t),r.onabort=ss(ah,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=ss(ah,n,r,"TestLoadImage: timeout",!1,t),Zu.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Wc(2);e.G=0,e.j&&e.j.va(t),Wh(e),Dh(e)}function Wh(e){e.G=0,e.I=-1,e.j&&(0==th(e.i).length&&0==e.l.length||(e.i.i.length=0,ps(e.l),e.l.length=0),e.j.ua())}function Kh(e,t,n){var r=function(e){return e instanceof El?Sl(e):new El(e,void 0)}(n);if(""!=r.i)t&&Il(r,t+"."+r.i),Tl(r,r.m);else{var i=Zu.location;r=function(e,t,n,r){var i=new El(null,void 0);return e&&Cl(i,e),t&&Il(i,t),n&&Tl(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&xs(e.aa,(function(e,t){Dl(r,t,e)})),t=e.D,n=e.sa,t&&n&&Dl(r,t,n),Dl(r,"VER",e.ma),Oh(e,r),r}function Gh(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new dh(new oh({ib:!0})):new dh(e.qa)).L=e.H,t}function Hh(){}function Qh(){if(Ds&&!(10<=Number(zs)))throw Error("Environmental error: no available transport.")}function Yh(e,t){dc.call(this),this.g=new Ih(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!ys(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!ys(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Jh(this)}function $h(e){el.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Xh(){tl.call(this),this.status=1}function Jh(e){this.g=e}(Yu=dh.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Jc.g(),this.C=this.u?$c(this.u):$c(Jc),this.g.onreadystatechange=us(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void gh(this,a)}e=n||"";var i=new _l(this.headers);r&&kl(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=mh,n=e.length,r="string"===typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"===typeof e?e.charAt(t):e[t]}(i.T()),n=Zu.FormData&&e instanceof Zu.FormData,!(0<=fs(yh,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{bh(this),0<this.B&&((this.K=function(e){return Ds&&js()&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=us(this.pa,this)):this.A=Nc(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){gh(this,a)}},Yu.pa=function(){"undefined"!=typeof Ju&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,vc(this,"timeout"),this.abort(8))},Yu.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,vc(this,"complete"),vc(this,"abort"),wh(this))},Yu.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),wh(this,!0)),dh.Z.M.call(this)},Yu.Fa=function(){this.s||(this.F||this.v||this.l?_h(this):this.cb())},Yu.cb=function(){_h(this)},Yu.ba=function(){try{return 2<xh(this)?this.g.status:-1}catch(Ql){return-1}},Yu.ga=function(){try{return this.g?this.g.responseText:""}catch(Ql){return""}},Yu.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),fh(t)}},Yu.Da=function(){return this.m},Yu.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(Yu=Ih.prototype).ma=8,Yu.G=1,Yu.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},Yu.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new rl(this,this.h,e,void 0),n=this.s;if(this.P&&(n?Cs(n=Es(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"===typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=Lh(this,t,r),Dl(i=Sl(this.F),"RID",e),Dl(i,"CVER",22),this.D&&Dl(i,"X-HTTP-Session-Id",this.D),Oh(this,i),this.o&&n&&Sh(i,this.o,n),Zl(this.i,t),this.Ra&&Dl(i,"TYPE","init"),this.ja?(Dl(i,"$req",r),Dl(i,"SID","null"),t.$=!0,sl(t,i,null)):sl(t,i,r),this.G=2}}else 3==this.G&&(e?Rh(this,e):0==this.l.length||$l(this.i)||Rh(this))},Yu.Ga=function(){if(this.u=null,qh(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=Gc(us(this.bb,this),e)}},Yu.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Wc(10),Nh(this),qh(this))},Yu.ab=function(){null!=this.v&&(this.v=null,Nh(this),Fh(this),Wc(19))},Yu.jb=function(e){e?(this.h.info("Successfully pinged google.com"),Wc(2)):(this.h.info("Failed to ping google.com"),Wc(1))},(Yu=Hh.prototype).xa=function(){},Yu.wa=function(){},Yu.va=function(){},Yu.ua=function(){},Yu.Oa=function(){},Qh.prototype.g=function(e,t){return new Yh(e,t)},cs(Yh,dc),Yh.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),xc(us(e.hb,e,t))),Wc(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=Kh(e,null,e.W),Ph(e)},Yh.prototype.close=function(){Th(this.g)},Yh.prototype.u=function(e){if("string"===typeof e){var t={};t.__data__=e,Ah(this.g,t)}else this.v?((t={}).__data__=yc(e),Ah(this.g,t)):Ah(this.g,e)},Yh.prototype.M=function(){this.g.j=null,delete this.j,Th(this.g),delete this.g,Yh.Z.M.call(this)},cs($h,el),cs(Xh,tl),cs(Jh,Hh),Jh.prototype.xa=function(){vc(this.g,"a")},Jh.prototype.wa=function(e){vc(this.g,new $h(e))},Jh.prototype.va=function(e){vc(this.g,new Xh(e))},Jh.prototype.ua=function(){vc(this.g,"b")},Qh.prototype.createWebChannel=Qh.prototype.g,Yh.prototype.send=Yh.prototype.u,Yh.prototype.open=Yh.prototype.m,Yh.prototype.close=Yh.prototype.close,Hc.NO_ERROR=0,Hc.TIMEOUT=8,Hc.HTTP_ERROR=6,Qc.COMPLETE="complete",Xc.EventType=Zc,Zc.OPEN="a",Zc.CLOSE="b",Zc.ERROR="c",Zc.MESSAGE="d",dc.prototype.listen=dc.prototype.N,dh.prototype.listenOnce=dh.prototype.O,dh.prototype.getLastError=dh.prototype.La,dh.prototype.getLastErrorCode=dh.prototype.Da,dh.prototype.getStatus=dh.prototype.ba,dh.prototype.getResponseJson=dh.prototype.Qa,dh.prototype.getResponseText=dh.prototype.ga,dh.prototype.send=dh.prototype.ea;var Zh=Xu.createWebChannelTransport=function(){return new Qh},ef=Xu.getStatEventTarget=function(){return Uc()},tf=Xu.ErrorCode=Hc,nf=Xu.EventType=Qc,rf=Xu.Event=Vc,af=Xu.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},of=Xu.FetchXmlHttpFactory=oh,uf=Xu.WebChannel=Xc,sf=Xu.XhrIo=dh,cf="@firebase/firestore",lf=function(){function e(t){me(this,e),this.uid=t}return ke(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();lf.UNAUTHENTICATED=new lf(null),lf.GOOGLE_CREDENTIALS=new lf("google-credentials-uid"),lf.FIRST_PARTY=new lf("first-party-uid"),lf.MOCK_USER=new lf("mock-user");var hf="9.6.10",ff=new It("@firebase/firestore");function df(){return ff.logLevel}function vf(e){if(ff.logLevel<=gt.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(mf);ff.debug.apply(ff,["Firestore (".concat(hf,"): ").concat(e)].concat(pe(i)))}}function pf(e){if(ff.logLevel<=gt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(mf);ff.error.apply(ff,["Firestore (".concat(hf,"): ").concat(e)].concat(pe(i)))}}function yf(e){if(ff.logLevel<=gt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(mf);ff.warn.apply(ff,["Firestore (".concat(hf,"): ").concat(e)].concat(pe(i)))}}function mf(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function gf(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(hf,") INTERNAL ASSERTION FAILED: ")+e;throw pf(t),new Error(t)}function kf(e,t){e||gf()}function _f(e,t){return e}var wf={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},bf=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return ke(n)}(Be),xf=ke((function e(){var t=this;me(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Ef=ke((function e(t,n){me(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),Sf=function(){function e(){me(this,e)}return ke(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(lf.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),Cf=function(){function e(t){me(this,e),this.token=t,this.changeListener=null}return ke(e,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),e}(),If=function(){function e(t){me(this,e),this.t=t,this.currentUser=lf.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return ke(e,[{key:"start",value:function(e,t){var n=this,r=this.i,i=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},a=new xf;this.o=function(){n.i++,n.currentUser=n.u(),a.resolve(),a=new xf,e.enqueueRetryable((function(){return i(n.currentUser)}))};var o=function(){var t=a;e.enqueueRetryable(ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,i(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},u=function(e){vf("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(e){return u(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(vf("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new xf)}}),0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(vf("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(kf("string"==typeof n.accessToken),new Ef(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return kf(null===e||"string"==typeof e),new lf(e)}}]),e}(),Tf=ke((function e(t,n,r){me(this,e),this.type="FirstParty",this.user=lf.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)})),Nf=function(){function e(t,n,r){me(this,e),this.h=t,this.l=n,this.m=r}return ke(e,[{key:"getToken",value:function(){return Promise.resolve(new Tf(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(lf.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Df=ke((function e(t){me(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),Af=function(){function e(t){me(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return ke(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&vf("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,vf("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var i=function(e){vf("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit((function(e){return i(e)})),setTimeout((function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?i(e):vf("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(kf("string"==typeof t.token),e.p=t.token,new Df(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}(),Pf=function(){function e(t,n){var r=this;me(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.I(e)},this.T=function(e){return n.writeSequenceNumber(e)})}return ke(e,[{key:"I",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.T&&this.T(e),e}}]),e}();function Rf(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}Pf.A=-1;var Of=function(){function e(){me(this,e)}return ke(e,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=Rf(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function Lf(e,t){return e<t?-1:e>t?1:0}function Mf(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function Ff(e){return e+"\0"}var Vf=function(){function e(t,n){if(me(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new bf(wf.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new bf(wf.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new bf(wf.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new bf(wf.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return ke(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Lf(this.nanoseconds,e.nanoseconds):Lf(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),qf=function(){function e(t){me(this,e),this.timestamp=t}return ke(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Vf(0,0))}},{key:"max",value:function(){return new e(new Vf(253402300799,999999999))}}]),e}();function Uf(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function jf(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Bf(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var zf=function(){function e(t,n,r){me(this,e),void 0===n?n=0:n>t.length&&gf(),void 0===r?r=t.length-n:r>t.length-n&&gf(),this.segments=t,this.offset=n,this.len=r}return ke(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),Wf=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var u=o[a];if(u.indexOf("//")>=0)throw new bf(wf.INVALID_ARGUMENT,"Invalid segment (".concat(u,"). Paths must not contain // in them."));e.push.apply(e,pe(u.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(zf),Kf=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Gf=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return Kf.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new bf(wf.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var u=e[i];if("\\"===u){if(i+1===e.length)throw new bf(wf.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new bf(wf.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=s,i+=2}else"`"===u?(o=!o,i++):"."!==u||o?(r+=u,i++):(a(),i++)}if(a(),o)throw new bf(wf.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(zf),Hf=function(){function e(t){me(this,e),this.fields=t,t.sort(Gf.comparator)}return ke(e,[{key:"covers",value:function(e){var t,n=ye(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return Mf(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}]),e}();var Qf=function(e){function t(e){me(this,t),this.binaryString=e}return ke(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Lf(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}();Qf.EMPTY_BYTE_STRING=new Qf("");var Yf=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $f(e){if(kf(!!e),"string"==typeof e){var t=0,n=Yf.exec(e);if(kf(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Xf(e.seconds),nanos:Xf(e.nanos)}}function Xf(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Jf(e){return"string"==typeof e?Qf.fromBase64String(e):Qf.fromUint8Array(e)}function Zf(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ed(e){var t=e.mapValue.fields.__previous_value__;return Zf(t)?ed(t):t}function td(e){var t=$f(e.mapValue.fields.__local_write_time__.timestampValue);return new Vf(t.seconds,t.nanos)}var nd=ke((function e(t,n,r,i,a,o,u,s){me(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.useFetchStreams=s})),rd=function(){function e(t,n){me(this,e),this.projectId=t,this.database=n||"(default)"}return ke(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function id(e){return null==e}function ad(e){return 0===e&&1/e==-1/0}function od(e){return"number"==typeof e&&Number.isInteger(e)&&!ad(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var ud=function(){function e(t){me(this,e),this.path=t}return ke(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===Wf.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(Wf.fromString(t))}},{key:"fromName",value:function(t){return new e(Wf.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(Wf.emptyPath())}},{key:"comparator",value:function(e,t){return Wf.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new Wf(t.slice()))}}]),e}(),sd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},cd={nullValue:"NULL_VALUE"};function ld(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Zf(e)?4:Ed(e)?9:10:gf()}function hd(e,t){if(e===t)return!0;var n=ld(e);if(n!==ld(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return td(e).isEqual(td(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=$f(e.timestampValue),r=$f(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Jf(e.bytesValue).isEqual(Jf(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Xf(e.geoPointValue.latitude)===Xf(t.geoPointValue.latitude)&&Xf(e.geoPointValue.longitude)===Xf(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Xf(e.integerValue)===Xf(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Xf(e.doubleValue),r=Xf(t.doubleValue);return n===r?ad(n)===ad(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Mf(e.arrayValue.values||[],t.arrayValue.values||[],hd);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Uf(n)!==Uf(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!hd(n[i],r[i])))return!1;return!0}(e,t);default:return gf()}}function fd(e,t){return void 0!==(e.values||[]).find((function(e){return hd(e,t)}))}function dd(e,t){if(e===t)return 0;var n=ld(e),r=ld(t);if(n!==r)return Lf(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Lf(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Xf(e.integerValue||e.doubleValue),r=Xf(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return vd(e.timestampValue,t.timestampValue);case 4:return vd(td(e),td(t));case 5:return Lf(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Jf(e),r=Jf(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Lf(n[i],r[i]);if(0!==a)return a}return Lf(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Lf(Xf(e.latitude),Xf(t.latitude));return 0!==n?n:Lf(Xf(e.longitude),Xf(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=dd(n[i],r[i]);if(a)return a}return Lf(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var u=Lf(r[o],a[o]);if(0!==u)return u;var s=dd(n[r[o]],i[a[o]]);if(0!==s)return s}return Lf(r.length,a.length)}(e.mapValue,t.mapValue);default:throw gf()}}function vd(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Lf(e,t);var n=$f(e),r=$f(t),i=Lf(n.seconds,r.seconds);return 0!==i?i:Lf(n.nanos,r.nanos)}function pd(e){return yd(e)}function yd(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=$f(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Jf(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,ud.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=ye(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=yd(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=ye(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(yd(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):gf();var t,n}function md(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function gd(e){return!!e&&"integerValue"in e}function kd(e){return!!e&&"arrayValue"in e}function _d(e){return!!e&&"nullValue"in e}function wd(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function bd(e){return!!e&&"mapValue"in e}function xd(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return jf(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=xd(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=xd(e.arrayValue.values[r]);return n}return Object.assign({},e)}function Ed(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Sd(e,t){return void 0===e?t:void 0===t||dd(e,t)>0?e:t}function Cd(e,t){return void 0===e?t:void 0===t||dd(e,t)<0?e:t}var Id=function(){function e(t){me(this,e),this.value=t}return ke(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!bd(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=xd(t)}},{key:"setAll",value:function(e){var t=this,n=Gf.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=xd(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());bd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return hd(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];bd(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){jf(t,(function(t,n){return e[t]=n}));var r,i=ye(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(xd(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function Td(e){var t=[];return jf(e.fields,(function(e,n){var r=new Gf([e]);if(bd(n)){var i=Td(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=ye(i);try{for(o.s();!(a=o.n()).done;){var u=a.value;t.push(r.child(u))}}catch(s){o.e(s)}finally{o.f()}}}else t.push(r)})),new Hf(t)}var Nd=function(){function e(t,n,r,i,a,o){me(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return ke(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=Id.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=Id.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,qf.min(),qf.min(),Id.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,qf.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,qf.min(),Id.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,qf.min(),Id.empty(),2)}}]),e}(),Dd=ke((function e(t,n,r,i){me(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=i}));function Ad(e){return e.fields.find((function(e){return 2===e.kind}))}function Pd(e){return e.fields.filter((function(e){return 2!==e.kind}))}Dd.UNKNOWN_ID=-1;var Rd=ke((function e(t,n){me(this,e),this.fieldPath=t,this.kind=n})),Od=function(){function e(t,n){me(this,e),this.sequenceNumber=t,this.offset=n}return ke(e,null,[{key:"empty",value:function(){return new e(0,Fd.min())}}]),e}();function Ld(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=qf.fromTimestamp(1e9===r?new Vf(n+1,0):new Vf(n,r));return new Fd(i,ud.empty(),t)}function Md(e){return new Fd(e.readTime,e.key,-1)}var Fd=function(){function e(t,n,r){me(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return ke(e,null,[{key:"min",value:function(){return new e(qf.min(),ud.empty(),-1)}},{key:"max",value:function(){return new e(qf.max(),ud.empty(),-1)}}]),e}();function Vd(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=ud.comparator(e.documentKey,t.documentKey))?n:Lf(e.largestBatchId,t.largestBatchId)}var qd=ke((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;me(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=u,this.P=null}));function Ud(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new qd(e,t,n,r,i,a,o)}function jd(e){var t=_f(e);if(null===t.P){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return(t=e).field.canonicalString()+t.op.toString()+pd(t.value);var t})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),id(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return pd(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return pd(e)})).join(",")),t.P=n}return t.P}function Bd(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!nv(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],a=t.filters[r],i.op!==a.op||!i.field.isEqual(a.field)||!hd(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!iv(e.startAt,t.startAt)&&iv(e.endAt,t.endAt)}function zd(e){return ud.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Wd(e,t){return e.filters.filter((function(e){return e instanceof Kd&&e.field.isEqual(t)}))}var Kd=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return ke(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(dd(t,this.value)):null!==t&&ld(this.value)===ld(t)&&this.v(dd(t,this.value))}},{key:"v",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return gf()}}},{key:"S",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.V(e,t,r):new Gd(e,t,r):"array-contains"===t?new $d(e,r):"in"===t?new Xd(e,r):"not-in"===t?new Jd(e,r):"array-contains-any"===t?new Zd(e,r):new n(e,t,r)}},{key:"V",value:function(e,t,n){return"in"===t?new Hd(e,n):new Qd(e,n)}}]),n}(function(){return ke((function e(){me(this,e)}))}()),Gd=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this,e,r,i)).key=ud.fromName(i.referenceValue),a}return ke(n,[{key:"matches",value:function(e){var t=ud.comparator(e.key,this.key);return this.v(t)}}]),n}(Kd),Hd=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e,"in",r)).keys=Yd("in",r),i}return ke(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Kd),Qd=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e,"not-in",r)).keys=Yd("not-in",r),i}return ke(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Kd);function Yd(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return ud.fromName(e.referenceValue)}))}var $d=function(e){ce(n,e);var t=ve(n);function n(e,r){return me(this,n),t.call(this,e,"array-contains",r)}return ke(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return kd(t)&&fd(t.arrayValue,this.value)}}]),n}(Kd),Xd=function(e){ce(n,e);var t=ve(n);function n(e,r){return me(this,n),t.call(this,e,"in",r)}return ke(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&fd(this.value.arrayValue,t)}}]),n}(Kd),Jd=function(e){ce(n,e);var t=ve(n);function n(e,r){return me(this,n),t.call(this,e,"not-in",r)}return ke(n,[{key:"matches",value:function(e){if(fd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!fd(this.value.arrayValue,t)}}]),n}(Kd),Zd=function(e){ce(n,e);var t=ve(n);function n(e,r){return me(this,n),t.call(this,e,"array-contains-any",r)}return ke(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!kd(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return fd(t.value.arrayValue,e)}))}}]),n}(Kd),ev=ke((function e(t,n){me(this,e),this.position=t,this.inclusive=n})),tv=ke((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";me(this,e),this.field=t,this.dir=n}));function nv(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function rv(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?ud.comparator(ud.fromName(o.referenceValue),n.key):dd(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function iv(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!hd(e.position[n],t.position[n]))return!1;return!0}var av=ke((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;me(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=u,this.endAt=s,this.D=null,this.C=null,this.startAt,this.endAt}));function ov(e,t,n,r,i,a,o,u){return new av(e,t,n,r,i,a,o,u)}function uv(e){return new av(e)}function sv(e){return!id(e.limit)&&"F"===e.limitType}function cv(e){return!id(e.limit)&&"L"===e.limitType}function lv(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function hv(e){var t,n=ye(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.S())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function fv(e){return null!==e.collectionGroup}function dv(e){var t=_f(e);if(null===t.D){t.D=[];var n=hv(t),r=lv(t);if(null!==n&&null===r)n.isKeyField()||t.D.push(new tv(n)),t.D.push(new tv(Gf.keyField(),"asc"));else{var i,a=!1,o=ye(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var u=i.value;t.D.push(u),u.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var s=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.D.push(new tv(Gf.keyField(),s))}}}return t.D}function vv(e){var t=_f(e);if(!t.C)if("F"===t.limitType)t.C=Ud(t.path,t.collectionGroup,dv(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=ye(dv(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o="desc"===a.dir?"asc":"desc";r.push(new tv(a.field,o))}}catch(c){i.e(c)}finally{i.f()}var u=t.endAt?new ev(t.endAt.position,!t.endAt.inclusive):null,s=t.startAt?new ev(t.startAt.position,!t.startAt.inclusive):null;t.C=Ud(t.path,t.collectionGroup,r,t.filters,t.limit,u,s)}return t.C}function pv(e,t,n){return new av(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function yv(e,t){return Bd(vv(e),vv(t))&&e.limitType===t.limitType}function mv(e){return"".concat(jd(vv(e)),"|lt:").concat(e.limitType)}function gv(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(pd(t.value));var t})).join(", "),"]")),id(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return pd(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return pd(e)})).join(",")),"Target(".concat(t,")")}(vv(e)),"; limitType=").concat(e.limitType,")")}function kv(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ud.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=ye(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=ye(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=rv(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,dv(e),t))&&!(e.endAt&&!function(e,t,n){var r=rv(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,dv(e),t))}(e,t)}function _v(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function wv(e){return function(t,n){var r,i=!1,a=ye(dv(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,u=bv(o,t,n);if(0!==u)return u;i=i||o.field.isKeyField()}}catch(s){a.e(s)}finally{a.f()}return 0}}function bv(e,t,n){var r=e.field.isKeyField()?ud.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?dd(r,i):gf()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return gf()}}function xv(e,t){if(e.N){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ad(t)?"-0":t}}function Ev(e){return{integerValue:""+e}}function Sv(e,t){return od(t)?Ev(t):xv(e,t)}var Cv=ke((function e(){me(this,e),this._=void 0}));function Iv(e,t,n){return e instanceof Dv?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Av?Pv(e,t):e instanceof Rv?Ov(e,t):function(e,t){var n=Nv(e,t),r=Mv(n)+Mv(e.k);return gd(n)&&gd(e.k)?Ev(r):xv(e.M,r)}(e,t)}function Tv(e,t,n){return e instanceof Av?Pv(e,t):e instanceof Rv?Ov(e,t):n}function Nv(e,t){return e instanceof Lv?gd(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var Dv=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n)}(Cv),Av=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this)).elements=e,r}return ke(n)}(Cv);function Pv(e,t){var n,r=Fv(t),i=ye(e.elements);try{var a=function(){var e=n.value;r.some((function(t){return hd(t,e)}))||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Rv=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this)).elements=e,r}return ke(n)}(Cv);function Ov(e,t){var n,r=Fv(t),i=ye(e.elements);try{var a=function(){var e=n.value;r=r.filter((function(t){return!hd(t,e)}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Lv=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this)).M=e,i.k=r,i}return ke(n)}(Cv);function Mv(e){return Xf(e.integerValue||e.doubleValue)}function Fv(e){return kd(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Vv=ke((function e(t,n){me(this,e),this.field=t,this.transform=n}));var qv=ke((function e(t,n){me(this,e),this.version=t,this.transformResults=n})),Uv=function(){function e(t,n){me(this,e),this.updateTime=t,this.exists=n}return ke(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function jv(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Bv=ke((function e(){me(this,e)}));function zv(e,t,n){e instanceof Qv?function(e,t,n){var r=e.value.clone(),i=Xv(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Yv?function(e,t,n){if(jv(e.precondition,t)){var r=Xv(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll($v(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Wv(e,t,n){e instanceof Qv?function(e,t,n){if(jv(e.precondition,t)){var r=e.value.clone(),i=Jv(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(Hv(t),r).setHasLocalMutations()}}(e,t,n):e instanceof Yv?function(e,t,n){if(jv(e.precondition,t)){var r=Jv(e.fieldTransforms,n,t),i=t.data;i.setAll($v(e)),i.setAll(r),t.convertToFoundDocument(Hv(t),i).setHasLocalMutations()}}(e,t,n):function(e,t){jv(e.precondition,t)&&t.convertToNoDocument(qf.min())}(e,t)}function Kv(e,t){var n,r=null,i=ye(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),u=Nv(a.transform,o||null);null!=u&&(null==r&&(r=Id.empty()),r.set(a.field,u))}}catch(s){i.e(s)}finally{i.f()}return r||null}function Gv(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Mf(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Av&&t instanceof Av||e instanceof Rv&&t instanceof Rv?Mf(e.elements,t.elements,hd):e instanceof Lv&&t instanceof Lv?hd(e.k,t.k):e instanceof Dv&&t instanceof Dv}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function Hv(e){return e.isFoundDocument()?e.version:qf.min()}var Qv=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return me(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return ke(n)}(Bv),Yv=function(e){ce(n,e);var t=ve(n);function n(e,r,i,a){var o,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return me(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=u,o.type=1,o}return ke(n)}(Bv);function $v(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function Xv(e,t,n){var r=new Map;kf(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,u=t.data.field(a.field);r.set(a.field,Tv(o,u,n[i]))}return r}function Jv(e,t,n){var r,i=new Map,a=ye(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,u=o.transform,s=n.data.field(o.field);i.set(o.field,Iv(u,s,t))}}catch(c){a.e(c)}finally{a.f()}return i}var Zv,ep,tp=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return ke(n)}(Bv),np=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return ke(n)}(Bv),rp=ke((function e(t){me(this,e),this.count=t}));function ip(e){switch(e){default:return gf();case wf.CANCELLED:case wf.UNKNOWN:case wf.DEADLINE_EXCEEDED:case wf.RESOURCE_EXHAUSTED:case wf.INTERNAL:case wf.UNAVAILABLE:case wf.UNAUTHENTICATED:return!1;case wf.INVALID_ARGUMENT:case wf.NOT_FOUND:case wf.ALREADY_EXISTS:case wf.PERMISSION_DENIED:case wf.FAILED_PRECONDITION:case wf.ABORTED:case wf.OUT_OF_RANGE:case wf.UNIMPLEMENTED:case wf.DATA_LOSS:return!0}}function ap(e){if(void 0===e)return pf("GRPC error has no .code"),wf.UNKNOWN;switch(e){case Zv.OK:return wf.OK;case Zv.CANCELLED:return wf.CANCELLED;case Zv.UNKNOWN:return wf.UNKNOWN;case Zv.DEADLINE_EXCEEDED:return wf.DEADLINE_EXCEEDED;case Zv.RESOURCE_EXHAUSTED:return wf.RESOURCE_EXHAUSTED;case Zv.INTERNAL:return wf.INTERNAL;case Zv.UNAVAILABLE:return wf.UNAVAILABLE;case Zv.UNAUTHENTICATED:return wf.UNAUTHENTICATED;case Zv.INVALID_ARGUMENT:return wf.INVALID_ARGUMENT;case Zv.NOT_FOUND:return wf.NOT_FOUND;case Zv.ALREADY_EXISTS:return wf.ALREADY_EXISTS;case Zv.PERMISSION_DENIED:return wf.PERMISSION_DENIED;case Zv.FAILED_PRECONDITION:return wf.FAILED_PRECONDITION;case Zv.ABORTED:return wf.ABORTED;case Zv.OUT_OF_RANGE:return wf.OUT_OF_RANGE;case Zv.UNIMPLEMENTED:return wf.UNIMPLEMENTED;case Zv.DATA_LOSS:return wf.DATA_LOSS;default:return gf()}}(ep=Zv||(Zv={}))[ep.OK=0]="OK",ep[ep.CANCELLED=1]="CANCELLED",ep[ep.UNKNOWN=2]="UNKNOWN",ep[ep.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ep[ep.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ep[ep.NOT_FOUND=5]="NOT_FOUND",ep[ep.ALREADY_EXISTS=6]="ALREADY_EXISTS",ep[ep.PERMISSION_DENIED=7]="PERMISSION_DENIED",ep[ep.UNAUTHENTICATED=16]="UNAUTHENTICATED",ep[ep.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ep[ep.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ep[ep.ABORTED=10]="ABORTED",ep[ep.OUT_OF_RANGE=11]="OUT_OF_RANGE",ep[ep.UNIMPLEMENTED=12]="UNIMPLEMENTED",ep[ep.INTERNAL=13]="INTERNAL",ep[ep.UNAVAILABLE=14]="UNAVAILABLE",ep[ep.DATA_LOSS=15]="DATA_LOSS";var op=function(){function e(t,n){me(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return ke(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=ye(n);try{for(i.s();!(r=i.n()).done;){var a=u(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(c){i.e(c)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){jf(this.inner,(function(t,n){var r,i=ye(n);try{for(i.s();!(r=i.n()).done;){var a=u(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(c){i.e(c)}finally{i.f()}}))}},{key:"isEmpty",value:function(){return Bf(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),up=function(){function e(t,n){me(this,e),this.comparator=t,this.root=n||cp.EMPTY}return ke(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,cp.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,cp.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new sp(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new sp(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new sp(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new sp(this.root,e,this.comparator,!0)}}]),e}(),sp=function(){function e(t,n,r,i){me(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return ke(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),cp=function(){function e(t,n,r,i,a){me(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return ke(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw gf();if(this.right.isRed())throw gf();var e=this.left.check();if(e!==this.right.check())throw gf();return e+(this.isRed()?0:1)}}]),e}();cp.EMPTY=null,cp.RED=!0,cp.BLACK=!1,cp.EMPTY=new(function(){function e(){me(this,e),this.size=0}return ke(e,[{key:"key",get:function(){throw gf()}},{key:"value",get:function(){throw gf()}},{key:"color",get:function(){throw gf()}},{key:"left",get:function(){throw gf()}},{key:"right",get:function(){throw gf()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new cp(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var lp=function(){function e(t){me(this,e),this.comparator=t,this.data=new up(this.comparator)}return ke(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new hp(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new hp(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),hp=function(){function e(t){me(this,e),this.iter=t}return ke(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();function fp(e){return e.hasNext()?e.getNext():void 0}var dp=new up(ud.comparator);function vp(){return dp}var pp=new up(ud.comparator);function yp(){return pp}function mp(){return new op((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var gp=new up(ud.comparator),kp=new lp(ud.comparator);function _p(){for(var e=kp,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var wp=new lp(Lf);function bp(){return wp}var xp=function(){function e(t,n,r,i,a){me(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return ke(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,Ep.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(qf.min(),r,bp(),vp(),_p())}}]),e}(),Ep=function(){function e(t,n,r,i,a){me(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return ke(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(Qf.EMPTY_BYTE_STRING,n,_p(),_p(),_p())}}]),e}(),Sp=ke((function e(t,n,r,i){me(this,e),this.O=t,this.removedTargetIds=n,this.key=r,this.F=i})),Cp=ke((function e(t,n){me(this,e),this.targetId=t,this.$=n})),Ip=ke((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qf.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;me(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i})),Tp=function(){function e(){me(this,e),this.B=0,this.L=Ap(),this.U=Qf.EMPTY_BYTE_STRING,this.q=!1,this.G=!0}return ke(e,[{key:"current",get:function(){return this.q}},{key:"resumeToken",get:function(){return this.U}},{key:"K",get:function(){return 0!==this.B}},{key:"j",get:function(){return this.G}},{key:"W",value:function(e){e.approximateByteSize()>0&&(this.G=!0,this.U=e)}},{key:"H",value:function(){var e=_p(),t=_p(),n=_p();return this.L.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:gf()}})),new Ep(this.U,this.q,e,t,n)}},{key:"J",value:function(){this.G=!1,this.L=Ap()}},{key:"Y",value:function(e,t){this.G=!0,this.L=this.L.insert(e,t)}},{key:"X",value:function(e){this.G=!0,this.L=this.L.remove(e)}},{key:"Z",value:function(){this.B+=1}},{key:"tt",value:function(){this.B-=1}},{key:"et",value:function(){this.G=!0,this.q=!0}}]),e}(),Np=function(){function e(t){me(this,e),this.nt=t,this.st=new Map,this.it=vp(),this.rt=Dp(),this.ot=new lp(Lf)}return ke(e,[{key:"ut",value:function(e){var t,n=ye(e.O);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.F&&e.F.isFoundDocument()?this.at(r,e.F):this.ct(r,e.key,e.F)}}catch(u){n.e(u)}finally{n.f()}var i,a=ye(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.ct(o,e.key,e.F)}}catch(u){a.e(u)}finally{a.f()}}},{key:"ht",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.lt(n);switch(e.state){case 0:t.ft(n)&&r.W(e.resumeToken);break;case 1:r.tt(),r.K||r.J(),r.W(e.resumeToken);break;case 2:r.tt(),r.K||t.removeTarget(n);break;case 3:t.ft(n)&&(r.et(),r.W(e.resumeToken));break;case 4:t.ft(n)&&(t.dt(n),r.W(e.resumeToken));break;default:gf()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.st.forEach((function(e,r){n.ft(r)&&t(r)}))}},{key:"_t",value:function(e){var t=e.targetId,n=e.$.count,r=this.wt(t);if(r){var i=r.target;if(zd(i))if(0===n){var a=new ud(i.path);this.ct(t,a,Nd.newNoDocument(a,qf.min()))}else kf(1===n);else this.gt(t)!==n&&(this.dt(t),this.ot=this.ot.add(t))}}},{key:"yt",value:function(e){var t=this,n=new Map;this.st.forEach((function(r,i){var a=t.wt(i);if(a){if(r.current&&zd(a.target)){var o=new ud(a.target.path);null!==t.it.get(o)||t.It(i,o)||t.ct(i,o,Nd.newNoDocument(o,e))}r.j&&(n.set(i,r.H()),r.J())}}));var r=_p();this.rt.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.wt(e);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(e))})),this.it.forEach((function(t,n){return n.setReadTime(e)}));var i=new xp(e,n,this.ot,this.it,r);return this.it=vp(),this.rt=Dp(),this.ot=new lp(Lf),i}},{key:"at",value:function(e,t){if(this.ft(e)){var n=this.It(e,t.key)?2:0;this.lt(e).Y(t.key,n),this.it=this.it.insert(t.key,t),this.rt=this.rt.insert(t.key,this.Tt(t.key).add(e))}}},{key:"ct",value:function(e,t,n){if(this.ft(e)){var r=this.lt(e);this.It(e,t)?r.Y(t,1):r.X(t),this.rt=this.rt.insert(t,this.Tt(t).delete(e)),n&&(this.it=this.it.insert(t,n))}}},{key:"removeTarget",value:function(e){this.st.delete(e)}},{key:"gt",value:function(e){var t=this.lt(e).H();return this.nt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Z",value:function(e){this.lt(e).Z()}},{key:"lt",value:function(e){var t=this.st.get(e);return t||(t=new Tp,this.st.set(e,t)),t}},{key:"Tt",value:function(e){var t=this.rt.get(e);return t||(t=new lp(Lf),this.rt=this.rt.insert(e,t)),t}},{key:"ft",value:function(e){var t=null!==this.wt(e);return t||vf("WatchChangeAggregator","Detected inactive target",e),t}},{key:"wt",value:function(e){var t=this.st.get(e);return t&&t.K?null:this.nt.Et(e)}},{key:"dt",value:function(e){var t=this;this.st.set(e,new Tp),this.nt.getRemoteKeysForTarget(e).forEach((function(n){t.ct(e,n,null)}))}},{key:"It",value:function(e,t){return this.nt.getRemoteKeysForTarget(e).has(t)}}]),e}();function Dp(){return new up(ud.comparator)}function Ap(){return new up(ud.comparator)}var Pp={asc:"ASCENDING",desc:"DESCENDING"},Rp={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Op=ke((function e(t,n){me(this,e),this.databaseId=t,this.N=n}));function Lp(e,t){return e.N?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Mp(e,t){return e.N?t.toBase64():t.toUint8Array()}function Fp(e,t){return Lp(e,t.toTimestamp())}function Vp(e){return kf(!!e),qf.fromTimestamp(function(e){var t=$f(e);return new Vf(t.seconds,t.nanos)}(e))}function qp(e,t){return function(e){return new Wf(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Up(e){var t=Wf.fromString(e);return kf(cy(t)),t}function jp(e,t){return qp(e.databaseId,t.path)}function Bp(e,t){var n=Up(t);if(n.get(1)!==e.databaseId.projectId)throw new bf(wf.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new bf(wf.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ud(Gp(n))}function zp(e,t){return qp(e.databaseId,t)}function Wp(e){var t=Up(e);return 4===t.length?Wf.emptyPath():Gp(t)}function Kp(e){return new Wf(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Gp(e){return kf(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Hp(e,t,n){return{name:jp(e,t),fields:n.value.mapValue.fields}}function Qp(e,t,n){var r=Bp(e,t.name),i=Vp(t.updateTime),a=new Id({mapValue:{fields:t.fields}}),o=Nd.newFoundDocument(r,i,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Yp(e,t){return"found"in t?function(e,t){kf(!!t.found),t.found.name,t.found.updateTime;var n=Bp(e,t.found.name),r=Vp(t.found.updateTime),i=new Id({mapValue:{fields:t.found.fields}});return Nd.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){kf(!!t.missing),kf(!!t.readTime);var n=Bp(e,t.missing),r=Vp(t.readTime);return Nd.newNoDocument(n,r)}(e,t):gf()}function $p(e,t){var n;if(t instanceof Qv)n={update:Hp(e,t.key,t.value)};else if(t instanceof tp)n={delete:jp(e,t.key)};else if(t instanceof Yv)n={update:Hp(e,t.key,t.data),updateMask:sy(t.fieldMask)};else{if(!(t instanceof np))return gf();n={verify:jp(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof Dv)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Av)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Rv)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Lv)return{fieldPath:t.field.canonicalString(),increment:n.k};throw gf()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Fp(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:gf()}(e,t.precondition)),n}function Xp(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?Uv.updateTime(Vp(e.updateTime)):void 0!==e.exists?Uv.exists(e.exists):Uv.none()}(t.currentDocument):Uv.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)kf("REQUEST_TIME"===t.setToServerValue),n=new Dv;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Av(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new Rv(i)}else"increment"in t?n=new Lv(e,t.increment):gf();var a=Gf.fromServerFormat(t.fieldPath);return new Vv(a,n)}(e,t)})):[];if(t.update){t.update.name;var i=Bp(e,t.update.name),a=new Id({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=function(e){var t=e.fieldPaths||[];return new Hf(t.map((function(e){return Gf.fromServerFormat(e)})))}(t.updateMask);return new Yv(i,a,o,n,r)}return new Qv(i,a,n,r)}if(t.delete){var u=Bp(e,t.delete);return new tp(u,n)}if(t.verify){var s=Bp(e,t.verify);return new np(s,n)}return gf()}function Jp(e,t){return{documents:[zp(e,t.path)]}}function Zp(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=zp(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=zp(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(wd(e.value))return{unaryFilter:{field:iy(e.field),op:"IS_NAN"}};if(_d(e.value))return{unaryFilter:{field:iy(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(wd(e.value))return{unaryFilter:{field:iy(e.field),op:"IS_NOT_NAN"}};if(_d(e.value))return{unaryFilter:{field:iy(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:iy(e.field),op:ry(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:iy(e.field),direction:ny(e.dir)}}(e)}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,u=function(e,t){return e.N||id(t)?t:{value:t}}(e,t.limit);return null!==u&&(n.structuredQuery.limit=u),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function ey(e){var t=Wp(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){kf(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=ty(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(e){return function(e){return new tv(ay(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var s=null;n.limit&&(s=function(e){var t;return id(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new ev(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new ev(n,t)}(n.endAt)),ov(t,i,u,o,s,"F",c,l)}function ty(e){return e?void 0!==e.unaryFilter?[uy(e)]:void 0!==e.fieldFilter?[oy(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return ty(e)})).reduce((function(e,t){return e.concat(t)})):gf():[]}function ny(e){return Pp[e]}function ry(e){return Rp[e]}function iy(e){return{fieldPath:e.canonicalString()}}function ay(e){return Gf.fromServerFormat(e.fieldPath)}function oy(e){return Kd.create(ay(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return gf()}}(e.fieldFilter.op),e.fieldFilter.value)}function uy(e){switch(e.unaryFilter.op){case"IS_NAN":var t=ay(e.unaryFilter.field);return Kd.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=ay(e.unaryFilter.field);return Kd.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ay(e.unaryFilter.field);return Kd.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ay(e.unaryFilter.field);return Kd.create(i,"!=",{nullValue:"NULL_VALUE"});default:return gf()}}function sy(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function cy(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function ly(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=fy(t)),t=hy(e.get(n),t);return fy(t)}function hy(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=a}}return n}function fy(e){return e+"\x01\x01"}function dy(e){var t=e.length;if(kf(t>=2),2===t)return kf("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),Wf.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("\x01",a);switch((o<0||o>n)&&gf(),e.charAt(o+1)){case"\x01":var u=e.substring(a,o),s=void 0;0===i.length?s=u:(s=i+=u,i=""),r.push(s);break;case"\x10":i+=e.substring(a,o),i+="\0";break;case"\x11":i+=e.substring(a,o+1);break;default:gf()}a=o+2}return new Wf(r)}var vy=["userId","batchId"];function py(e,t){return[e,ly(t)]}function yy(e,t,n){return[e,ly(t),n]}var my={},gy=["prefixPath","collectionGroup","readTime","documentId"],ky=["prefixPath","collectionGroup","documentId"],_y=["collectionGroup","readTime","prefixPath","documentId"],wy=["canonicalId","targetId"],by=["targetId","path"],xy=["path","targetId"],Ey=["collectionId","parent"],Sy=["indexId","uid"],Cy=["uid","sequenceNumber"],Iy=["indexId","uid","arrayValue","directionalValue","documentKey"],Ty=["indexId","uid","documentKey"],Ny=["userId","collectionPath","documentId"],Dy=["userId","collectionPath","largestBatchId"],Ay=["userId","collectionGroup","largestBatchId"],Py=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),Ry=[].concat(pe(Py),["documentOverlays"]),Oy=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ly=[].concat(Oy,["indexConfiguration","indexState","indexEntries"]),My="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Fy=function(){function e(){me(this,e),this.onCommittedListeners=[]}return ke(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}(),Vy=function(){function e(t){var n=this;me(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return ke(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&gf(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,i=0,a=!1;t.forEach((function(t){++r,t.next((function(){++i,a&&i===r&&e()}),(function(e){return n(e)}))})),a=!0,i===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=ye(t);try{var a=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}}]),e}(),qy=function(){function e(t,n){var r=this;me(this,e),this.action=t,this.transaction=n,this.aborted=!1,this.At=new xf,this.transaction.oncomplete=function(){r.At.resolve()},this.transaction.onabort=function(){n.error?r.At.reject(new By(t,n.error)):r.At.resolve()},this.transaction.onerror=function(e){var n=Hy(e.target.error);r.At.reject(new By(t,n))}}return ke(e,[{key:"Rt",get:function(){return this.At.promise}},{key:"abort",value:function(e){e&&this.At.reject(e),this.aborted||(vf("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"bt",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new Wy(t)}}],[{key:"open",value:function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new By(n,t)}}}]),e}(),Uy=function(){function e(t,n,r){me(this,e),this.name=t,this.version=n,this.Pt=r,12.2===e.Vt(Me())&&pf("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return ke(e,[{key:"Nt",value:function(){var e=ie(oe().mark((function e(t){var n=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.db,e.t0){e.next=6;break}return vf("SimpleDb","Opening database:",this.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new By(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new bf(wf.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new bf(wf.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new By(t,n))},i.onupgradeneeded=function(e){vf("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.Pt.kt(t,i.transaction,e.oldVersion,n.version).next((function(){vf("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:this.db=e.sent;case 6:return this.Mt&&(this.db.onversionchange=function(e){return n.Mt(e)}),e.abrupt("return",this.db);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Ot",value:function(e){this.Mt=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(){var e=ie(oe().mark((function e(t,n,r,i){var a,o,u,s,c=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="readonly"===n,o=0;case 2:return++o,e.prev=3,e.delegateYield(oe().mark((function e(){var n,o;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.Nt(t);case 2:return c.db=e.sent,n=qy.open(c.db,t,a?"readonly":"readwrite",r),o=i(n).next((function(e){return n.bt(),e})).catch((function(e){return n.abort(e),Vy.reject(e)})).toPromise(),o.catch((function(){})),e.next=7,n.Rt;case 7:return e.t0=o,e.abrupt("return",{v:e.t0});case 9:case"end":return e.stop()}}),e)}))(),"t0",5);case 5:if("object"!==typeof(u=e.t0)){e.next=8;break}return e.abrupt("return",u.v);case 8:e.next=15;break;case 10:if(e.prev=10,e.t1=e.catch(3),s="FirebaseError"!==e.t1.name&&o<3,vf("SimpleDb","Transaction failed with error:",e.t1.message,"Retrying:",s),this.close(),s){e.next=15;break}return e.abrupt("return",Promise.reject(e.t1));case 15:e.next=2;break;case 17:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return vf("SimpleDb","Removing database:",e),Ky(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"vt",value:function(){if(!je())return!1;if(e.St())return!0;var t=Me(),n=e.Vt(t),r=0<n&&n<10,i=e.Dt(t),a=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||a)}},{key:"St",value:function(){var e;return"undefined"!=typeof process&&"YES"===(null===(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})||void 0===e?void 0:e.Ct)}},{key:"xt",value:function(e,t){return e.store(t)}},{key:"Vt",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"Dt",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),e}(),jy=function(){function e(t){me(this,e),this.Ft=t,this.$t=!1,this.Bt=null}return ke(e,[{key:"isDone",get:function(){return this.$t}},{key:"Lt",get:function(){return this.Bt}},{key:"cursor",set:function(e){this.Ft=e}},{key:"done",value:function(){this.$t=!0}},{key:"Ut",value:function(e){this.Bt=e}},{key:"delete",value:function(){return Ky(this.Ft.delete())}}]),e}(),By=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,wf.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(r))).name="IndexedDbTransactionError",i}return ke(n)}(bf);function zy(e){return"IndexedDbTransactionError"===e.name}var Wy=function(){function e(t){me(this,e),this.store=t}return ke(e,[{key:"put",value:function(e,t){var n;return void 0!==t?(vf("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(vf("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ky(n)}},{key:"add",value:function(e){return vf("SimpleDb","ADD",this.store.name,e,e),Ky(this.store.add(e))}},{key:"get",value:function(e){var t=this;return Ky(this.store.get(e)).next((function(n){return void 0===n&&(n=null),vf("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return vf("SimpleDb","DELETE",this.store.name,e),Ky(this.store.delete(e))}},{key:"count",value:function(){return vf("SimpleDb","COUNT",this.store.name),Ky(this.store.count())}},{key:"qt",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.Gt(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new Vy((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"Kt",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Vy((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"Qt",value:function(e,t){vf("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.jt=!1;var r=this.cursor(n);return this.Gt(r,(function(e,t,n){return n.delete()}))}},{key:"Wt",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.Gt(r,t)}},{key:"zt",value:function(e){var t=this.cursor({});return new Vy((function(n,r){t.onerror=function(e){var t=Hy(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"Gt",value:function(e,t){var n=[];return new Vy((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new jy(i),o=t(i.primaryKey,i.value,a);if(o instanceof Vy){var u=o.catch((function(e){return a.done(),Vy.reject(e)}));n.push(u)}a.isDone?r():null===a.Lt?i.continue():i.continue(a.Lt)}else r()}})).next((function(){return Vy.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.jt?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),e}();function Ky(e){return new Vy((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=Hy(e.target.error);n(t)}}))}var Gy=!1;function Hy(e){var t=Uy.Vt(Me());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new bf("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Gy||(Gy=!0,setTimeout((function(){throw r}),0)),r}}return e}var Qy=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this)).Ht=e,i.currentSequenceNumber=r,i}return ke(n)}(Fy);function Yy(e,t){var n=_f(e);return Uy.xt(n.Ht,t)}var $y=function(){function e(t,n,r,i){me(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return ke(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&zv(i,e,n[r])}}},{key:"applyToLocalView",value:function(e){var t,n=ye(this.baseMutations);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.key.isEqual(e.key)&&Wv(r,e,this.localWriteTime)}}catch(u){n.e(u)}finally{n.f()}var i,a=ye(this.mutations);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.key.isEqual(e.key)&&Wv(o,e,this.localWriteTime)}}catch(u){a.e(u)}finally{a.f()}}},{key:"applyToLocalDocumentSet",value:function(e){var t=this;this.mutations.forEach((function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(qf.min())}))}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),_p())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&Mf(this.mutations,e.mutations,(function(e,t){return Gv(e,t)}))&&Mf(this.baseMutations,e.baseMutations,(function(e,t){return Gv(e,t)}))}}]),e}(),Xy=function(){function e(t,n,r,i){me(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return ke(e,null,[{key:"from",value:function(t,n,r){kf(t.mutations.length===r.length);for(var i=gp,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),Jy=function(){function e(t,n){me(this,e),this.largestBatchId=t,this.mutation=n}return ke(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),Zy=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:qf.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:qf.min(),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Qf.EMPTY_BYTE_STRING;me(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return ke(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),em=ke((function e(t){me(this,e),this.Jt=t}));function tm(e,t){var n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:nm(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:jp(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Lp(e,t.version.toTimestamp())}}(e.Jt,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:rm(t.version)};else{if(!t.isUnknownDocument())return gf();r.unknownDocument={path:n.path.toArray(),version:rm(t.version)}}return r}function nm(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function rm(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function im(e){var t=new Vf(e.seconds,e.nanoseconds);return qf.fromTimestamp(t)}function am(e,t){for(var n=(t.baseMutations||[]).map((function(t){return Xp(e.Jt,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return Xp(e.Jt,t)})),u=Vf.fromMillis(t.localWriteTimeMs);return new $y(t.batchId,u,n,o)}function om(e){var t,n,r=im(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?im(e.lastLimboFreeSnapshotVersion):qf.min();return void 0!==e.query.documents?(kf(1===(n=e.query).documents.length),t=vv(uv(Wp(n.documents[0])))):t=function(e){return vv(ey(e))}(e.query),new Zy(t,e.targetId,0,e.lastListenSequenceNumber,r,i,Qf.fromBase64String(e.resumeToken))}function um(e,t){var n,r=rm(t.snapshotVersion),i=rm(t.lastLimboFreeSnapshotVersion);n=zd(t.target)?Jp(e.Jt,t.target):Zp(e.Jt,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:jd(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function sm(e){var t=ey({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?pv(t,t.limit,"L"):t}function cm(e,t){return new Jy(t.largestBatchId,Xp(e.Jt,t.overlayMutation))}function lm(e,t){var n=t.path.lastSegment();return[e,ly(t.path.popLast()),n]}var hm=function(){function e(){me(this,e)}return ke(e,[{key:"getBundleMetadata",value:function(e,t){return fm(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:im(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){return fm(e).put({bundleId:(n=t).id,createTime:rm(Vp(n.createTime)),version:n.version});var n}},{key:"getNamedQuery",value:function(e,t){return dm(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:sm(t.bundledQuery),readTime:im(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return dm(e).put(function(e){return{name:e.name,readTime:rm(Vp(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}]),e}();function fm(e){return Yy(e,"bundles")}function dm(e){return Yy(e,"namedQueries")}var vm=function(){function e(t,n){me(this,e),this.M=t,this.userId=n}return ke(e,[{key:"getOverlay",value:function(e,t){var n=this;return pm(e).get(lm(this.userId,t)).next((function(e){return e?cm(n.M,e):null}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new Jy(t,a);i.push(r.Xt(e,o))})),Vy.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(ly(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(pm(e).Qt("collectionPathOverlayIndex",i))})),Vy.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=mp(),a=ly(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return pm(e).qt("collectionPathOverlayIndex",o).next((function(e){var t,n=ye(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,o=cm(r.M,a);i.set(o.getKey(),o)}}catch(u){n.e(u)}finally{n.f()}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=mp(),u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return pm(e).Wt({index:"collectionGroupOverlayIndex",range:u},(function(e,t,n){var u=cm(a.M,t);o.size()<r||u.largestBatchId===i?(o.set(u.getKey(),u),i=u.largestBatchId):n.done()})).next((function(){return o}))}},{key:"Xt",value:function(e,t){return pm(e).put(function(e,t,n){var r=u(lm(t,n.mutation.key),3);r[0];return{userId:t,collectionPath:r[1],documentId:r[2],collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:$p(e.Jt,n.mutation)}}(this.M,this.userId,t))}}],[{key:"Yt",value:function(t,n){return new e(t,n.uid||"")}}]),e}();function pm(e){return Yy(e,"documentOverlays")}var ym=function(){function e(){me(this,e)}return ke(e,[{key:"Zt",value:function(e,t){this.te(e,t),t.ee()}},{key:"te",value:function(e,t){if("nullValue"in e)this.ne(t,5);else if("booleanValue"in e)this.ne(t,10),t.se(e.booleanValue?1:0);else if("integerValue"in e)this.ne(t,15),t.se(Xf(e.integerValue));else if("doubleValue"in e){var n=Xf(e.doubleValue);isNaN(n)?this.ne(t,13):(this.ne(t,15),ad(n)?t.se(0):t.se(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ne(t,20),"string"==typeof r?t.ie(r):(t.ie("".concat(r.seconds||"")),t.se(r.nanos||0))}else if("stringValue"in e)this.re(e.stringValue,t),this.oe(t);else if("bytesValue"in e)this.ne(t,30),t.ue(Jf(e.bytesValue)),this.oe(t);else if("referenceValue"in e)this.ae(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ne(t,45),t.se(i.latitude||0),t.se(i.longitude||0)}else"mapValue"in e?Ed(e)?this.ne(t,Number.MAX_SAFE_INTEGER):(this.ce(e.mapValue,t),this.oe(t)):"arrayValue"in e?(this.he(e.arrayValue,t),this.oe(t)):gf()}},{key:"re",value:function(e,t){this.ne(t,25),this.le(e,t)}},{key:"le",value:function(e,t){t.ie(e)}},{key:"ce",value:function(e,t){var n=e.fields||{};this.ne(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.re(a,t),this.te(n[a],t)}}},{key:"he",value:function(e,t){var n=e.values||[];this.ne(t,50);var r,i=ye(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.te(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"ae",value:function(e,t){var n=this;this.ne(t,37),ud.fromName(e).path.forEach((function(e){n.ne(t,60),n.le(e,t)}))}},{key:"ne",value:function(e,t){e.se(t)}},{key:"oe",value:function(e){e.se(2)}}]),e}();function mm(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function gm(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=mm(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}ym.fe=new ym;var km=function(){function e(){me(this,e),this.buffer=new Uint8Array(1024),this.position=0}return ke(e,[{key:"de",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this._e(n.value),n=t.next();this.we()}},{key:"me",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.ge(n.value),n=t.next();this.ye()}},{key:"pe",value:function(e){var t,n=ye(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this._e(i);else if(i<2048)this._e(960|i>>>6),this._e(128|63&i);else if(r<"\ud800"||"\udbff"<r)this._e(480|i>>>12),this._e(128|63&i>>>6),this._e(128|63&i);else{var a=r.codePointAt(0);this._e(240|a>>>18),this._e(128|63&a>>>12),this._e(128|63&a>>>6),this._e(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.we()}},{key:"Ie",value:function(e){var t,n=ye(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.charCodeAt(0);if(i<128)this.ge(i);else if(i<2048)this.ge(960|i>>>6),this.ge(128|63&i);else if(r<"\ud800"||"\udbff"<r)this.ge(480|i>>>12),this.ge(128|63&i>>>6),this.ge(128|63&i);else{var a=r.codePointAt(0);this.ge(240|a>>>18),this.ge(128|63&a>>>12),this.ge(128|63&a>>>6),this.ge(128|63&a)}}}catch(o){n.e(o)}finally{n.f()}this.ye()}},{key:"Te",value:function(e){var t=this.Ee(e),n=gm(t);this.Ae(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"Re",value:function(e){var t=this.Ee(e),n=gm(t);this.Ae(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"be",value:function(){this.Pe(255),this.Pe(255)}},{key:"Ve",value:function(){this.ve(255),this.ve(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.Ae(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"Se",value:function(){return this.buffer.slice(0,this.position)}},{key:"Ee",value:function(e){var t=function(e){var t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(var r=1;r<t.length;++r)t[r]^=n?255:0;return t}},{key:"_e",value:function(e){var t=255&e;0===t?(this.Pe(0),this.Pe(255)):255===t?(this.Pe(255),this.Pe(0)):this.Pe(t)}},{key:"ge",value:function(e){var t=255&e;0===t?(this.ve(0),this.ve(255)):255===t?(this.ve(255),this.ve(0)):this.ve(e)}},{key:"we",value:function(){this.Pe(0),this.Pe(1)}},{key:"ye",value:function(){this.ve(0),this.ve(1)}},{key:"Pe",value:function(e){this.Ae(1),this.buffer[this.position++]=e}},{key:"ve",value:function(e){this.Ae(1),this.buffer[this.position++]=~e}},{key:"Ae",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),e}(),_m=function(){function e(t){me(this,e),this.De=t}return ke(e,[{key:"ue",value:function(e){this.De.de(e)}},{key:"ie",value:function(e){this.De.pe(e)}},{key:"se",value:function(e){this.De.Te(e)}},{key:"ee",value:function(){this.De.be()}}]),e}(),wm=function(){function e(t){me(this,e),this.De=t}return ke(e,[{key:"ue",value:function(e){this.De.me(e)}},{key:"ie",value:function(e){this.De.Ie(e)}},{key:"se",value:function(e){this.De.Re(e)}},{key:"ee",value:function(){this.De.Ve()}}]),e}(),bm=function(){function e(){me(this,e),this.De=new km,this.Ce=new _m(this.De),this.xe=new wm(this.De)}return ke(e,[{key:"seed",value:function(e){this.De.seed(e)}},{key:"Ne",value:function(e){return 0===e?this.Ce:this.xe}},{key:"Se",value:function(){return this.De.Se()}},{key:"reset",value:function(){this.De.reset()}}]),e}(),xm=function(){function e(t,n,r,i){me(this,e),this.indexId=t,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}return ke(e,[{key:"ke",value:function(){var t=this.directionalValue.length,n=0===t||255===this.directionalValue[t-1]?t+1:t,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==t?r.set([0],this.directionalValue.length):++r[r.length-1],new e(this.indexId,this.documentKey,this.arrayValue,r)}}]),e}();function Em(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=Sm(e.arrayValue,t.arrayValue))?n:0!==(n=Sm(e.directionalValue,t.directionalValue))?n:ud.comparator(e.documentKey,t.documentKey)}function Sm(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}var Cm=function(){function e(t){me(this,e),this.collectionId=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment(),this.Me=t.orderBy,this.Oe=[];var n,r=ye(t.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.S()?this.Fe=i:this.Oe.push(i)}}catch(a){r.e(a)}finally{r.f()}}return ke(e,[{key:"$e",value:function(e){var t=Ad(e);if(void 0!==t&&!this.Be(t))return!1;for(var n=Pd(e),r=0,i=0;r<n.length&&this.Be(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Fe){var a=n[r];if(!this.Le(this.Fe,a)||!this.Ue(this.Me[i++],a))return!1;++r}for(;r<n.length;++r){var o=n[r];if(i>=this.Me.length||!this.Ue(this.Me[i++],o))return!1}return!0}},{key:"Be",value:function(e){var t,n=ye(this.Oe);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.Le(r,e))return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"Le",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"Ue",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),e}(),Im=function(){function e(){me(this,e),this.qe=new Tm}return ke(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.qe.add(t),Vy.resolve()}},{key:"getCollectionParents",value:function(e,t){return Vy.resolve(this.qe.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Vy.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Vy.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Vy.resolve(null)}},{key:"getFieldIndex",value:function(e,t){return Vy.resolve(null)}},{key:"getFieldIndexes",value:function(e,t){return Vy.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Vy.resolve(null)}},{key:"updateCollectionGroup",value:function(e,t,n){return Vy.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Vy.resolve()}}]),e}(),Tm=function(){function e(){me(this,e),this.index={}}return ke(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new lp(Wf.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new lp(Wf.comparator)).toArray()}}]),e}(),Nm=new Uint8Array(0),Dm=function(){function e(t){me(this,e),this.user=t,this.Ge=new Tm,this.Ke=new op((function(e){return jd(e)}),(function(e,t){return Bd(e,t)})),this.uid=t.uid||""}return ke(e,[{key:"addToCollectionParentIndex",value:function(e,t){var n=this;if(!this.Ge.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.Ge.add(t)}));var a={collectionId:r,parent:ly(i)};return Am(e).put(a)}return Vy.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[Ff(t),""],!1,!0);return Am(e).qt(r).next((function(e){var r,i=ye(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.collectionId!==t)break;n.push(dy(a.parent))}}catch(o){i.e(o)}finally{i.f()}return n}))}},{key:"addFieldIndex",value:function(e,t){var n=Rm(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))}}(t);return delete r.indexId,n.add(r).next()}},{key:"deleteFieldIndex",value:function(e,t){var n=Rm(e),r=Om(e),i=Pm(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=Pm(e),i=!0,a=new Map;return Vy.forEach(this.Qe(t),(function(t){return n.getFieldIndex(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=_p();return Vy.forEach(a,(function(i,a){var o;vf("IndexedDbIndexManager","Using index ".concat((o=i,"id=".concat(o.indexId,"|cg=").concat(o.collectionGroup,"|f=").concat(o.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(jd(t)));var u=function(e,t){var n=Ad(t);if(void 0===n)return null;var r,i=ye(Wd(e,n.fieldPath));try{for(i.s();!(r=i.n()).done;){var a=r.value;switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}}}catch(o){i.e(o)}finally{i.f()}return null}(a,i),s=function(e,t){var n,r=new Map,i=ye(Pd(t));try{for(i.s();!(n=i.n()).done;){var a,o=n.value,u=ye(Wd(e,o.fieldPath));try{for(u.s();!(a=u.n()).done;){var s=a.value;switch(s.op){case"==":case"in":r.set(o.fieldPath.canonicalString(),s.value);break;case"not-in":case"!=":return r.set(o.fieldPath.canonicalString(),s.value),Array.from(r.values())}}}catch(c){u.e(c)}finally{u.f()}}}catch(c){i.e(c)}finally{i.f()}return null}(a,i),c=function(e,t){var n,r,i=[],a=!0,o=ye(Pd(t));try{for(o.s();!(n=o.n()).done;){var u,s=n.value,c=void 0,l=!0,h=ye(Wd(e,s.fieldPath));try{for(h.s();!(u=h.n()).done;){var f=u.value,d=void 0,v=!0;switch(f.op){case"<":case"<=":d="nullValue"in(r=f.value)?cd:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?md(rd.empty(),ud.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?{mapValue:{}}:gf();break;case"==":case"in":case">=":d=f.value;break;case">":d=f.value,v=!1;break;case"!=":case"not-in":d=cd}Sd(c,d)===d&&(c=d,l=v)}}catch(m){h.e(m)}finally{h.f()}if(null!==e.startAt)for(var p=0;p<e.orderBy.length;++p)if(e.orderBy[p].field.isEqual(s.fieldPath)){var y=e.startAt.position[p];Sd(c,y)===y&&(c=y,l=e.startAt.inclusive);break}if(void 0===c)return null;i.push(c),a&&(a=l)}}catch(m){o.e(m)}finally{o.f()}return new ev(i,a)}(a,i),l=function(e,t){var n,r,i=[],a=!0,o=ye(Pd(t));try{for(o.s();!(n=o.n()).done;){var u,s=n.value,c=void 0,l=!0,h=ye(Wd(e,s.fieldPath));try{for(h.s();!(u=h.n()).done;){var f=u.value,d=void 0,v=!0;switch(f.op){case">=":case">":d="nullValue"in(r=f.value)?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?md(rd.empty(),ud.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?{mapValue:{}}:"mapValue"in r?sd:gf(),v=!1;break;case"==":case"in":case"<=":d=f.value;break;case"<":d=f.value,v=!1;break;case"!=":case"not-in":d=sd}Cd(c,d)===d&&(c=d,l=v)}}catch(m){h.e(m)}finally{h.f()}if(null!==e.endAt)for(var p=0;p<e.orderBy.length;++p)if(e.orderBy[p].field.isEqual(s.fieldPath)){var y=e.endAt.position[p];Cd(c,y)===y&&(c=y,l=e.endAt.inclusive);break}if(void 0===c)return null;i.push(c),a&&(a=l)}}catch(m){o.e(m)}finally{o.f()}return new ev(i,a)}(a,i),h=n.je(i,a,c),f=n.je(i,a,l),d=n.We(i,a,s),v=n.ze(i.indexId,u,h,!!c&&c.inclusive,f,!!l&&l.inclusive,d);return Vy.forEach(v,(function(n){return r.Kt(n,t.limit).next((function(t){t.forEach((function(t){e=e.add(new ud(dy(t.documentKey)))}))}))}))})).next((function(){return e}))}return Vy.resolve(null)}))}},{key:"Qe",value:function(e){var t=this.Ke.get(e);return t||(t=[e],this.Ke.set(e,t),t)}},{key:"ze",value:function(e,t,n,r,i,a,o){for(var u=this,s=(null!=t?t.length:1)*Math.max(null!=n?n.length:1,null!=i?i.length:1),c=s/(null!=t?t.length:1),l=[],h=function(s){var h=t?u.He(t[s/c]):Nm,f=n?u.Je(e,h,n[s%c],r):u.Ye(e),d=i?u.Xe(e,h,i[s%c],a):u.Ye(e+1);l.push.apply(l,pe(u.createRange(f,d,o.map((function(t){return u.Je(e,h,t,!0)})))))},f=0;f<s;++f)h(f);return l}},{key:"Je",value:function(e,t,n,r){var i=new xm(e,ud.empty(),t,n);return r?i:i.ke()}},{key:"Xe",value:function(e,t,n,r){var i=new xm(e,ud.empty(),t,n);return r?i.ke():i}},{key:"Ye",value:function(e){return new xm(e,ud.empty(),Nm,Nm)}},{key:"getFieldIndex",value:function(e,t){var n=new Cm(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t=e.filter((function(e){return n.$e(e)}));return t.sort((function(e,t){return t.fields.length-e.fields.length})),t.length>0?t[0]:null}))}},{key:"Ze",value:function(e,t){var n,r=new bm,i=ye(Pd(e));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.fieldPath);if(null==o)return null;var u=r.Ne(a.kind);ym.fe.Zt(o,u)}}catch(s){i.e(s)}finally{i.f()}return r.Se()}},{key:"He",value:function(e){var t=new bm;return ym.fe.Zt(e,t.Ne(0)),t.Se()}},{key:"We",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new bm);var i,a=0,o=ye(Pd(e));try{for(o.s();!(i=o.n()).done;){var u,s=i.value,c=n[a++],l=ye(r);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(this.tn(t,s.fieldPath)&&kd(c))r=this.en(r,s,c);else{var f=h.Ne(s.kind);ym.fe.Zt(c,f)}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}return this.nn(r)}},{key:"je",value:function(e,t,n){return null==n?null:this.We(e,t,n.position)}},{key:"nn",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].Se();return t}},{key:"en",value:function(e,t,n){var r,i=pe(e),a=[],o=ye(n.arrayValue.values||[]);try{for(o.s();!(r=o.n()).done;){var u,s=r.value,c=ye(i);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=new bm;h.seed(l.Se()),ym.fe.Zt(s,h.Ne(t.kind)),a.push(h)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a}},{key:"tn",value:function(e,t){return!!e.filters.find((function(e){return e instanceof Kd&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(e,t){var n=this,r=Rm(e),i=Om(e);return(t?r.qt("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.qt()).next((function(e){var t=[];return Vy.forEach(e,(function(e){return i.get([e.indexId,n.uid]).next((function(n){t.push(function(e,t){var n=t?new Od(t.sequenceNumber,new Fd(im(t.readTime),new ud(dy(t.documentKey)),t.largestBatchId)):Od.empty(),r=e.fields.map((function(e){var t=u(e,2),n=t[0],r=t[1];return new Rd(Gf.fromServerFormat(n),r)}));return new Dd(e.indexId,e.collectionGroup,r,n)}(e,n))}))})).next((function(){return t}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:Lf(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=Rm(e),a=Om(e);return this.sn(e).next((function(e){return i.qt("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return Vy.forEach(t,(function(t){return a.put(function(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:rm(r.readTime),documentKey:ly(r.documentKey.path),largestBatchId:r.largestBatchId}}(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Vy.forEach(t,(function(t,i){var a=r.get(t.collectionGroup);return(a?Vy.resolve(a):n.getFieldIndexes(e,t.collectionGroup)).next((function(a){return r.set(t.collectionGroup,a),Vy.forEach(a,(function(r){return n.rn(e,t,r).next((function(t){var a=n.on(i,r);return t.isEqual(a)?Vy.resolve():n.un(e,i,t,a)}))}))}))}))}},{key:"an",value:function(e,t,n){return Pm(e).put({indexId:n.indexId,uid:this.uid,arrayValue:n.arrayValue,directionalValue:n.directionalValue,documentKey:ly(t.key.path)})}},{key:"cn",value:function(e,t,n){return Pm(e).delete([n.indexId,this.uid,n.arrayValue,n.directionalValue,ly(t.key.path)])}},{key:"rn",value:function(e,t,n){var r=Pm(e),i=new lp(Em);return r.Wt({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,ly(t.path)])},(function(e,r){i=i.add(new xm(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"on",value:function(e,t){var n=new lp(Em),r=this.Ze(t,e);if(null==r)return n;var i=Ad(t);if(null!=i){var a=e.data.field(i.fieldPath);if(kd(a)){var o,u=ye(a.arrayValue.values||[]);try{for(u.s();!(o=u.n()).done;){var s=o.value;n=n.add(new xm(t.indexId,e.key,this.He(s),r))}}catch(c){u.e(c)}finally{u.f()}}}else n=n.add(new xm(t.indexId,e.key,Nm,r));return n}},{key:"un",value:function(e,t,n,r){var i=this;vf("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var a=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),u=fp(a),s=fp(o);u||s;){var c=!1,l=!1;if(u&&s){var h=n(u,s);h<0?l=!0:h>0&&(c=!0)}else null!=u?l=!0:c=!0;c?(r(s),s=fp(o)):l?(i(u),u=fp(a)):(u=fp(a),s=fp(o))}}(n,r,Em,(function(n){a.push(i.an(e,t,n))}),(function(n){a.push(i.cn(e,t,n))})),Vy.waitFor(a)}},{key:"sn",value:function(e){var t=1;return Om(e).Wt({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return Em(e,t)})).filter((function(e,t,n){return!t||0!==Em(e,n[t-1])}));var r=[];r.push(e);var i,a=ye(n);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=Em(o,e),s=Em(o,t);if(0===u)r[0]=e.ke();else if(u>0&&s<0)r.push(o),r.push(o.ke());else if(s>0)break}}catch(h){a.e(h)}finally{a.f()}r.push(t);for(var c=[],l=0;l<r.length;l+=2)c.push(IDBKeyRange.bound([r[l].indexId,this.uid,r[l].arrayValue,r[l].directionalValue,""],[r[l+1].indexId,this.uid,r[l+1].arrayValue,r[l+1].directionalValue,""]));return c}}]),e}();function Am(e){return Yy(e,"collectionParents")}function Pm(e){return Yy(e,"indexEntries")}function Rm(e){return Yy(e,"indexConfiguration")}function Om(e){return Yy(e,"indexState")}var Lm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mm=function(){function e(t,n,r){me(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return ke(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();function Fm(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),u=0,s=r.Wt({range:o},(function(e,t,n){return u++,n.delete()}));a.push(s.next((function(){kf(1===u)})));var c,l=[],h=ye(n.mutations);try{for(h.s();!(c=h.n()).done;){var f=c.value,d=yy(t,f.key.path,n.batchId);a.push(i.delete(d)),l.push(f.key)}}catch(v){h.e(v)}finally{h.f()}return Vy.waitFor(a).next((function(){return l}))}function Vm(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw gf();t=e.noDocument}return JSON.stringify(t).length}Mm.DEFAULT_COLLECTION_PERCENTILE=10,Mm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mm.DEFAULT=new Mm(41943040,Mm.DEFAULT_COLLECTION_PERCENTILE,Mm.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mm.DISABLED=new Mm(-1,0,0);var qm=function(){function e(t,n,r,i){me(this,e),this.userId=t,this.M=n,this.indexManager=r,this.referenceDelegate=i,this.hn={}}return ke(e,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return jm(e).Wt({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=Bm(e),o=jm(e);return o.add({}).next((function(u){kf("number"==typeof u);var s,c=new $y(u,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return $p(e.Jt,t)})),i=n.mutations.map((function(t){return $p(e.Jt,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.M,i.userId,c),h=[],f=new lp((function(e,t){return Lf(e.canonicalString(),t.canonicalString())})),d=ye(r);try{for(d.s();!(s=d.n()).done;){var v=s.value,p=yy(i.userId,v.key.path,u);f=f.add(v.key.path.popLast()),h.push(o.put(l)),h.push(a.put(p,my))}}catch(y){d.e(y)}finally{d.f()}return f.forEach((function(t){h.push(i.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.hn[u]=c.keys()})),Vy.waitFor(h).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return jm(e).get(t).next((function(e){return e?(kf(e.userId===n.userId),am(n.M,e)):null}))}},{key:"ln",value:function(e,t){var n=this;return this.hn[t]?Vy.resolve(this.hn[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.hn[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return jm(e).Wt({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&(kf(t.batchId>=r),a=am(n.M,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return jm(e).Wt({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return jm(e).qt("userMutationsIndex",n).next((function(e){return e.map((function(e){return am(t.M,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=py(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return Bm(e).Wt({range:i},(function(r,i,o){var s=u(r,3),c=s[0],l=s[1],h=s[2],f=dy(l);if(c===n.userId&&t.path.isEqual(f))return jm(e).get(h).next((function(e){if(!e)throw gf();kf(e.userId===n.userId),a.push(am(n.M,e))}));o.done()})).next((function(){return a}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new lp(Lf),i=[];return t.forEach((function(t){var a=py(n.userId,t.path),o=IDBKeyRange.lowerBound(a),s=Bm(e).Wt({range:o},(function(e,i,a){var o=u(e,3),s=o[0],c=o[1],l=o[2],h=dy(c);s===n.userId&&t.path.isEqual(h)?r=r.add(l):a.done()}));i.push(s)})),Vy.waitFor(i).next((function(){return n.fn(e,r)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=this,r=t.path,i=r.length+1,a=py(this.userId,r),o=IDBKeyRange.lowerBound(a),s=new lp(Lf);return Bm(e).Wt({range:o},(function(e,t,a){var o=u(e,3),c=o[0],l=o[1],h=o[2],f=dy(l);c===n.userId&&r.isPrefixOf(f)?f.length===i&&(s=s.add(h)):a.done()})).next((function(){return n.fn(e,s)}))}},{key:"fn",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(jm(e).get(t).next((function(e){if(null===e)throw gf();kf(e.userId===n.userId),r.push(am(n.M,e))})))})),Vy.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return Fm(e.Ht,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.dn(t.batchId)})),Vy.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"dn",value:function(e){delete this.hn[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return Vy.resolve();var r=IDBKeyRange.lowerBound([t.userId]),i=[];return Bm(e).Wt({range:r},(function(e,n,r){if(e[0]===t.userId){var a=dy(e[1]);i.push(a)}else r.done()})).next((function(){kf(0===i.length)}))}))}},{key:"containsKey",value:function(e,t){return Um(e,this.userId,t)}},{key:"_n",value:function(e){var t=this;return zm(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"Yt",value:function(t,n,r,i){return kf(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)}}]),e}();function Um(e,t,n){var r=py(t,n.path),i=r[1],a=IDBKeyRange.lowerBound(r),o=!1;return Bm(e).Wt({range:a,jt:!0},(function(e,n,r){var a=u(e,3),s=a[0],c=a[1];a[2];s===t&&c===i&&(o=!0),r.done()})).next((function(){return o}))}function jm(e){return Yy(e,"mutations")}function Bm(e){return Yy(e,"documentMutations")}function zm(e){return Yy(e,"mutationQueues")}var Wm=function(){function e(t){me(this,e),this.wn=t}return ke(e,[{key:"next",value:function(){return this.wn+=2,this.wn}}],[{key:"mn",value:function(){return new e(0)}},{key:"gn",value:function(){return new e(-1)}}]),e}(),Km=function(){function e(t,n){me(this,e),this.referenceDelegate=t,this.M=n}return ke(e,[{key:"allocateTargetId",value:function(e){var t=this;return this.yn(e).next((function(n){var r=new Wm(n.highestTargetId);return n.highestTargetId=r.next(),t.pn(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.yn(e).next((function(e){return qf.fromTimestamp(new Vf(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.yn(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.yn(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.pn(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.In(e,t).next((function(){return n.yn(e).next((function(r){return r.targetCount+=1,n.Tn(t,r),n.pn(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.In(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return Gm(e).delete(t.targetId)})).next((function(){return n.yn(e)})).next((function(t){return kf(t.targetCount>0),t.targetCount-=1,n.pn(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return Gm(e).Wt((function(o,u){var s=om(u);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))})).next((function(){return Vy.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return Gm(e).Wt((function(e,n){var r=om(n);t(r)}))}},{key:"yn",value:function(e){return Hm(e).get("targetGlobalKey").next((function(e){return kf(null!==e),e}))}},{key:"pn",value:function(e,t){return Hm(e).put("targetGlobalKey",t)}},{key:"In",value:function(e,t){return Gm(e).put(um(this.M,t))}},{key:"Tn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.yn(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=jd(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Gm(e).Wt({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=om(n);Bd(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=Qm(e);return t.forEach((function(t){var o=ly(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),Vy.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=Qm(e);return Vy.forEach(t,(function(t){var a=ly(t.path);return Vy.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=Qm(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Qm(e),i=_p();return r.Wt({range:n,jt:!0},(function(e,t,n){var r=dy(e[1]),a=new ud(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(e,t){var n=ly(t.path),r=IDBKeyRange.bound([n],[Ff(n)],!1,!0),i=0;return Qm(e).Wt({index:"documentTargetsIndex",jt:!0,range:r},(function(e,t,n){var r=u(e,2),a=r[0];r[1];0!==a&&(i++,n.done())})).next((function(){return i>0}))}},{key:"Et",value:function(e,t){return Gm(e).get(t).next((function(e){return e?om(e):null}))}}]),e}();function Gm(e){return Yy(e,"targets")}function Hm(e){return Yy(e,"targetGlobal")}function Qm(e){return Yy(e,"targetDocuments")}function Ym(e){return $m.apply(this,arguments)}function $m(){return $m=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===wf.FAILED_PRECONDITION&&t.message===My){e.next=2;break}throw t;case 2:vf("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)}))),$m.apply(this,arguments)}function Xm(e,t){var n=u(e,2),r=n[0],i=n[1],a=u(t,2),o=a[0],s=a[1],c=Lf(r,o);return 0===c?Lf(i,s):c}var Jm=function(){function e(t){me(this,e),this.En=t,this.buffer=new lp(Xm),this.An=0}return ke(e,[{key:"Rn",value:function(){return++this.An}},{key:"bn",value:function(e){var t=[e,this.Rn()];if(this.buffer.size<this.En)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Xm(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),e}(),Zm=function(){function e(t,n){me(this,e),this.garbageCollector=t,this.asyncQueue=n,this.Pn=!1,this.Vn=null}return ke(e,[{key:"start",value:function(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.vn(e)}},{key:"stop",value:function(){this.Vn&&(this.Vn.cancel(),this.Vn=null)}},{key:"started",get:function(){return null!==this.Vn}},{key:"vn",value:function(e){var t=this,n=this.Pn?3e5:6e4;vf("LruGarbageCollector","Garbage collection scheduled in ".concat(n,"ms")),this.Vn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,ie(oe().mark((function n(){return oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.Vn=null,t.Pn=!0,n.prev=1,n.next=4,e.collectGarbage(t.garbageCollector);case 4:n.next=14;break;case 6:if(n.prev=6,n.t0=n.catch(1),!zy(n.t0)){n.next=12;break}vf("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n.t0),n.next=14;break;case 12:return n.next=14,Ym(n.t0);case 14:return n.next=16,t.vn(e);case 16:case"end":return n.stop()}}),n,null,[[1,6]])}))))}}]),e}(),eg=function(){function e(t,n){me(this,e),this.Sn=t,this.params=n}return ke(e,[{key:"calculateTargetCount",value:function(e,t){return this.Sn.Dn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Vy.resolve(Pf.A);var r=new Jm(t);return this.Sn.forEachTarget(e,(function(e){return r.bn(e.sequenceNumber)})).next((function(){return n.Sn.Cn(e,(function(e){return r.bn(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.Sn.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.Sn.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(vf("LruGarbageCollector","Garbage collection skipped; disabled"),Vy.resolve(Lm)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(vf("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),Lm):n.xn(e,t)}))}},{key:"getCacheSize",value:function(e){return this.Sn.getCacheSize(e)}},{key:"xn",value:function(e,t){var n,r,i,a,o,u,s,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(vf("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,u=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return s=Date.now(),df()<=gt.DEBUG&&vf("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(u-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(s-u)+"ms\n"+"Total Duration: ".concat(s-l,"ms")),Vy.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),e}(),tg=function(){function e(t,n){me(this,e),this.db=t,this.garbageCollector=function(e,t){return new eg(e,t)}(this,n)}return ke(e,[{key:"Dn",value:function(e){var t=this.Nn(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"Nn",value:function(e){var t=0;return this.Cn(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Cn",value:function(e,t){return this.kn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return ng(e,n)}},{key:"removeReference",value:function(e,t,n){return ng(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return ng(e,t)}},{key:"Mn",value:function(e,t){return function(e,t){var n=!1;return zm(e).zt((function(r){return Um(e,r,t).next((function(e){return e&&(n=!0),Vy.resolve(!e)}))})).next((function(){return n}))}(e,t)}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.kn(e,(function(o,u){if(u<=t){var s=n.Mn(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,qf.min()),Qm(e).delete([0,ly(o.path)])}))}));i.push(s)}})).next((function(){return Vy.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return ng(e,t)}},{key:"kn",value:function(e,t){var n,r=Qm(e),i=Pf.A;return r.Wt({index:"documentTargetsIndex"},(function(e,r){var a=u(e,2),o=a[0],s=(a[1],r.path),c=r.sequenceNumber;0===o?(i!==Pf.A&&t(new ud(dy(n)),i),i=c,n=s):i=Pf.A})).next((function(){i!==Pf.A&&t(new ud(dy(n)),i)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),e}();function ng(e,t){return Qm(e).put(function(e,t){return{targetId:0,path:ly(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}var rg=function(){function e(){me(this,e),this.changes=new op((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return ke(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,Nd.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Vy.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}(),ig=function(){function e(t){me(this,e),this.M=t}return ke(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return ug(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return ug(e).delete(function(e,t){var n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],nm(t),n[n.length-1]]}(t,n))}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.On(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=Nd.newInvalidDocument(t);return ug(e).Wt({index:"documentKeyIndex",range:IDBKeyRange.only(sg(t))},(function(e,i){r=n.Fn(t,i)})).next((function(){return r}))}},{key:"$n",value:function(e,t){var n=this,r={size:0,document:Nd.newInvalidDocument(t)};return ug(e).Wt({index:"documentKeyIndex",range:IDBKeyRange.only(sg(t))},(function(e,i){r={document:n.Fn(t,i),size:Vm(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=vp();return this.Bn(e,t,(function(e,t){var i=n.Fn(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"Ln",value:function(e,t){var n=this,r=vp(),i=new up(ud.comparator);return this.Bn(e,t,(function(e,t){var a=n.Fn(e,t);r=r.insert(e,a),i=i.insert(e,Vm(t))})).next((function(){return{documents:r,Un:i}}))}},{key:"Bn",value:function(e,t,n){if(t.isEmpty())return Vy.resolve();var r=new lp(lg);t.forEach((function(e){return r=r.add(e)}));var i=IDBKeyRange.bound(sg(r.first()),sg(r.last())),a=r.getIterator(),o=a.getNext();return ug(e).Wt({index:"documentKeyIndex",range:i},(function(e,t,r){for(var i=ud.fromSegments([].concat(pe(t.prefixPath),[t.collectionGroup,t.documentId]));o&&lg(o,i)<0;)n(o,null),o=a.getNext();o&&o.isEqual(i)&&(n(o,t),o=a.hasNext()?a.getNext():null),o?r.Ut(sg(o)):r.done()})).next((function(){for(;o;)n(o,null),o=a.hasNext()?a.getNext():null}))}},{key:"getAllFromCollection",value:function(e,t,n){var r=this,i=[t.popLast().toArray(),t.lastSegment(),nm(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ug(e).qt(IDBKeyRange.bound(i,a,!0)).next((function(e){var t,n=vp(),i=ye(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=r.Fn(ud.fromSegments(a.prefixPath.concat(a.collectionGroup,a.documentId)),a);n=n.insert(o.key,o)}}catch(u){i.e(u)}finally{i.f()}return n}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=vp(),o=cg(t,n),u=cg(t,Fd.max());return ug(e).Wt({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(function(e,t,n){var o=i.Fn(ud.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new ag(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return og(e).get("remoteDocumentGlobalKey").next((function(e){return kf(!!e),e}))}},{key:"On",value:function(e,t){return og(e).put("remoteDocumentGlobalKey",t)}},{key:"Fn",value:function(e,t){if(t){var n=function(e,t){var n;if(t.document)n=Qp(e.Jt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var r=ud.fromSegments(t.noDocument.path),i=im(t.noDocument.readTime);n=Nd.newNoDocument(r,i),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return gf();var a=ud.fromSegments(t.unknownDocument.path),o=im(t.unknownDocument.version);n=Nd.newUnknownDocument(a,o)}return t.readTime&&n.setReadTime(function(e){var t=new Vf(e[0],e[1]);return qf.fromTimestamp(t)}(t.readTime)),n}(this.M,t);if(!n.isNoDocument()||!n.version.isEqual(qf.min()))return n}return Nd.newInvalidDocument(e)}}]),e}(),ag=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this)).qn=e,i.trackRemovals=r,i.Gn=new op((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),i}return ke(n,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new lp((function(e,t){return Lf(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var u=t.Gn.get(a);if(n.push(t.qn.removeEntry(e,a,u.readTime)),o.isValidDocument()){var s=tm(t.qn.M,o);i=i.add(a.path.popLast());var c=Vm(s);r+=c-u.size,n.push(t.qn.addEntry(e,a,s))}else if(r-=u.size,t.trackRemovals){var l=tm(t.qn.M,o.convertToNoDocument(qf.min()));n.push(t.qn.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.qn.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.qn.updateMetadata(e,r)),Vy.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.qn.$n(e,t).next((function(e){return n.Gn.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.qn.Ln(e,t).next((function(e){var t=e.documents;return e.Un.forEach((function(e,r){n.Gn.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),n}(rg);function og(e){return Yy(e,"remoteDocumentGlobal")}function ug(e){return Yy(e,"remoteDocumentsV14")}function sg(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function cg(e,t){var n=t.documentKey.path.toArray();return[e,nm(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function lg(e,t){var n=e.path.length-t.path.length;return 0!==n?n:ud.comparator(e,t)}var hg=function(){function e(t){me(this,e),this.M=t}return ke(e,[{key:"kt",value:function(e,t,n,r){var i=this,a=new qy("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",vy,{unique:!0}),e.createObjectStore("documentMutations")}(e),fg(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=Vy.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),fg(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:qf.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return function(e,t){return t.store("mutations").qt().next((function(n){e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",vy,{unique:!0});var r=t.store("mutations"),i=n.map((function(e){return r.put(e)}));return Vy.waitFor(i)}))}(e,a)}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.Kn(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Qn(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.jn(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.Wn(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.zn(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:Ny});t.createIndex("collectionPathOverlayIndex",Dy,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Ay,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:gy});t.createIndex("documentKeyIndex",ky),t.createIndex("collectionGroupIndex",_y)}(e)})).next((function(){return i.Hn(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){!function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Sy}).createIndex("sequenceNumberIndex",Cy,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Iy}).createIndex("documentKeyIndex",Ty,{unique:!1})}(e)}))),o}},{key:"Qn",value:function(e){var t=0;return e.store("remoteDocuments").Wt((function(e,n){t+=Vm(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"Kn",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.qt().next((function(n){return Vy.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.qt("userMutationsIndex",i).next((function(r){return Vy.forEach(r,(function(r){kf(r.userId===n.userId);var i=am(t.M,r);return Fm(e,n.userId,i).next((function(){}))}))}))}))}))}},{key:"jn",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.Wt((function(n,i){var a=new Wf(n),o=function(e){return[0,ly(e)]}(a);r.push(t.get(o).next((function(n){return n?Vy.resolve():function(n){return t.put({targetId:0,path:ly(n),sequenceNumber:e.highestListenSequenceNumber})}(a)})))})).next((function(){return Vy.waitFor(r)}))}))}},{key:"Wn",value:function(e,t){e.createObjectStore("collectionParents",{keyPath:Ey});var n=t.store("collectionParents"),r=new Tm,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:ly(i)})}};return t.store("remoteDocuments").Wt({jt:!0},(function(e,t){var n=new Wf(e);return i(n.popLast())})).next((function(){return t.store("documentMutations").Wt({jt:!0},(function(e,t){var n=u(e,3),r=(n[0],n[1]),a=(n[2],dy(r));return i(a.popLast())}))}))}},{key:"zn",value:function(e){var t=this,n=e.store("targets");return n.Wt((function(e,r){var i=om(r),a=um(t.M,i);return n.put(a)}))}},{key:"Hn",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.Wt((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new ud(Wf.fromString(i.document.name).popFirst(5)):i.noDocument?ud.fromSegments(i.noDocument.path):i.unknownDocument?ud.fromSegments(i.unknownDocument.path):gf()).path.toArray(),u={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(u))})).next((function(){return Vy.waitFor(r)}))}}]),e}();function fg(e){e.createObjectStore("targetDocuments",{keyPath:by}).createIndex("documentTargetsIndex",xy,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",wy,{unique:!0}),e.createObjectStore("targetGlobal")}var dg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",vg=function(){function e(t,n,r,i,a,o,u,s,c,l){var h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:13;if(me(this,e),this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Jn=a,this.window=o,this.document=u,this.Yn=c,this.Xn=l,this.Zn=h,this.ts=null,this.es=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ns=null,this.inForeground=!1,this.ss=null,this.rs=null,this.os=Number.NEGATIVE_INFINITY,this.us=function(e){return Promise.resolve()},!e.vt())throw new bf(wf.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new tg(this,i),this.cs=n+"main",this.M=new em(s),this.hs=new Uy(this.cs,this.Zn,new hg(this.M)),this.ls=new Km(this.referenceDelegate,this.M),this.fs=function(e){return new ig(e)}(this.M),this.ds=new hm,this.window&&this.window.localStorage?this._s=this.window.localStorage:(this._s=null,!1===l&&pf("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return ke(e,[{key:"start",value:function(){var e=this;return this.ws().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new bf(wf.FAILED_PRECONDITION,dg);return e.gs(),e.ys(),e.ps(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.ls.getHighestSequenceNumber(t)}))})).then((function(t){e.ts=new Pf(t,e.Yn)})).then((function(){e.es=!0})).catch((function(t){return e.hs&&e.hs.close(),Promise.reject(t)}))}},{key:"Is",value:function(e){var t=this;return this.us=function(){var n=ie(oe().mark((function n(r){return oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.started){n.next=2;break}return n.abrupt("return",e(r));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(e){this.hs.Ot(function(){var t=ie(oe().mark((function t(n){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===n.newVersion,!t.t0){t.next=4;break}return t.next=4,e();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"setNetworkEnabled",value:function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Jn.enqueueAndForget(ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.started,!e.t0){e.next=4;break}return e.next=4,t.ws();case 4:case"end":return e.stop()}}),e)})))))}},{key:"ws",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return yg(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){if(e.isPrimary)return e.Ts(t).next((function(t){t||(e.isPrimary=!1,e.Jn.enqueueRetryable((function(){return e.us(!1)})))}))})).next((function(){return e.Es(t)})).next((function(n){return e.isPrimary&&!n?e.As(t).next((function(){return!1})):!!n&&e.Rs(t).next((function(){return!0}))}))})).catch((function(t){if(zy(t))return vf("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return vf("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.Jn.enqueueRetryable((function(){return e.us(t)})),e.isPrimary=t}))}},{key:"Ts",value:function(e){var t=this;return pg(e).get("owner").next((function(e){return Vy.resolve(t.bs(e))}))}},{key:"Ps",value:function(e){return yg(e).delete(this.clientId)}},{key:"Vs",value:function(){var e=ie(oe().mark((function e(){var t,n,r,i,a=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrimary||this.vs(this.os,18e5)){e.next=6;break}return this.os=Date.now(),e.next=4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=Yy(e,"clientMetadata");return t.qt().next((function(e){var n=a.Ss(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return Vy.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}));case 4:if(t=e.sent,this._s){n=ye(t);try{for(n.s();!(r=n.n()).done;)i=r.value,this._s.removeItem(this.Ds(i.clientId))}catch(o){n.e(o)}finally{n.f()}}case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ps",value:function(){var e=this;this.rs=this.Jn.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.ws().then((function(){return e.Vs()})).then((function(){return e.ps()}))}))}},{key:"bs",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"Es",value:function(e){var t=this;return this.Xn?Vy.resolve(!0):pg(e).get("owner").next((function(n){if(null!==n&&t.vs(n.leaseTimestampMs,5e3)&&!t.Cs(n.ownerId)){if(t.bs(n)&&t.networkEnabled)return!0;if(!t.bs(n)){if(!n.allowTabSynchronization)throw new bf(wf.FAILED_PRECONDITION,dg);return!1}}return!(!t.networkEnabled||!t.inForeground)||yg(e).qt().next((function(e){return void 0===t.Ss(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&vf("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var e=ie(oe().mark((function e(){var t=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.es=!1,this.xs(),this.rs&&(this.rs.cancel(),this.rs=null),this.Ns(),this.ks(),e.next=7,this.hs.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new Qy(e,Pf.A);return t.As(n).next((function(){return t.Ps(n)}))}));case 7:this.hs.close(),this.Ms();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Ss",value:function(e,t){var n=this;return e.filter((function(e){return n.vs(e.updateTimeMs,t)&&!n.Cs(e.clientId)}))}},{key:"Os",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return yg(t).qt().next((function(t){return e.Ss(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.es}},{key:"getMutationQueue",value:function(e,t){return qm.Yt(e,this.M,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.ls}},{key:"getRemoteDocumentCache",value:function(){return this.fs}},{key:"getIndexManager",value:function(e){return new Dm(e)}},{key:"getDocumentOverlayCache",value:function(e){return vm.Yt(this.M,e)}},{key:"getBundleCache",value:function(){return this.ds}},{key:"runTransaction",value:function(e,t,n){var r=this;vf("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",u=14===(i=this.Zn)?Ly:13===i?Oy:12===i?Ry:11===i?Py:void gf();return this.hs.runTransaction(e,o,u,(function(i){return a=new Qy(i,r.ts?r.ts.next():Pf.A),"readwrite-primary"===t?r.Ts(a).next((function(e){return!!e||r.Es(a)})).next((function(t){if(!t)throw pf("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.Jn.enqueueRetryable((function(){return r.us(!1)})),new bf(wf.FAILED_PRECONDITION,My);return n(a)})).next((function(e){return r.Rs(a).next((function(){return e}))})):r.Fs(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Fs",value:function(e){var t=this;return pg(e).get("owner").next((function(e){if(null!==e&&t.vs(e.leaseTimestampMs,5e3)&&!t.Cs(e.ownerId)&&!t.bs(e)&&!(t.Xn||t.allowTabSynchronization&&e.allowTabSynchronization))throw new bf(wf.FAILED_PRECONDITION,dg)}))}},{key:"Rs",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return pg(e).put("owner",t)}},{key:"As",value:function(e){var t=this,n=pg(e);return n.get("owner").next((function(e){return t.bs(e)?(vf("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Vy.resolve()}))}},{key:"vs",value:function(e,t){var n=Date.now();return!(e<n-t)&&(!(e>n)||(pf("Detected an update time that is in the future: ".concat(e," > ").concat(n)),!1))}},{key:"gs",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ss=function(){e.Jn.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.ws()}))},this.document.addEventListener("visibilitychange",this.ss),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ns",value:function(){this.ss&&(this.document.removeEventListener("visibilitychange",this.ss),this.ss=null)}},{key:"ys",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ns=function(){t.xs(),Ue()&&navigator.appVersion.match(/Version\/1[45]/)&&t.Jn.enterRestrictedMode(!0),t.Jn.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("pagehide",this.ns))}},{key:"ks",value:function(){this.ns&&(this.window.removeEventListener("pagehide",this.ns),this.ns=null)}},{key:"Cs",value:function(e){var t;try{var n=null!==(null===(t=this._s)||void 0===t?void 0:t.getItem(this.Ds(e)));return vf("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return pf("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"xs",value:function(){if(this._s)try{this._s.setItem(this.Ds(this.clientId),String(Date.now()))}catch(cs){pf("Failed to set zombie client id.",cs)}}},{key:"Ms",value:function(){if(this._s)try{this._s.removeItem(this.Ds(this.clientId))}catch(cs){}}},{key:"Ds",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"vt",value:function(){return Uy.vt()}}]),e}();function pg(e){return Yy(e,"owner")}function yg(e){return Yy(e,"clientMetadata")}function mg(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var gg=function(){function e(t,n,r){me(this,e),this.fs=t,this.$s=n,this.indexManager=r}return ke(e,[{key:"Bs",value:function(e,t){var n=this;return this.$s.getAllMutationBatchesAffectingDocumentKey(e,t).next((function(r){return n.Ls(e,t,r)}))}},{key:"Ls",value:function(e,t,n){return this.fs.getEntry(e,t).next((function(e){var t,r=ye(n);try{for(r.s();!(t=r.n()).done;){t.value.applyToLocalView(e)}}catch(i){r.e(i)}finally{r.f()}return e}))}},{key:"Us",value:function(e,t){e.forEach((function(e,n){var r,i=ye(t);try{for(i.s();!(r=i.n()).done;){r.value.applyToLocalView(n)}}catch(a){i.e(a)}finally{i.f()}}))}},{key:"qs",value:function(e,t){var n=this;return this.fs.getEntries(e,t).next((function(t){return n.Gs(e,t).next((function(){return t}))}))}},{key:"Gs",value:function(e,t){var n=this;return this.$s.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){return n.Us(t,e)}))}},{key:"Ks",value:function(e,t,n){return function(e){return ud.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Qs(e,t.path):fv(t)?this.js(e,t,n):this.Ws(e,t,n)}},{key:"Qs",value:function(e,t){return this.Bs(e,new ud(t)).next((function(e){var t=yp();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"js",value:function(e,t,n){var r=this,i=t.collectionGroup,a=yp();return this.indexManager.getCollectionParents(e,i).next((function(o){return Vy.forEach(o,(function(o){var u=function(e,t){return new av(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return r.Ws(e,u,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"Ws",value:function(e,t,n){var r,i=this;return this.fs.getAllFromCollection(e,t.path,n).next((function(n){return r=n,i.$s.getAllMutationBatchesAffectingQuery(e,t)})).next((function(e){var t,n=ye(e);try{for(n.s();!(t=n.n()).done;){var i,a=t.value,o=ye(a.mutations);try{for(o.s();!(i=o.n()).done;){var u=i.value,s=u.key,c=r.get(s);null==c&&(c=Nd.newInvalidDocument(s),r=r.insert(s,c)),Wv(u,c,a.localWriteTime),c.isFoundDocument()||(r=r.remove(s))}}catch(l){o.e(l)}finally{o.f()}}}catch(l){n.e(l)}finally{n.f()}})).next((function(){return r.forEach((function(e,n){kv(t,n)||(r=r.remove(e))})),r}))}}]),e}(),kg=function(){function e(t,n,r,i){me(this,e),this.targetId=t,this.fromCache=n,this.zs=r,this.Hs=i}return ke(e,null,[{key:"Js",value:function(t,n){var r,i=_p(),a=_p(),o=ye(n.docChanges);try{for(o.s();!(r=o.n()).done;){var u=r.value;switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:a=a.add(u.doc.key)}}}catch(s){o.e(s)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),_g=function(){function e(){me(this,e)}return ke(e,[{key:"Ys",value:function(e){this.Xs=e}},{key:"Ks",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(qf.min())?this.Zs(e,t):this.Xs.qs(e,r).next((function(a){var o=i.ti(t,a);return(sv(t)||cv(t))&&i.ei(t.limitType,o,r,n)?i.Zs(e,t):(df()<=gt.DEBUG&&vf("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),gv(t)),i.Xs.Ks(e,t,Ld(n,-1)).next((function(e){return o.forEach((function(t){e=e.insert(t.key,t)})),e})))}))}},{key:"ti",value:function(e,t){var n=new lp(wv(e));return t.forEach((function(t,r){kv(e,r)&&(n=n.add(r))})),n}},{key:"ei",value:function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Zs",value:function(e,t){return df()<=gt.DEBUG&&vf("QueryEngine","Using full collection scan to execute query:",gv(t)),this.Xs.Ks(e,t,Fd.min())}}]),e}(),wg=function(){function e(t,n,r,i){me(this,e),this.persistence=t,this.ni=n,this.M=i,this.si=new up(Lf),this.ii=new op((function(e){return jd(e)}),Bd),this.ri=new Map,this.oi=t.getRemoteDocumentCache(),this.ls=t.getTargetCache(),this.ds=t.getBundleCache(),this.ui(r)}return ke(e,[{key:"ui",value:function(e){this.indexManager=this.persistence.getIndexManager(e),this.$s=this.persistence.getMutationQueue(e,this.indexManager),this.ai=new gg(this.oi,this.$s,this.indexManager),this.oi.setIndexManager(this.indexManager),this.ni.Ys(this.ai)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.si)}))}}]),e}();function bg(e,t,n,r){return new wg(e,t,n,r)}function xg(e,t){return Eg.apply(this,arguments)}function Eg(){return Eg=ie(oe().mark((function e(t,n){var r;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_f(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.$s.getAllMutationBatches(e).next((function(i){return t=i,r.ui(n),r.$s.getAllMutationBatches(e)})).next((function(n){var i,a=[],o=[],u=_p(),s=ye(t);try{for(s.s();!(i=s.n()).done;){var c=i.value;a.push(c.batchId);var l,h=ye(c.mutations);try{for(h.s();!(l=h.n()).done;){var f=l.value;u=u.add(f.key)}}catch(k){h.e(k)}finally{h.f()}}}catch(k){s.e(k)}finally{s.f()}var d,v=ye(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var y,m=ye(p.mutations);try{for(m.s();!(y=m.n()).done;){var g=y.value;u=u.add(g.key)}}catch(k){m.e(k)}finally{m.f()}}}catch(k){v.e(k)}finally{v.f()}return r.ai.qs(e,u).next((function(e){return{ci:e,removedBatchIds:a,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),Eg.apply(this,arguments)}function Sg(e,t){var n=_f(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.oi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=Vy.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);kf(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.$s.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.$s.performConsistencyCheck(e)})).next((function(){return n.ai.qs(e,r)}))}))}function Cg(e){var t=_f(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.ls.getLastRemoteSnapshotVersion(e)}))}function Ig(e,t){var n=_f(e),r=t.snapshotVersion,i=n.si;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.oi.newChangeBuffer({trackRemovals:!0});i=n.si;var o=[];t.targetChanges.forEach((function(a,u){var s=i.get(u);if(s){o.push(n.ls.removeMatchingKeys(e,a.removedDocuments,u).next((function(){return n.ls.addMatchingKeys(e,a.addedDocuments,u)})));var c=s.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(u)?c=c.withResumeToken(Qf.EMPTY_BYTE_STRING,qf.min()).withLastLimboFreeSnapshotVersion(qf.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(u,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(s,c,a)&&o.push(n.ls.updateTargetData(e,c))}}));var u=vp();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Tg(e,a,t.documentUpdates).next((function(e){u=e}))),!r.isEqual(qf.min())){var s=n.ls.getLastRemoteSnapshotVersion(e).next((function(t){return n.ls.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(s)}return Vy.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.ai.Gs(e,u)})).next((function(){return u}))})).then((function(e){return n.si=i,e}))}function Tg(e,t,n){var r=_p();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=vp();return n.forEach((function(n,i){var a=e.get(n);i.isNoDocument()&&i.version.isEqual(qf.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!a.isValidDocument()||i.version.compareTo(a.version)>0||0===i.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):vf("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",i.version)})),r}))}function Ng(e,t){var n=_f(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.$s.getNextMutationBatchAfterBatchId(e,t)}))}function Dg(e,t){var n=_f(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.ls.getTargetData(e,t).next((function(i){return i?(r=i,Vy.resolve(r)):n.ls.allocateTargetId(e).next((function(i){return r=new Zy(t,i,0,e.currentSequenceNumber),n.ls.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.si.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.si=n.si.insert(e.targetId,e),n.ii.set(t,e.targetId)),e}))}function Ag(e,t,n){return Pg.apply(this,arguments)}function Pg(){return Pg=ie(oe().mark((function e(t,n,r){var i,a,o;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=_f(t),a=i.si.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,(function(e){return i.persistence.referenceDelegate.removeTarget(e,a)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),zy(e.t1)){e.next=12;break}throw e.t1;case 12:vf("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.si=i.si.remove(n),i.ii.delete(a.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),Pg.apply(this,arguments)}function Rg(e,t,n){var r=_f(e),i=qf.min(),a=_p();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=_f(e),i=r.ii.get(n);return void 0!==i?Vy.resolve(r.si.get(i)):r.ls.getTargetData(t,n)}(r,e,vv(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.ls.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.ni.Ks(e,t,n?i:qf.min(),n?a:_p())})).next((function(e){return Mg(r,_v(t),e),{documents:e,hi:a}}))}))}function Og(e,t){var n=_f(e),r=_f(n.ls),i=n.si.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.Et(e,t).next((function(e){return e?e.target:null}))}))}function Lg(e,t){var n=_f(e),r=n.ri.get(t)||qf.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.oi.getAllFromCollectionGroup(e,t,Ld(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return Mg(n,t,e),e}))}function Mg(e,t,n){var r=qf.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.ri.set(t,r)}function Fg(e,t,n,r){return Vg.apply(this,arguments)}function Vg(){return Vg=ie(oe().mark((function e(t,n,r,i){var a,o,u,s,c,l,h,f,d,v;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=_f(t),o=_p(),u=vp(),s=ye(r);try{for(s.s();!(c=s.n()).done;)l=c.value,h=n.li(l.metadata.name),l.document&&(o=o.add(h)),(f=n.fi(l)).setReadTime(n.di(l.metadata.readTime)),u=u.insert(h,f)}catch(p){s.e(p)}finally{s.f()}return d=a.oi.newChangeBuffer({trackRemovals:!0}),e.next=7,Dg(a,function(e){return vv(uv(Wf.fromString("__bundle__/docs/".concat(e))))}(i));case 7:return v=e.sent,e.abrupt("return",a.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return Tg(e,d,u).next((function(t){return d.apply(e),t})).next((function(t){return a.ls.removeMatchingKeysForTargetId(e,v.targetId).next((function(){return a.ls.addMatchingKeys(e,o,v.targetId)})).next((function(){return a.ai.Gs(e,t)})).next((function(){return t}))}))})));case 9:case"end":return e.stop()}}),e)}))),Vg.apply(this,arguments)}function qg(e,t){return Ug.apply(this,arguments)}function Ug(){return Ug=ie(oe().mark((function e(t,n){var r,i,a,o=arguments;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:_p(),e.next=3,Dg(t,vv(sm(n.bundledQuery)));case 3:return i=e.sent,a=_f(t),e.abrupt("return",a.persistence.runTransaction("Save named query","readwrite",(function(e){var t=Vp(n.readTime);if(i.snapshotVersion.compareTo(t)>=0)return a.ds.saveNamedQuery(e,n);var o=i.withResumeToken(Qf.EMPTY_BYTE_STRING,t);return a.si=a.si.insert(o.targetId,o),a.ls.updateTargetData(e,o).next((function(){return a.ls.removeMatchingKeysForTargetId(e,i.targetId)})).next((function(){return a.ls.addMatchingKeys(e,r,i.targetId)})).next((function(){return a.ds.saveNamedQuery(e,n)}))})));case 6:case"end":return e.stop()}}),e)}))),Ug.apply(this,arguments)}var jg=function(){function e(t){me(this,e),this.M=t,this._i=new Map,this.wi=new Map}return ke(e,[{key:"getBundleMetadata",value:function(e,t){return Vy.resolve(this._i.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this._i.set(t.id,{id:(n=t).id,version:n.version,createTime:Vp(n.createTime)}),Vy.resolve()}},{key:"getNamedQuery",value:function(e,t){return Vy.resolve(this.wi.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.wi.set(t.name,function(e){return{name:e.name,query:sm(e.bundledQuery),readTime:Vp(e.readTime)}}(t)),Vy.resolve()}}]),e}(),Bg=function(){function e(){me(this,e),this.overlays=new up(ud.comparator),this.mi=new Map}return ke(e,[{key:"getOverlay",value:function(e,t){return Vy.resolve(this.overlays.get(t))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.Xt(e,t,i)})),Vy.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.mi.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.mi.delete(n)),Vy.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=mp(),i=t.length+1,a=new ud(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var u=o.getNext().value,s=u.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return Vy.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new up((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var u=i.get(o.largestBatchId);null===u&&(u=mp(),i=i.insert(o.largestBatchId,u)),u.set(o.getKey(),o)}}for(var s=mp(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return s.set(e,t)})),!(s.size()>=r)););return Vy.resolve(s)}},{key:"Xt",value:function(e,t,n){if(null!==n){var r=this.overlays.get(n.key);if(null!==r){var i=this.mi.get(r.largestBatchId).delete(n.key);this.mi.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new Jy(t,n));var a=this.mi.get(t);void 0===a&&(a=_p(),this.mi.set(t,a)),this.mi.set(t,a.add(n.key))}}}]),e}(),zg=function(){function e(){me(this,e),this.gi=new lp(Wg.yi),this.pi=new lp(Wg.Ii)}return ke(e,[{key:"isEmpty",value:function(){return this.gi.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Wg(e,t);this.gi=this.gi.add(n),this.pi=this.pi.add(n)}},{key:"Ti",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.Ei(new Wg(e,t))}},{key:"Ai",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"Ri",value:function(e){var t=this,n=new ud(new Wf([])),r=new Wg(n,e),i=new Wg(n,e+1),a=[];return this.pi.forEachInRange([r,i],(function(e){t.Ei(e),a.push(e.key)})),a}},{key:"bi",value:function(){var e=this;this.gi.forEach((function(t){return e.Ei(t)}))}},{key:"Ei",value:function(e){this.gi=this.gi.delete(e),this.pi=this.pi.delete(e)}},{key:"Pi",value:function(e){var t=new ud(new Wf([])),n=new Wg(t,e),r=new Wg(t,e+1),i=_p();return this.pi.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new Wg(e,0),n=this.gi.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Wg=function(){function e(t,n){me(this,e),this.key=t,this.Vi=n}return ke(e,null,[{key:"yi",value:function(e,t){return ud.comparator(e.key,t.key)||Lf(e.Vi,t.Vi)}},{key:"Ii",value:function(e,t){return Lf(e.Vi,t.Vi)||ud.comparator(e.key,t.key)}}]),e}(),Kg=function(){function e(t,n){me(this,e),this.indexManager=t,this.referenceDelegate=n,this.$s=[],this.vi=1,this.Si=new lp(Wg.yi)}return ke(e,[{key:"checkEmpty",value:function(e){return Vy.resolve(0===this.$s.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.vi;this.vi++,this.$s.length>0&&this.$s[this.$s.length-1];var a=new $y(i,t,n,r);this.$s.push(a);var o,u=ye(r);try{for(u.s();!(o=u.n()).done;){var s=o.value;this.Si=this.Si.add(new Wg(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast())}}catch(c){u.e(c)}finally{u.f()}return Vy.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Vy.resolve(this.Di(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.Ci(n),i=r<0?0:r;return Vy.resolve(this.$s.length>i?this.$s[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Vy.resolve(0===this.$s.length?-1:this.vi-1)}},{key:"getAllMutationBatches",value:function(e){return Vy.resolve(this.$s.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Wg(t,0),i=new Wg(t,Number.POSITIVE_INFINITY),a=[];return this.Si.forEachInRange([r,i],(function(e){var t=n.Di(e.Vi);a.push(t)})),Vy.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new lp(Lf);return t.forEach((function(e){var t=new Wg(e,0),i=new Wg(e,Number.POSITIVE_INFINITY);n.Si.forEachInRange([t,i],(function(e){r=r.add(e.Vi)}))})),Vy.resolve(this.xi(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;ud.isDocumentKey(i)||(i=i.child(""));var a=new Wg(new ud(i),0),o=new lp(Lf);return this.Si.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Vi)),!0)}),a),Vy.resolve(this.xi(o))}},{key:"xi",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.Di(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;kf(0===this.Ni(t.batchId,"removed")),this.$s.shift();var r=this.Si;return Vy.forEach(t.mutations,(function(i){var a=new Wg(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.Si=r}))}},{key:"dn",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Wg(t,0),r=this.Si.firstAfterOrEqual(n);return Vy.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.$s.length,Vy.resolve()}},{key:"Ni",value:function(e,t){return this.Ci(e)}},{key:"Ci",value:function(e){return 0===this.$s.length?0:e-this.$s[0].batchId}},{key:"Di",value:function(e){var t=this.Ci(e);return t<0||t>=this.$s.length?null:this.$s[t]}}]),e}(),Gg=function(){function e(t){me(this,e),this.ki=t,this.docs=new up(ud.comparator),this.size=0}return ke(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ki(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Vy.resolve(n?n.document.mutableCopy():Nd.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=vp();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():Nd.newInvalidDocument(e))})),Vy.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=vp(),i=new ud(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),u=o.key,s=o.value.document;if(!t.isPrefixOf(u.path))break;u.path.length>t.length+1||Vd(Md(s),n)<=0||(r=r.insert(s.key,s.mutableCopy()))}return Vy.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){gf()}},{key:"Mi",value:function(e,t){return Vy.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new Hg(this)}},{key:"getSize",value:function(e){return Vy.resolve(this.size)}}]),e}(),Hg=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this)).qn=e,r}return ke(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.qn.addEntry(e,i)):t.qn.removeEntry(r)})),Vy.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.qn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.qn.getEntries(e,t)}}]),n}(rg),Qg=function(){function e(t){me(this,e),this.persistence=t,this.Oi=new op((function(e){return jd(e)}),Bd),this.lastRemoteSnapshotVersion=qf.min(),this.highestTargetId=0,this.Fi=0,this.$i=new zg,this.targetCount=0,this.Bi=Wm.mn()}return ke(e,[{key:"forEachTarget",value:function(e,t){return this.Oi.forEach((function(e,n){return t(n)})),Vy.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Vy.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Vy.resolve(this.Fi)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Bi.next(),Vy.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Fi&&(this.Fi=t),Vy.resolve()}},{key:"In",value:function(e){this.Oi.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Bi=new Wm(t),this.highestTargetId=t),e.sequenceNumber>this.Fi&&(this.Fi=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.In(t),this.targetCount+=1,Vy.resolve()}},{key:"updateTargetData",value:function(e,t){return this.In(t),Vy.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Oi.delete(t.target),this.$i.Ri(t.targetId),this.targetCount-=1,Vy.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Oi.forEach((function(o,u){u.sequenceNumber<=t&&null===n.get(u.targetId)&&(r.Oi.delete(o),a.push(r.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),Vy.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return Vy.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Oi.get(t)||null;return Vy.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.$i.Ti(t,n),Vy.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.$i.Ai(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),Vy.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.$i.Ri(t),Vy.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.$i.Pi(t);return Vy.resolve(n)}},{key:"containsKey",value:function(e,t){return Vy.resolve(this.$i.containsKey(t))}}]),e}(),Yg=function(){function e(t,n){var r=this;me(this,e),this.Li={},this.overlays={},this.ts=new Pf(0),this.es=!1,this.es=!0,this.referenceDelegate=t(this),this.ls=new Qg(this),this.indexManager=new Im,this.fs=new Gg((function(e){return r.referenceDelegate.Ui(e)})),this.M=new em(n),this.ds=new jg(this.M)}return ke(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.es=!1,Promise.resolve()}},{key:"started",get:function(){return this.es}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new Bg,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Li[e.toKey()];return n||(n=new Kg(t,this.referenceDelegate),this.Li[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.ls}},{key:"getRemoteDocumentCache",value:function(){return this.fs}},{key:"getBundleCache",value:function(){return this.ds}},{key:"runTransaction",value:function(e,t,n){var r=this;vf("MemoryPersistence","Starting transaction:",e);var i=new $g(this.ts.next());return this.referenceDelegate.qi(),n(i).next((function(e){return r.referenceDelegate.Gi(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Ki",value:function(e,t){return Vy.or(Object.values(this.Li).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),$g=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return ke(n)}(Fy),Xg=function(){function e(t){me(this,e),this.persistence=t,this.Qi=new zg,this.ji=null}return ke(e,[{key:"zi",get:function(){if(this.ji)return this.ji;throw gf()}},{key:"addReference",value:function(e,t,n){return this.Qi.addReference(n,t),this.zi.delete(n.toString()),Vy.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Qi.removeReference(n,t),this.zi.add(n.toString()),Vy.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.zi.add(t.toString()),Vy.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Qi.Ri(t.targetId).forEach((function(e){return n.zi.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.zi.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"qi",value:function(){this.ji=new Set}},{key:"Gi",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Vy.forEach(this.zi,(function(r){var i=ud.fromPath(r);return t.Hi(e,i).next((function(e){e||n.removeEntry(i,qf.min())}))})).next((function(){return t.ji=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Hi(e,t).next((function(e){e?n.zi.delete(t.toString()):n.zi.add(t.toString())}))}},{key:"Ui",value:function(e){return 0}},{key:"Hi",value:function(e,t){var n=this;return Vy.or([function(){return Vy.resolve(n.Qi.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ki(e,t)}])}}],[{key:"Wi",value:function(t){return new e(t)}}]),e}();function Jg(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function Zg(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function ek(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var tk=function(){function e(t,n,r,i){me(this,e),this.user=t,this.batchId=n,this.state=r,this.error=i}return ke(e,[{key:"Yi",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Ji",value:function(t,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new bf(a.error.code,a.error.message))),o?new e(t,n,a.state,i):(pf("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),e}(),nk=function(){function e(t,n,r){me(this,e),this.targetId=t,this.state=n,this.error=r}return ke(e,[{key:"Yi",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Ji",value:function(t,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new bf(i.error.code,i.error.message))),a?new e(t,i.state,r):(pf("SharedClientState","Failed to parse target state for ID '".concat(t,"': ").concat(n)),null)}}]),e}(),rk=function(){function e(t,n){me(this,e),this.clientId=t,this.activeTargetIds=n}return ke(e,null,[{key:"Ji",value:function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=bp(),o=0;i&&o<r.activeTargetIds.length;++o)i=od(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new e(t,a):(pf("SharedClientState","Failed to parse client data for instance '".concat(t,"': ").concat(n)),null)}}]),e}(),ik=function(){function e(t,n){me(this,e),this.clientId=t,this.onlineState=n}return ke(e,null,[{key:"Ji",value:function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(pf("SharedClientState","Failed to parse online state: ".concat(t)),null)}}]),e}(),ak=function(){function e(){me(this,e),this.activeTargetIds=bp()}return ke(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),ok=function(){function e(t,n,r,i,a){me(this,e),this.window=t,this.Jn=n,this.persistenceKey=r,this.tr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new up(Lf),this.started=!1,this.ir=[];var o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.rr=Jg(this.persistenceKey,this.tr),this.ur=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new ak),this.ar=new RegExp("^firestore_clients_".concat(o,"_([^_]*)$")),this.cr=new RegExp("^firestore_mutations_".concat(o,"_(\\d+)(?:_(.*))?$")),this.hr=new RegExp("^firestore_targets_".concat(o,"_(\\d+)$")),this.lr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.dr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.er)}return ke(e,[{key:"start",value:function(){var e=ie(oe().mark((function e(){var t,n,r,i,a,o,u,s,c,l,h,f=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.syncEngine.Os();case 2:t=e.sent,n=ye(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}if((i=r.value)!==this.tr){e.next=10;break}return e.abrupt("continue",12);case 10:(a=this.getItem(Jg(this.persistenceKey,i)))&&(o=rk.Ji(i,a))&&(this.sr=this.sr.insert(o.clientId,o));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:this._r(),(u=this.storage.getItem(this.lr))&&(s=this.wr(u))&&this.mr(s),c=ye(this.ir);try{for(c.s();!(l=c.n()).done;)h=l.value,this.nr(h)}catch(d){c.e(d)}finally{c.f()}this.ir=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0;case 28:case"end":return e.stop()}}),e,this,[[4,16,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"writeSequenceNumber",value:function(e){this.setItem(this.ur,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.gr(this.sr)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.sr.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.yr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.yr(e,t,n),this.pr(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(ek(this.persistenceKey,e));if(n){var r=nk.Ji(e,n);r&&(t=r.state)}}return this.Ir.Xi(e),this._r(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Ir.Zi(e),this._r()}},{key:"isLocalQueryTarget",value:function(e){return this.Ir.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(ek(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.Tr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.pr(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.Er(e)}},{key:"notifyBundleLoaded",value:function(e){this.Ar(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return vf("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){vf("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){vf("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"nr",value:function(e){var t=this,n=e;if(n.storageArea===this.storage){if(vf("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void pf("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Jn.enqueueRetryable(ie(oe().mark((function e(){var r,i,a,o,u,s,c;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.started){e.next=43;break}if(null===n.key){e.next=41;break}if(!t.ar.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return r=t.Rr(n.key),e.abrupt("return",t.br(r,null));case 6:if(!(i=t.Pr(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",t.br(i.clientId,i));case 9:e.next=41;break;case 11:if(!t.cr.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(a=t.Vr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",t.vr(a));case 16:e.next=41;break;case 18:if(!t.hr.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(o=t.Sr(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",t.Dr(o));case 23:e.next=41;break;case 25:if(n.key!==t.lr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(u=t.wr(n.newValue))){e.next=30;break}return e.abrupt("return",t.mr(u));case 30:e.next=41;break;case 32:if(n.key!==t.ur){e.next=37;break}s=function(e){var t=Pf.A;if(null!=e)try{var n=JSON.parse(e);kf("number"==typeof n),t=n}catch(e){pf("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue),s!==Pf.A&&t.sequenceNumberHandler(s),e.next=41;break;case 37:if(n.key!==t.dr){e.next=41;break}return c=t.Cr(n.newValue),e.next=41,Promise.all(c.map((function(e){return t.syncEngine.Nr(e)})));case 41:e.next=44;break;case 43:t.ir.push(n);case 44:case"end":return e.stop()}}),e)}))))}}},{key:"Ir",get:function(){return this.sr.get(this.tr)}},{key:"_r",value:function(){this.setItem(this.rr,this.Ir.Yi())}},{key:"yr",value:function(e,t,n){var r=new tk(this.currentUser,e,t,n),i=Zg(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Yi())}},{key:"pr",value:function(e){var t=Zg(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"Er",value:function(e){var t={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(t))}},{key:"Tr",value:function(e,t,n){var r=ek(this.persistenceKey,e),i=new nk(e,t,n);this.setItem(r,i.Yi())}},{key:"Ar",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}},{key:"Rr",value:function(e){var t=this.ar.exec(e);return t?t[1]:null}},{key:"Pr",value:function(e,t){var n=this.Rr(e);return rk.Ji(n,t)}},{key:"Vr",value:function(e,t){var n=this.cr.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return tk.Ji(new lf(i),r,t)}},{key:"Sr",value:function(e,t){var n=this.hr.exec(e),r=Number(n[1]);return nk.Ji(r,t)}},{key:"wr",value:function(e){return ik.Ji(e)}},{key:"Cr",value:function(e){return JSON.parse(e)}},{key:"vr",value:function(){var e=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==this.currentUser.uid){e.next=2;break}return e.abrupt("return",this.syncEngine.kr(t.batchId,t.state,t.error));case 2:vf("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Dr",value:function(e){return this.syncEngine.Mr(e.targetId,e.state,e.error)}},{key:"br",value:function(e,t){var n=this,r=t?this.sr.insert(e,t):this.sr.remove(e),i=this.gr(this.sr),a=this.gr(r),o=[],u=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||u.push(e)})),this.syncEngine.Or(o,u).then((function(){n.sr=r}))}},{key:"mr",value:function(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"gr",value:function(e){var t=bp();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"vt",value:function(e){return!(!e||!e.localStorage)}}]),e}(),uk=function(){function e(){me(this,e),this.Fr=new ak,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return ke(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new ak,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),sk=function(){function e(){me(this,e)}return ke(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),ck=function(){function e(){var t=this;me(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Gr()},this.Kr=[],this.Qr()}return ke(e,[{key:"Br",value:function(e){this.Kr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){vf("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=ye(this.Kr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Gr",value:function(){vf("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=ye(this.Kr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"vt",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),lk={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},hk=function(){function e(t){me(this,e),this.jr=t.jr,this.Wr=t.Wr}return ke(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),fk=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return ke(n,[{key:"ao",value:function(e,t,n,r){return new Promise((function(i,a){var o=new sf;o.listenOnce(nf.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case tf.NO_ERROR:var t=o.getResponseJson();vf("Connection","XHR received:",JSON.stringify(t)),i(t);break;case tf.TIMEOUT:vf("Connection",'RPC "'+e+'" timed out'),a(new bf(wf.DEADLINE_EXCEEDED,"Request time out"));break;case tf.HTTP_ERROR:var n=o.getStatus();if(vf("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var u=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(wf).indexOf(t)>=0?t:wf.UNKNOWN}(r.status);a(new bf(u,r.message))}else a(new bf(wf.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new bf(wf.UNAVAILABLE,"Connection failed."));break;default:gf()}}finally{vf("Connection",'RPC "'+e+'" completed.')}}));var u=JSON.stringify(r);o.send(t,"POST",u,n,15)}))}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Zh(),a=ef(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new of({})),this.uo(o.initMessageHeaders,t,n),Fe()||Ve()||Me().indexOf("Electron/")>=0||function(){var e=Me();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||Me().indexOf("MSAppHost/")>=0||function(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||(o.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");vf("Connection","Creating WebChannel: "+u,o);var s=i.createWebChannel(u,o),c=!1,l=!1,h=new hk({jr:function(e){l?vf("Connection","Not sending because WebChannel is closed:",e):(c||(vf("Connection","Opening WebChannel transport."),s.open(),c=!0),vf("Connection","WebChannel sending:",e),s.send(e))},Wr:function(){return s.close()}}),f=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return f(s,uf.EventType.OPEN,(function(){l||vf("Connection","WebChannel transport opened.")})),f(s,uf.EventType.CLOSE,(function(){l||(l=!0,vf("Connection","WebChannel transport closed"),h.eo())})),f(s,uf.EventType.ERROR,(function(e){l||(l=!0,yf("Connection","WebChannel transport errored:",e),h.eo(new bf(wf.UNAVAILABLE,"The operation could not be completed")))})),f(s,uf.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];kf(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){vf("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=Zv[e];if(void 0!==t)return ap(t)}(a),u=i.message;void 0===o&&(o=wf.INTERNAL,u="Unknown error status: "+a+" with message "+i.message),l=!0,h.eo(new bf(o,u)),s.close()}else vf("Connection","WebChannel received:",n),h.no(n)}})),f(a,rf.STAT_EVENT,(function(e){e.stat===af.PROXY?vf("Connection","Detected buffering proxy"):e.stat===af.NOPROXY&&vf("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Zr()}),0),h}}]),n}(function(){function e(t){me(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.so=n+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return ke(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);vf("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.ao(e,a,o,n).then((function(e){return vf("RestConnection","Received: ",e),e}),(function(t){throw yf("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t}))}},{key:"co",value:function(e,t,n,r,i){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+hf,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"oo",value:function(e,t){var n=lk[e];return"".concat(this.so,"/v1/").concat(t,":").concat(n)}}]),e}());function dk(){return"undefined"!=typeof window?window:null}function vk(){return"undefined"!=typeof document?document:null}function pk(e){return new Op(e,!0)}var yk=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;me(this,e),this.Jn=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return ke(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&vf("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.Jn.enqueueAfterDelay(this.timerId,i,(function(){return t.yo=Date.now(),e()})),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),mk=function(){function e(t,n,r,i,a,o,u,s){me(this,e),this.Jn=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=s,this.state=0,this.Po=0,this.Vo=null,this.vo=null,this.stream=null,this.So=new yk(t,n)}return ke(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.Do(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.Vo&&(this.Vo=this.Jn.enqueueAfterDelay(this.Ao,6e4,(function(){return e.Mo()})))}},{key:"Oo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Mo",value:function(){var e=ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Co()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Fo",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"$o",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"close",value:function(){var e=ie(oe().mark((function e(t,n){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Fo(),this.$o(),this.So.cancel(),this.Po++,4!==t?this.So.reset():n&&n.code===wf.RESOURCE_EXHAUSTED?(pf(n.toString()),pf("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===wf.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Bo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.Jr(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=u(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)}),(function(n){t((function(){var t=new bf(wf.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)}))}))}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Go(e,t),this.stream.zr((function(){r((function(){return n.state=2,n.vo=n.Jn.enqueueAfterDelay(n.Ro,1e4,(function(){return n.Co()&&(n.state=3),Promise.resolve()})),n.listener.zr()}))})),this.stream.Jr((function(e){r((function(){return n.qo(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(ie(oe().mark((function t(){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"qo",value:function(e){return vf("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.Jn.enqueueAndForget((function(){return t.Po===e?n():(vf("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),gk=function(e){ce(n,e);var t=ve(n);function n(e,r,i,a,o,u){var s;return me(this,n),(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,u)).M=o,s}return ke(n,[{key:"Go",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:gf()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.N?(kf(void 0===t||"string"==typeof t),Qf.fromBase64String(t||"")):(kf(void 0===t||t instanceof Uint8Array),Qf.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(e){var t=void 0===e.code?wf.UNKNOWN:ap(e.code);return new bf(t,e.message||"")}(o);n=new Ip(r,i,a,u||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var c=Bp(e,s.document.name),l=Vp(s.document.updateTime),h=new Id({mapValue:{fields:s.document.fields}}),f=Nd.newFoundDocument(c,l,h),d=s.targetIds||[],v=s.removedTargetIds||[];n=new Sp(d,v,f.key,f)}else if("documentDelete"in t){t.documentDelete;var p=t.documentDelete;p.document;var y=Bp(e,p.document),m=p.readTime?Vp(p.readTime):qf.min(),g=Nd.newNoDocument(y,m),k=p.removedTargetIds||[];n=new Sp([],k,g.key,g)}else if("documentRemove"in t){t.documentRemove;var _=t.documentRemove;_.document;var w=Bp(e,_.document),b=_.removedTargetIds||[];n=new Sp([],b,w,null)}else{if(!("filter"in t))return gf();t.filter;var x=t.filter;x.targetId;var E=x.count||0,S=new rp(E),C=x.targetId;n=new Cp(C,S)}return n}(this.M,e),n=function(e){if(!("targetChange"in e))return qf.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?qf.min():t.readTime?Vp(t.readTime):qf.min()}(e);return this.listener.Ko(t,n)}},{key:"Qo",value:function(e){var t={};t.database=Kp(this.M),t.addTarget=function(e,t){var n,r=t.target;return(n=zd(r)?{documents:Jp(e,r)}:{query:Zp(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=Mp(e,t.resumeToken):t.snapshotVersion.compareTo(qf.min())>0&&(n.readTime=Lp(e,t.snapshotVersion.toTimestamp())),n}(this.M,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return gf()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.M,e);n&&(t.labels=n),this.Oo(t)}},{key:"jo",value:function(e){var t={};t.database=Kp(this.M),t.removeTarget=e,this.Oo(t)}}]),n}(mk),kk=function(e){ce(n,e);var t=ve(n);function n(e,r,i,a,o,u){var s;return me(this,n),(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,u)).M=o,s.Wo=!1,s}return ke(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,Qu(le(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Go",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(kf(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(kf(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?Vp(e.updateTime):Vp(t);return n.isEqual(qf.min())&&(n=Vp(t)),new qv(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=Vp(e.commitTime);return this.listener.Jo(n,t)}return kf(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=Kp(this.M),this.Oo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return $p(t.M,e)}))};this.Oo(n)}}]),n}(mk),_k=function(e){ce(n,e);var t=ve(n);function n(e,r,i,a){var o;return me(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.M=a,o.Zo=!1,o}return ke(n,[{key:"tu",value:function(){if(this.Zo)throw new bf(wf.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var a=u(i,2),o=a[0],s=a[1];return r.bo.ro(e,t,n,o,s)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===wf.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new bf(wf.UNKNOWN,e.toString())}))}},{key:"co",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var a=u(i,2),o=a[0],s=a[1];return r.bo.co(e,t,n,o,s)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===wf.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new bf(wf.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return ke((function e(){me(this,e)}))}()),wk=function(){function e(t,n){me(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return ke(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()})))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.au(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.au(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(pf(t),this.su=!1):vf("OnlineStateTracker",t)}},{key:"au",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),bk=ke((function e(t,n,r,i,a){var o=this;me(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.cu=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br((function(e){r.enqueueAndForget(ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Rk(o),!e.t0){e.next=5;break}return vf("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=ie(oe().mark((function e(t){var n;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=_f(t)).lu.add(4),e.next=4,Sk(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,xk(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}}),e)}))))})),this._u=new wk(r,i)}));function xk(e){return Ek.apply(this,arguments)}function Ek(){return Ek=ie(oe().mark((function e(t){var n,r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Rk(t)){e.next=18;break}n=ye(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])}))),Ek.apply(this,arguments)}function Sk(e){return Ck.apply(this,arguments)}function Ck(){return Ck=ie(oe().mark((function e(t){var n,r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=ye(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))),Ck.apply(this,arguments)}function Ik(e,t){var n=_f(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),Pk(n)?Ak(n):s_(n).Co()&&Nk(n,t))}function Tk(e,t){var n=_f(e),r=s_(n);n.hu.delete(t),r.Co()&&Dk(n,t),0===n.hu.size&&(r.Co()?r.ko():Rk(n)&&n._u.set("Unknown"))}function Nk(e,t){e.wu.Z(t.targetId),s_(e).Qo(t)}function Dk(e,t){e.wu.Z(t),s_(e).jo(t)}function Ak(e){e.wu=new Np({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},Et:function(t){return e.hu.get(t)||null}}),s_(e).start(),e._u.iu()}function Pk(e){return Rk(e)&&!s_(e).Do()&&e.hu.size>0}function Rk(e){return 0===_f(e).lu.size}function Ok(e){e.wu=void 0}function Lk(e){return Mk.apply(this,arguments)}function Mk(){return Mk=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach((function(e,n){Nk(t,e)}));case 1:case"end":return e.stop()}}),e)}))),Mk.apply(this,arguments)}function Fk(e,t){return Vk.apply(this,arguments)}function Vk(){return Vk=ie(oe().mark((function e(t,n){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ok(t),Pk(t)?(t._u.uu(n),Ak(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}}),e)}))),Vk.apply(this,arguments)}function qk(e,t,n){return Uk.apply(this,arguments)}function Uk(){return Uk=ie(oe().mark((function e(t,n,r){var i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof Ip&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=ie(oe().mark((function e(t,n){var r,i,a,o;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=ye(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),vf("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,jk(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof Sp?t.wu.ut(n):n instanceof Cp?t.wu._t(n):t.wu.ht(n),r.isEqual(qf.min())){e.next=29;break}return e.prev=14,e.next=17,Cg(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.yt(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(Qf.EMPTY_BYTE_STRING,n.snapshotVersion)),Dk(e,t);var r=new Zy(n.target,t,1,n.sequenceNumber);Nk(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),vf("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,jk(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),Uk.apply(this,arguments)}function jk(e,t,n){return Bk.apply(this,arguments)}function Bk(){return Bk=ie(oe().mark((function e(t,n,r){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zy(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,Sk(t);case 5:t._u.set("Offline"),r||(r=function(){return Cg(t.localStore)}),t.asyncQueue.enqueueRetryable(ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vf("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,xk(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)}))),Bk.apply(this,arguments)}function zk(e,t){return t().catch((function(n){return jk(e,n,t)}))}function Wk(e){return Kk.apply(this,arguments)}function Kk(){return Kk=ie(oe().mark((function e(t){var n,r,i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=_f(t),r=c_(n),i=n.cu.length>0?n.cu[n.cu.length-1].batchId:-1;case 2:if(!Gk(n)){e.next=19;break}return e.prev=3,e.next=6,Ng(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.cu.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,Hk(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,jk(n,e.t0);case 17:e.next=2;break;case 19:Qk(n)&&Yk(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])}))),Kk.apply(this,arguments)}function Gk(e){return Rk(e)&&e.cu.length<10}function Hk(e,t){e.cu.push(t);var n=c_(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function Qk(e){return Rk(e)&&!c_(e).Do()&&e.cu.length>0}function Yk(e){c_(e).start()}function $k(e){return Xk.apply(this,arguments)}function Xk(){return Xk=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c_(t).Xo();case 1:case"end":return e.stop()}}),e)}))),Xk.apply(this,arguments)}function Jk(e){return Zk.apply(this,arguments)}function Zk(){return Zk=ie(oe().mark((function e(t){var n,r,i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c_(t),r=ye(t.cu);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)}))),Zk.apply(this,arguments)}function e_(e,t,n){return t_.apply(this,arguments)}function t_(){return t_=ie(oe().mark((function e(t,n,r){var i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.cu.shift(),a=Xy.from(i,n,r),e.next=3,zk(t,(function(){return t.remoteSyncer.applySuccessfulWrite(a)}));case 3:return e.next=5,Wk(t);case 5:case"end":return e.stop()}}),e)}))),t_.apply(this,arguments)}function n_(e,t){return r_.apply(this,arguments)}function r_(){return r_=ie(oe().mark((function e(t,n){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&c_(t).zo,!e.t0){e.next=4;break}return e.next=4,function(){var e=ie(oe().mark((function e(t,n){var r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ip(i=n.code)||i===wf.ABORTED){e.next=7;break}return r=t.cu.shift(),c_(t).No(),e.next=5,zk(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,Wk(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:Qk(t)&&Yk(t);case 5:case"end":return e.stop()}}),e)}))),r_.apply(this,arguments)}function i_(e,t){return a_.apply(this,arguments)}function a_(){return a_=ie(oe().mark((function e(t,n){var r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=_f(t)).asyncQueue.verifyOperationInProgress(),vf("RemoteStore","RemoteStore received new credentials"),i=Rk(r),r.lu.add(3),e.next=6,Sk(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,xk(r);case 12:case"end":return e.stop()}}),e)}))),a_.apply(this,arguments)}function o_(e,t){return u_.apply(this,arguments)}function u_(){return u_=ie(oe().mark((function e(t,n){var r;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_f(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,xk(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,Sk(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}}),e)}))),u_.apply(this,arguments)}function s_(e){return e.mu||(e.mu=function(e,t,n){var r=_f(e);return r.tu(),new gk(t,r.bo,r.authCredentials,r.appCheckCredentials,r.M,n)}(e.datastore,e.asyncQueue,{zr:Lk.bind(null,e),Jr:Fk.bind(null,e),Ko:qk.bind(null,e)}),e.fu.push(function(){var t=ie(oe().mark((function t(n){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),Pk(e)?Ak(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:Ok(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.mu}function c_(e){return e.gu||(e.gu=function(e,t,n){var r=_f(e);return r.tu(),new kk(t,r.bo,r.authCredentials,r.appCheckCredentials,r.M,n)}(e.datastore,e.asyncQueue,{zr:$k.bind(null,e),Jr:n_.bind(null,e),Yo:Jk.bind(null,e),Jo:e_.bind(null,e)}),e.fu.push(function(){var t=ie(oe().mark((function t(n){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,Wk(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.cu.length>0&&(vf("RemoteStore","Stopping write stream with ".concat(e.cu.length," pending writes")),e.cu=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.gu}var l_=function(){function e(t,n,r,i,a){me(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new xf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return ke(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new bf(wf.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function h_(e,t){if(pf("AsyncQueue","".concat(t,": ").concat(e)),zy(e))return new bf(wf.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var f_=function(){function e(t){me(this,e),this.comparator=t?function(e,n){return t(e,n)||ud.comparator(e.key,n.key)}:function(e,t){return ud.comparator(e.key,t.key)},this.keyedMap=yp(),this.sortedSet=new up(this.comparator)}return ke(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),d_=function(){function e(){me(this,e),this.yu=new up(ud.comparator)}return ke(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):gf():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),v_=function(){function e(t,n,r,i,a,o,u,s){me(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=s}return ke(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yv(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach((function(e){a.push({type:0,doc:e})})),new e(t,n,f_.emptySet(n),a,r,i,!0,!1)}}]),e}(),p_=ke((function e(){me(this,e),this.Iu=void 0,this.listeners=[]})),y_=ke((function e(){me(this,e),this.queries=new op((function(e){return mv(e)}),yv),this.onlineState="Unknown",this.Tu=new Set}));function m_(e,t){return g_.apply(this,arguments)}function g_(){return g_=ie(oe().mark((function e(t,n){var r,i,a,o,u;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_f(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new p_),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),u=h_(e.t0,"Initialization of query '".concat(gv(n.query),"' failed")),e.abrupt("return",void n.onError(u));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&x_(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),g_.apply(this,arguments)}function k_(e,t){return __.apply(this,arguments)}function __(){return __=ie(oe().mark((function e(t,n){var r,i,a,o,u;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_f(t),i=n.query,a=!1,(o=r.queries.get(i))&&(u=o.listeners.indexOf(n))>=0&&(o.listeners.splice(u,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}}),e)}))),__.apply(this,arguments)}function w_(e,t){var n,r=_f(e),i=!1,a=ye(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,u=o.query,s=r.queries.get(u);if(s){var c,l=ye(s.listeners);try{for(l.s();!(c=l.n()).done;){c.value.Au(o)&&(i=!0)}}catch(h){l.e(h)}finally{l.f()}s.Iu=o}}}catch(h){a.e(h)}finally{a.f()}i&&x_(r)}function b_(e,t,n){var r=_f(e),i=r.queries.get(t);if(i){var a,o=ye(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(u){o.e(u)}finally{o.f()}}r.queries.delete(t)}function x_(e){e.Tu.forEach((function(e){e.next()}))}var E_=function(){function e(t,n,r){me(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return ke(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=ye(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new v_(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.Vu(e)&&(this.Ru.next(e),a=!0):this.vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"vu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Du||!n)&&(!e.docs.isEmpty()||"Offline"===t)}},{key:"Vu",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=v_.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),S_=function(){function e(t,n){me(this,e),this.payload=t,this.byteLength=n}return ke(e,[{key:"Cu",value:function(){return"metadata"in this.payload}}]),e}(),C_=function(){function e(t){me(this,e),this.M=t}return ke(e,[{key:"li",value:function(e){return Bp(this.M,e)}},{key:"fi",value:function(e){return e.metadata.exists?Qp(this.M,e.document,!1):Nd.newNoDocument(this.li(e.metadata.name),this.di(e.metadata.readTime))}},{key:"di",value:function(e){return Vp(e)}}]),e}(),I_=function(){function e(t,n,r){me(this,e),this.xu=t,this.localStore=n,this.M=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=T_(t)}return ke(e,[{key:"Nu",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;var n=Wf.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"ku",value:function(e){var t,n=new Map,r=new C_(this.M),i=ye(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.metadata.queries){var o,u=r.li(a.metadata.name),s=ye(a.metadata.queries);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=(n.get(c)||_p()).add(u);n.set(c,l)}}catch(h){s.e(h)}finally{s.f()}}}}catch(h){i.e(h)}finally{i.f()}return n}},{key:"complete",value:function(){var e=ie(oe().mark((function e(){var t,n,r,i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fg(this.localStore,new C_(this.M),this.documents,this.xu.id);case 2:t=e.sent,n=this.ku(this.documents),r=ye(this.queries),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=13;break}return a=i.value,e.next=11,qg(this.localStore,a,n.get(a.name));case 11:e.next=7;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",(this.progress.taskState="Success",{progress:this.progress,Mu:this.collectionGroups,Ou:t}));case 22:case"end":return e.stop()}}),e,this,[[5,15,18,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}();function T_(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var N_=ke((function e(t){me(this,e),this.key=t})),D_=ke((function e(t){me(this,e),this.key=t})),A_=function(){function e(t,n){me(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=_p(),this.mutatedKeys=_p(),this.Lu=wv(t),this.Uu=new f_(this.Lu)}return ke(e,[{key:"qu",get:function(){return this.Fu}},{key:"Gu",value:function(e,t){var n=this,r=t?t.Ku:new d_,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,s=sv(this.query)&&i.size===this.query.limit?i.last():null,c=cv(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=kv(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Qu(l,h)||(r.track({type:2,doc:h}),v=!0,(s&&n.Lu(h,s)>0||c&&n.Lu(h,c)<0)&&(u=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(s||c)&&(u=!0)),v&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),sv(this.query)||cv(this.query))for(;o.size>this.query.limit;){var l=sv(this.query)?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Ku:r,ei:u,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Ku.pu();a.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return gf()}};return n(e)-n(t)}(e.type,t.type)||r.Lu(e.doc,t.doc)})),this.ju(n);var o=t?this.Wu():[],u=0===this.Bu.size&&this.current?1:0,s=u!==this.$u;return this.$u=u,0!==a.length||s?{snapshot:new v_(this.query,e.Uu,i,a,e.mutatedKeys,0===u,s,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Ku:new d_,mutatedKeys:this.mutatedKeys,ei:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Fu=t.Fu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Fu=t.Fu.delete(e)})),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=_p(),this.Uu.forEach((function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))}));var n=[];return t.forEach((function(t){e.Bu.has(t)||n.push(new D_(t))})),this.Bu.forEach((function(e){t.has(e)||n.push(new N_(e))})),n}},{key:"Ju",value:function(e){this.Fu=e.hi,this.Bu=_p();var t=this.Gu(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return v_.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),P_=ke((function e(t,n,r){me(this,e),this.query=t,this.targetId=n,this.view=r})),R_=ke((function e(t){me(this,e),this.key=t,this.Xu=!1})),O_=function(){function e(t,n,r,i,a,o){me(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.ta=new op((function(e){return mv(e)}),yv),this.ea=new Map,this.na=new Set,this.sa=new up(ud.comparator),this.ia=new Map,this.ra=new zg,this.oa={},this.ua=new Map,this.aa=Wm.gn(),this.onlineState="Unknown",this.ca=void 0}return ke(e,[{key:"isPrimaryClient",get:function(){return!0===this.ca}}]),e}();function L_(e,t){return M_.apply(this,arguments)}function M_(){return M_=ie(oe().mark((function e(t,n){var r,i,a,o,u,s;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Tw(t),!(o=r.ta.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,Dg(r.localStore,vv(n));case 8:return u=e.sent,r.isPrimaryClient&&Ik(r.remoteStore,u),s=r.sharedClientState.addLocalQueryTarget(u.targetId),i=u.targetId,e.next=14,F_(r,n,i,"current"===s);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e)}))),M_.apply(this,arguments)}function F_(e,t,n,r){return V_.apply(this,arguments)}function V_(){return V_=ie(oe().mark((function e(t,n,r,i){var a,o,u,s,c,l;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.ha=function(e,n,r){return function(){var e=ie(oe().mark((function e(t,n,r,i){var a,o,u;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Gu(r),e.t0=a.ei,!e.t0){e.next=6;break}return e.next=5,Rg(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.Gu(t,a)}));case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),u=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(iw(t,n.targetId,u.zu),u.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,Rg(t.localStore,n,!0);case 3:return a=e.sent,o=new A_(n,a.hi),u=o.Gu(a.documents),s=Ep.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(u,t.isPrimaryClient,s),iw(t,r,c.zu),l=new P_(n,r,o),e.abrupt("return",(t.ta.set(n,l),t.ea.has(r)?t.ea.get(r).push(n):t.ea.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}}),e)}))),V_.apply(this,arguments)}function q_(e,t){return U_.apply(this,arguments)}function U_(){return U_=ie(oe().mark((function e(t,n){var r,i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_f(t),i=r.ta.get(n),!((a=r.ea.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ea.set(i.targetId,a.filter((function(e){return!yv(e,n)}))),void r.ta.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,Ag(r.localStore,i.targetId,!1).then((function(){r.sharedClientState.clearQueryState(i.targetId),Tk(r.remoteStore,i.targetId),nw(r,i.targetId)})).catch(Ym);case 9:e.next=14;break;case 11:return nw(r,i.targetId),e.next=14,Ag(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}}),e)}))),U_.apply(this,arguments)}function j_(e,t,n){return B_.apply(this,arguments)}function B_(){return B_=ie(oe().mark((function e(t,n,r){var i,a,o;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Nw(t),e.prev=1,e.next=4,function(e,t){var n,r=_f(e),i=Vf.now(),a=t.reduce((function(e,t){return e.add(t.key)}),_p());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(e){return r.ai.qs(e,a).next((function(a){n=a;var o,u=[],s=ye(t);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=Kv(c,n.get(c.key));null!=l&&u.push(new Yv(c.key,l,Td(l.value.mapValue),Uv.exists(!0)))}}catch(h){s.e(h)}finally{s.f()}return r.$s.addMutationBatch(e,i,u,t)}))})).then((function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}}))}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.oa[e.currentUser.toKey()];r||(r=new up(Lf)),r=r.insert(t,n),e.oa[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,uw(i,a.changes);case 9:return e.next=11,Wk(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=h_(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),B_.apply(this,arguments)}function z_(e,t){return W_.apply(this,arguments)}function W_(){return W_=ie(oe().mark((function e(t,n){var r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_f(t),e.prev=1,e.next=4,Ig(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach((function(e,t){var n=r.ia.get(t);n&&(kf(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?kf(n.Xu):e.removedDocuments.size>0&&(kf(n.Xu),n.Xu=!1))})),e.next=8,uw(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Ym(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),W_.apply(this,arguments)}function K_(e,t,n){var r=_f(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ta.forEach((function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=_f(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i,a=ye(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}})),r&&x_(n)}(r.eventManager,t),i.length&&r.Zu.Ko(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function G_(e,t,n){return H_.apply(this,arguments)}function H_(){return H_=ie(oe().mark((function e(t,n,r){var i,a,o,u,s,c;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=_f(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ia.get(n),!(o=a&&a.key)){e.next=14;break}return u=(u=new up(ud.comparator)).insert(o,Nd.newNoDocument(o,qf.min())),s=_p().add(o),c=new xp(qf.min(),new Map,new lp(Lf),u,s),e.next=9,z_(i,c);case 9:i.sa=i.sa.remove(o),i.ia.delete(n),ow(i),e.next=16;break;case 14:return e.next=16,Ag(i.localStore,n,!1).then((function(){return nw(i,n,r)})).catch(Ym);case 16:case"end":return e.stop()}}),e)}))),H_.apply(this,arguments)}function Q_(e,t){return Y_.apply(this,arguments)}function Y_(){return Y_=ie(oe().mark((function e(t,n){var r,i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_f(t),i=n.batch.batchId,e.prev=1,e.next=4,Sg(r.localStore,n);case 4:return a=e.sent,tw(r,i,null),ew(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,uw(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Ym(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),Y_.apply(this,arguments)}function $_(e,t,n){return X_.apply(this,arguments)}function X_(){return X_=ie(oe().mark((function e(t,n,r){var i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=_f(t),e.prev=1,e.next=4,function(e,t){var n=_f(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.$s.lookupMutationBatch(e,t).next((function(t){return kf(null!==t),r=t.keys(),n.$s.removeMutationBatch(e,t)})).next((function(){return n.$s.performConsistencyCheck(e)})).next((function(){return n.ai.qs(e,r)}))}))}(i.localStore,n);case 4:return a=e.sent,tw(i,n,r),ew(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,uw(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Ym(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),X_.apply(this,arguments)}function J_(e,t){return Z_.apply(this,arguments)}function Z_(){return Z_=ie(oe().mark((function e(t,n){var r,i,a,o;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Rk((r=_f(t)).remoteStore)||vf("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=_f(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.$s.getHighestUnacknowledgedBatchId(e)}))}(r.localStore);case 5:if(-1!==(i=e.sent)){e.next=8;break}return e.abrupt("return",void n.resolve());case 8:(a=r.ua.get(i)||[]).push(n),r.ua.set(i,a),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),o=h_(e.t0,"Initialization of waitForPendingWrites() operation failed"),n.reject(o);case 16:case"end":return e.stop()}}),e,null,[[2,12]])}))),Z_.apply(this,arguments)}function ew(e,t){(e.ua.get(t)||[]).forEach((function(e){e.resolve()})),e.ua.delete(t)}function tw(e,t,n){var r=_f(e),i=r.oa[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oa[r.currentUser.toKey()]=i}}function nw(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=ye(e.ea.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.ta.delete(a),n&&e.Zu.la(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ea.delete(t),e.isPrimaryClient&&e.ra.Ri(t).forEach((function(t){e.ra.containsKey(t)||rw(e,t)}))}function rw(e,t){e.na.delete(t.path.canonicalString());var n=e.sa.get(t);null!==n&&(Tk(e.remoteStore,n),e.sa=e.sa.remove(t),e.ia.delete(n),ow(e))}function iw(e,t,n){var r,i=ye(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof N_?(e.ra.addReference(a.key,t),aw(e,a)):a instanceof D_?(vf("SyncEngine","Document no longer in limbo: "+a.key),e.ra.removeReference(a.key,t),e.ra.containsKey(a.key)||rw(e,a.key)):gf()}}catch(o){i.e(o)}finally{i.f()}}function aw(e,t){var n=t.key,r=n.path.canonicalString();e.sa.get(n)||e.na.has(r)||(vf("SyncEngine","New document in limbo: "+n),e.na.add(r),ow(e))}function ow(e){for(;e.na.size>0&&e.sa.size<e.maxConcurrentLimboResolutions;){var t=e.na.values().next().value;e.na.delete(t);var n=new ud(Wf.fromString(t)),r=e.aa.next();e.ia.set(r,new R_(n)),e.sa=e.sa.insert(n,r),Ik(e.remoteStore,new Zy(vv(uv(n.path)),r,2,Pf.A))}}function uw(e,t,n){return sw.apply(this,arguments)}function sw(){return sw=ie(oe().mark((function e(t,n,r){var i,a,o,u;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=_f(t),a=[],o=[],u=[],e.t0=i.ta.isEmpty(),e.t0){e.next=9;break}return i.ta.forEach((function(e,t){u.push(i.ha(t,n,r).then((function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=kg.Js(t.targetId,e);o.push(n)}})))})),e.next=6,Promise.all(u);case 6:return i.Zu.Ko(a),e.next=9,function(){var e=ie(oe().mark((function e(t,n){var r,i,a,o,u,s,c,l;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_f(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Vy.forEach(n,(function(t){return Vy.forEach(t.zs,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return Vy.forEach(t.Hs,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),zy(e.t0)){e.next=10;break}throw e.t0;case 10:vf("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=ye(n);try{for(i.s();!(a=i.n()).done;)o=a.value,u=o.targetId,o.fromCache||(s=r.si.get(u),c=s.snapshotVersion,l=s.withLastLimboFreeSnapshotVersion(c),r.si=r.si.insert(u,l))}catch(h){i.e(h)}finally{i.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(i.localStore,o);case 9:case"end":return e.stop()}}),e)}))),sw.apply(this,arguments)}function cw(e,t){return lw.apply(this,arguments)}function lw(){return lw=ie(oe().mark((function e(t,n){var r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=_f(t)).currentUser.isEqual(n)){e.next=11;break}return vf("SyncEngine","User change. New user:",n.toKey()),e.next=5,xg(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,function(e,t){e.ua.forEach((function(e){e.forEach((function(e){e.reject(new bf(wf.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.ua.clear()}(r),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=11,uw(r,i.ci);case 11:case"end":return e.stop()}}),e)}))),lw.apply(this,arguments)}function hw(e,t){var n=_f(e),r=n.ia.get(t);if(r&&r.Xu)return _p().add(r.key);var i=_p(),a=n.ea.get(t);if(!a)return i;var o,u=ye(a);try{for(u.s();!(o=u.n()).done;){var s=o.value,c=n.ta.get(s);i=i.unionWith(c.view.qu)}}catch(l){u.e(l)}finally{u.f()}return i}function fw(e,t){return dw.apply(this,arguments)}function dw(){return dw=ie(oe().mark((function e(t,n){var r,i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_f(t),e.next=3,Rg(r.localStore,n.query,!0);case 3:return i=e.sent,a=n.view.Ju(i),e.abrupt("return",(r.isPrimaryClient&&iw(r,n.targetId,a.zu),a));case 6:case"end":return e.stop()}}),e)}))),dw.apply(this,arguments)}function vw(e,t){return pw.apply(this,arguments)}function pw(){return pw=ie(oe().mark((function e(t,n){var r;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_f(t),e.abrupt("return",Lg(r.localStore,n).then((function(e){return uw(r,e)})));case 2:case"end":return e.stop()}}),e)}))),pw.apply(this,arguments)}function yw(e,t,n,r){return mw.apply(this,arguments)}function mw(){return mw=ie(oe().mark((function e(t,n,r,i){var a,o;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=_f(t),e.next=3,function(e,t){var n=_f(e),r=_f(n.$s);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.ln(e,t).next((function(t){return t?n.ai.qs(e,t):Vy.resolve(null)}))}))}(a.localStore,n);case 3:if(null===(o=e.sent)){e.next=15;break}if("pending"!==r){e.next=10;break}return e.next=8,Wk(a.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===r||"rejected"===r?(tw(a,n,i||null),ew(a,n),function(e,t){_f(_f(e).$s).dn(t)}(a.localStore,n)):gf();case 11:return e.next=13,uw(a,o);case 13:e.next=16;break;case 15:vf("SyncEngine","Cannot apply mutation batch with id: "+n);case 16:case"end":return e.stop()}}),e)}))),mw.apply(this,arguments)}function gw(e,t){return kw.apply(this,arguments)}function kw(){return kw=ie(oe().mark((function e(t,n){var r,i,a,o,u,s,c,l;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Tw(r=_f(t)),Nw(r),!0!==n||!0===r.ca){e.next=13;break}return i=r.sharedClientState.getAllActiveQueryTargets(),e.next=5,_w(r,i.toArray());case 5:return a=e.sent,r.ca=!0,e.next=9,o_(r.remoteStore,!0);case 9:o=ye(a);try{for(o.s();!(u=o.n()).done;)s=u.value,Ik(r.remoteStore,s)}catch(h){o.e(h)}finally{o.f()}e.next=25;break;case 13:if(!1!==n||!1===r.ca){e.next=25;break}return c=[],l=Promise.resolve(),r.ea.forEach((function(e,t){r.sharedClientState.isLocalQueryTarget(t)?c.push(t):l=l.then((function(){return nw(r,t),Ag(r.localStore,t,!0)})),Tk(r.remoteStore,t)})),e.next=19,l;case 19:return e.next=21,_w(r,c);case 21:return function(e){var t=_f(e);t.ia.forEach((function(e,n){Tk(t.remoteStore,n)})),t.ra.bi(),t.ia=new Map,t.sa=new up(ud.comparator)}(r),r.ca=!1,e.next=25,o_(r.remoteStore,!1);case 25:case"end":return e.stop()}}),e)}))),kw.apply(this,arguments)}function _w(e,t,n){return ww.apply(this,arguments)}function ww(){return ww=ie(oe().mark((function e(t,n,r){var i,a,o,u,s,c,l,h,f,d,v,p,y,m;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=_f(t),a=[],o=[],u=ye(n),e.prev=2,u.s();case 4:if((s=u.n()).done){e.next=45;break}if(c=s.value,l=void 0,!(h=i.ea.get(c))||0===h.length){e.next=34;break}return e.next=11,Dg(i.localStore,vv(h[0]));case 11:l=e.sent,f=ye(h),e.prev=13,f.s();case 15:if((d=f.n()).done){e.next=24;break}return v=d.value,p=i.ta.get(v),e.next=20,fw(i,p);case 20:(y=e.sent).snapshot&&o.push(y.snapshot);case 22:e.next=15;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(13),f.e(e.t0);case 29:return e.prev=29,f.f(),e.finish(29);case 32:e.next=42;break;case 34:return e.next=36,Og(i.localStore,c);case 36:return m=e.sent,e.next=39,Dg(i.localStore,m);case 39:return l=e.sent,e.next=42,F_(i,bw(m),c,!1);case 42:a.push(l);case 43:e.next=4;break;case 45:e.next=50;break;case 47:e.prev=47,e.t1=e.catch(2),u.e(e.t1);case 50:return e.prev=50,u.f(),e.finish(50);case 53:return e.abrupt("return",(i.Zu.Ko(o),a));case 54:case"end":return e.stop()}}),e,null,[[2,47,50,53],[13,26,29,32]])}))),ww.apply(this,arguments)}function bw(e){return ov(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function xw(e){var t=_f(e);return _f(_f(t.localStore).persistence).Os()}function Ew(e,t,n,r){return Sw.apply(this,arguments)}function Sw(){return Sw=ie(oe().mark((function e(t,n,r,i){var a,o,u,s;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=_f(t)).ca){e.next=3;break}return e.abrupt("return",void vf("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((o=a.ea.get(n))&&o.length>0)){e.next=20;break}e.t0=r,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,Lg(a.localStore,_v(o[0]));case 10:return u=e.sent,s=xp.createSynthesizedRemoteEventForCurrentChange(n,"current"===r),e.next=14,uw(a,u,s);case 14:return e.abrupt("break",20);case 15:return e.next=17,Ag(a.localStore,n,!0);case 17:return nw(a,n,i),e.abrupt("break",20);case 19:gf();case 20:case"end":return e.stop()}}),e)}))),Sw.apply(this,arguments)}function Cw(e,t,n){return Iw.apply(this,arguments)}function Iw(){return Iw=ie(oe().mark((function e(t,n,r){var i,a,o,u,s,c,l,h,f;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=Tw(t)).ca){e.next=45;break}a=ye(n),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=21;break}if(u=o.value,!i.ea.has(u)){e.next=10;break}return vf("SyncEngine","Adding an already active target "+u),e.abrupt("continue",19);case 10:return e.next=12,Og(i.localStore,u);case 12:return s=e.sent,e.next=15,Dg(i.localStore,s);case 15:return c=e.sent,e.next=18,F_(i,bw(s),c.targetId,!1);case 18:Ik(i.remoteStore,c);case 19:e.next=5;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:l=ye(r),e.prev=30,f=oe().mark((function e(){var t;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.value,e.t0=i.ea.has(t),!e.t0){e.next=5;break}return e.next=5,Ag(i.localStore,t,!1).then((function(){Tk(i.remoteStore,t),nw(i,t)})).catch(Ym);case 5:case"end":return e.stop()}}),e)})),l.s();case 33:if((h=l.n()).done){e.next=37;break}return e.delegateYield(f(),"t1",35);case 35:e.next=33;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(30),l.e(e.t2);case 42:return e.prev=42,l.f(),e.finish(42);case 45:case"end":return e.stop()}}),e,null,[[3,23,26,29],[30,39,42,45]])}))),Iw.apply(this,arguments)}function Tw(e){var t=_f(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=z_.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=hw.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=G_.bind(null,t),t.Zu.Ko=w_.bind(null,t.eventManager),t.Zu.la=b_.bind(null,t.eventManager),t}function Nw(e){var t=_f(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Q_.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=$_.bind(null,t),t}function Dw(e,t,n){var r=_f(e);(function(){var e=ie(oe().mark((function e(t,n,r){var i,a,o,u,s;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getMetadata();case 3:return i=e.sent,e.next=6,function(e,t){var n=_f(e),r=Vp(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.ds.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(t.localStore,i);case 6:if(!e.sent){e.next=11;break}return e.next=9,n.close();case 9:return r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(i)),e.abrupt("return",Promise.resolve(new Set));case 11:return r._updateProgress(T_(i)),a=new I_(i,t.localStore,n.M),e.next=15,n.fa();case 15:o=e.sent;case 16:if(!o){e.next=26;break}return e.next=19,a.Nu(o);case 19:return(u=e.sent)&&r._updateProgress(u),e.next=23,n.fa();case 23:o=e.sent;case 24:e.next=16;break;case 26:return e.next=28,a.complete();case 28:return s=e.sent,e.next=31,uw(t,s.Ou,void 0);case 31:return e.next=33,function(e,t){var n=_f(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.ds.saveBundleMetadata(e,t)}))}(t.localStore,i);case 33:return r._completeWith(s.progress),e.abrupt("return",Promise.resolve(s.Mu));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(yf("SyncEngine","Loading bundle failed with ".concat(e.t0)),r._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}}),e,null,[[0,37]])})));return function(t,n,r){return e.apply(this,arguments)}})()(r,t,n).then((function(e){r.sharedClientState.notifyBundleLoaded(e)}))}var Aw=function(){function e(){me(this,e),this.synchronizeTabs=!1}return ke(e,[{key:"initialize",value:function(){var e=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.M=pk(t.databaseInfo.databaseId),this.sharedClientState=this.da(t),this.persistence=this._a(t),e.next=5,this.persistence.start();case 5:this.gcScheduler=this.wa(t),this.localStore=this.ma(t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"wa",value:function(e){return null}},{key:"ma",value:function(e){return bg(this.persistence,new _g,e.initialUser,this.M)}},{key:"_a",value:function(e){return new Yg(Xg.Wi,this.M)}},{key:"da",value:function(e){return new uk}},{key:"terminate",value:function(){var e=ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Pw=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this)).ga=e,a.cacheSizeBytes=r,a.forceOwnership=i,a.synchronizeTabs=!1,a}return ke(n,[{key:"initialize",value:function(){var e=ie(oe().mark((function e(t){var r=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qu(le(n.prototype),"initialize",this).call(this,t);case 2:return e.next=4,this.ga.initialize(this,t);case 4:return e.next=6,Nw(this.ga.syncEngine);case 6:return e.next=8,Wk(this.ga.remoteStore);case 8:return e.next=10,this.persistence.Is((function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(r.localStore),Promise.resolve()}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"ma",value:function(e){return bg(this.persistence,new _g,e.initialUser,this.M)}},{key:"wa",value:function(e){var t=this.persistence.referenceDelegate.garbageCollector;return new Zm(t,e.asyncQueue)}},{key:"_a",value:function(e){var t=mg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Mm.withCacheSize(this.cacheSizeBytes):Mm.DEFAULT;return new vg(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,dk(),vk(),this.M,this.sharedClientState,!!this.forceOwnership)}},{key:"da",value:function(e){return new uk}}]),n}(Aw),Rw=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e,r,!1)).ga=e,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return ke(n,[{key:"initialize",value:function(){var e=ie(oe().mark((function e(t){var r,i=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qu(le(n.prototype),"initialize",this).call(this,t);case 2:if(r=this.ga.syncEngine,e.t0=this.sharedClientState instanceof ok,!e.t0){e.next=8;break}return this.sharedClientState.syncEngine={kr:yw.bind(null,r),Mr:Ew.bind(null,r),Or:Cw.bind(null,r),Os:xw.bind(null,r),Nr:vw.bind(null,r)},e.next=8,this.sharedClientState.start();case 8:return e.next=10,this.persistence.Is(function(){var e=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gw(i.ga.syncEngine,t);case 2:i.gcScheduler&&(t&&!i.gcScheduler.started?i.gcScheduler.start(i.localStore):t||i.gcScheduler.stop());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"da",value:function(e){var t=dk();if(!ok.vt(t))throw new bf(wf.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=mg(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ok(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),n}(Pw),Ow=function(){function e(){me(this,e)}return ke(e,[{key:"initialize",value:function(){var e=ie(oe().mark((function e(t,n){var r=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return K_(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=cw.bind(null,this.syncEngine),e.next=12,o_(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new y_}},{key:"createDatastore",value:function(e){var t,n=pk(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new fk(t));return function(e,t,n,r){return new _k(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return K_(o.syncEngine,e,0)},a=ck.vt()?new ck:new sk,new bk(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var u=new O_(e,t,n,r,i,a);return o&&(u.ca=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=ie(oe().mark((function e(t){var n;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_f(t),vf("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,Sk(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();function Lw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{read:function(){return ie(oe().mark((function r(){var i;return oe().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(n<e.byteLength)){r.next=3;break}return i={value:e.slice(n,n+t),done:!1},r.abrupt("return",(n+=t,i));case 3:return r.abrupt("return",{done:!0});case 4:case"end":return r.stop()}}),r)})))()},cancel:function(){return ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Mw=function(){function e(t){me(this,e),this.observer=t,this.muted=!1}return ke(e,[{key:"next",value:function(e){this.observer.next&&this.ya(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.ya(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"pa",value:function(){this.muted=!0}},{key:"ya",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),Fw=function(){function e(t,n){var r=this;me(this,e),this.Ia=t,this.M=n,this.metadata=new xf,this.buffer=new Uint8Array,this.Ta=new TextDecoder("utf-8"),this.Ea().then((function(e){e&&e.Cu()?r.metadata.resolve(e.payload.metadata):r.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.payload))))}),(function(e){return r.metadata.reject(e)}))}return ke(e,[{key:"close",value:function(){return this.Ia.cancel()}},{key:"getMetadata",value:function(){var e=ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.metadata.promise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fa",value:function(){var e=ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMetadata();case 2:return e.abrupt("return",this.Ea());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Ea",value:function(){var e=ie(oe().mark((function e(){var t,n,r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Aa();case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return n=this.Ta.decode(t),r=Number(n),isNaN(r)&&this.Ra("length string (".concat(n,") is not valid number")),e.next=9,this.ba(r);case 9:return i=e.sent,e.abrupt("return",new S_(JSON.parse(i),t.length+r));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Pa",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"Aa",value:function(){var e=ie(oe().mark((function e(){var t,n;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.Pa()<0)){e.next=7;break}return e.next=3,this.Va();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==this.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(t=this.Pa())<0&&this.Ra("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,t),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ba",value:function(){var e=ie(oe().mark((function e(t){var n;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.buffer.length<t)){e.next=8;break}return e.next=3,this.Va();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.Ra("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return n=this.Ta.decode(this.buffer.slice(0,t)),e.abrupt("return",(this.buffer=this.buffer.slice(t),n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"Ra",value:function(e){throw this.Ia.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"Va",value:function(){var e=ie(oe().mark((function e(){var t,n;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.Ia.read();case 2:return(t=e.sent).done||((n=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),n.set(t.value,this.buffer.length),this.buffer=n),e.abrupt("return",t.done);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Vw=function(){function e(t){me(this,e),this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return ke(e,[{key:"lookup",value:function(){var e=ie(oe().mark((function e(t){var n,r=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!(this.mutations.length>0)){e.next=2;break}throw new bf(wf.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return e.next=4,function(){var e=ie(oe().mark((function e(t,n){var r,i,a,o,u,s;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_f(t),i=Kp(r.M)+"/documents",a={documents:n.map((function(e){return jp(r.M,e)}))},e.next=5,r.co("BatchGetDocuments",i,a);case 5:return o=e.sent,u=new Map,o.forEach((function(e){var t=Yp(r.M,e);u.set(t.key.toString(),t)})),s=[],e.abrupt("return",(n.forEach((function(e){var t=u.get(e.toString());kf(!!t),s.push(t)})),s));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,t);case 4:return n=e.sent,e.abrupt("return",(n.forEach((function(e){return r.recordVersion(e)})),n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new tp(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var e=ie(oe().mark((function e(){var t,n=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.ensureCommitNotCalled(),!this.lastWriteError){e.next=2;break}throw this.lastWriteError;case 2:return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(e,t){var r=ud.fromPath(t);n.mutations.push(new np(r,n.precondition(r)))})),e.next=7,function(){var e=ie(oe().mark((function e(t,n){var r,i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_f(t),i=Kp(r.M)+"/documents",a={writes:n.map((function(e){return $p(r.M,e)}))},e.next=3,r.ro("Commit",i,a);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(this.datastore,this.mutations);case 7:this.committed=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw gf();t=qf.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new bf(wf.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?Uv.updateTime(t):Uv.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(qf.min()))throw new bf(wf.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Uv.updateTime(t)}return Uv.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),e}(),qw=function(){function e(t,n,r,i){me(this,e),this.asyncQueue=t,this.datastore=n,this.updateFunction=r,this.deferred=i,this.va=5,this.So=new yk(this.asyncQueue,"transaction_retry")}return ke(e,[{key:"run",value:function(){this.va-=1,this.Sa()}},{key:"Sa",value:function(){var e=this;this.So.Io(ie(oe().mark((function t(){var n,r;return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new Vw(e.datastore),(r=e.Da(n))&&r.then((function(t){e.asyncQueue.enqueueAndForget((function(){return n.commit().then((function(){e.deferred.resolve(t)})).catch((function(t){e.Ca(t)}))}))})).catch((function(t){e.Ca(t)}));case 2:case"end":return t.stop()}}),t)}))))}},{key:"Da",value:function(e){try{var t=this.updateFunction(e);return!id(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Ca",value:function(e){var t=this;this.va>0&&this.xa(e)?(this.va-=1,this.asyncQueue.enqueueAndForget((function(){return t.Sa(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"xa",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!ip(t)}return!1}}]),e}(),Uw=function(){function e(t,n,r,i){var a=this;me(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=lf.UNAUTHENTICATED,this.clientId=Of.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return vf("FirestoreClient","Received user=",t.uid),e.next=3,a.authCredentialListener(t);case 3:a.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return vf("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)}))}return ke(e,[{key:"getConfiguration",value:function(){var e=ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new bf(wf.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new xf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(ie(oe().mark((function n(){var r;return oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=h_(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function jw(e,t){return Bw.apply(this,arguments)}function Bw(){return Bw=ie(oe().mark((function e(t,n){var r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),vf("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,xg(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),Bw.apply(this,arguments)}function zw(e,t){return Ww.apply(this,arguments)}function Ww(){return Ww=ie(oe().mark((function e(t,n){var r,i;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,Kw(t);case 3:return r=e.sent,vf("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener((function(e){return i_(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return i_(n.remoteStore,t)})),t.onlineComponents=n;case 13:case"end":return e.stop()}}),e)}))),Ww.apply(this,arguments)}function Kw(e){return Gw.apply(this,arguments)}function Gw(){return Gw=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return vf("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,jw(t,new Aw);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}}),e)}))),Gw.apply(this,arguments)}function Hw(e){return Qw.apply(this,arguments)}function Qw(){return Qw=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return vf("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,zw(t,new Ow);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}}),e)}))),Qw.apply(this,arguments)}function Yw(e){return Kw(e).then((function(e){return e.persistence}))}function $w(e){return Kw(e).then((function(e){return e.localStore}))}function Xw(e){return Hw(e).then((function(e){return e.remoteStore}))}function Jw(e){return Hw(e).then((function(e){return e.syncEngine}))}function Zw(e){return eb.apply(this,arguments)}function eb(){return eb=ie(oe().mark((function e(t){var n,r;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hw(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=L_.bind(null,n.syncEngine),r.onUnlisten=q_.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)}))),eb.apply(this,arguments)}function tb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new xf;return e.asyncQueue.enqueueAndForget(ie(oe().mark((function i(){return oe().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new Mw({next:function(a){t.enqueueAndForget((function(){return k_(e,o)}));var u=a.docs.has(n);!u&&a.fromCache?i.reject(new bf(wf.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&a.fromCache&&r&&"server"===r.source?i.reject(new bf(wf.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new E_(uv(n.path),a,{includeMetadataChanges:!0,Du:!0});return m_(e,o)},i.next=3,Zw(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}function nb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new xf;return e.asyncQueue.enqueueAndForget(ie(oe().mark((function i(){return oe().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new Mw({next:function(n){t.enqueueAndForget((function(){return k_(e,o)})),n.fromCache&&"server"===r.source?i.reject(new bf(wf.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new E_(n,a,{includeMetadataChanges:!0,Du:!0});return m_(e,o)},i.next=3,Zw(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}}),i)})))),r.promise}var rb=new Map;function ib(e,t,n){if(!n)throw new bf(wf.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function ab(e,t,n,r){if(!0===t&&!0===r)throw new bf(wf.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function ob(e){if(!ud.isDocumentKey(e))throw new bf(wf.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function ub(e){if(ud.isDocumentKey(e))throw new bf(wf.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function sb(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":gf()}function cb(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new bf(wf.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=sb(e);throw new bf(wf.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function lb(e,t){if(t<=0)throw new bf(wf.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var hb=function(){function e(t){var n;if(me(this,e),void 0===t.host){if(void 0!==t.ssl)throw new bf(wf.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new bf(wf.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,ab("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return ke(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),fb=function(){function e(t,n,r){me(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hb({}),this._settingsFrozen=!1,t instanceof rd?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new bf(wf.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rd(e.options.projectId)}(t))}return ke(e,[{key:"app",get:function(){if(!this._app)throw new bf(wf.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new bf(wf.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hb(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Sf;switch(e.type){case"gapi":var t=e.client;return kf(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new Nf(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new bf(wf.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=rb.get(e);t&&(vf("ComponentProvider","Removing Datastore"),rb.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();function db(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=cb(e,fb))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&yf("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,u;if("string"==typeof i.mockUserToken)o=i.mockUserToken,u=lf.MOCK_USER;else{o=Le(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new bf(wf.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new lf(s)}e._authCredentials=new Cf(new Ef(o,u))}}var vb=function(){function e(t,n,r){me(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return ke(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new yb(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),pb=function(){function e(t,n,r){me(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return ke(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),yb=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this,e,r,uv(i)))._path=i,a.type="collection",a}return ke(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new vb(this.firestore,null,new ud(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(pb);function mb(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=st(e),ib("collection","path",t),e instanceof fb){var a=Wf.fromString.apply(Wf,[t].concat(r));return ub(a),new yb(e,null,a)}if(!(e instanceof vb||e instanceof yb))throw new bf(wf.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Wf.fromString.apply(Wf,[t].concat(r)));return ub(o),new yb(e.firestore,null,o)}function gb(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=st(e),1===arguments.length&&(t=Of.R()),ib("doc","path",t),e instanceof fb){var a=Wf.fromString.apply(Wf,[t].concat(r));return ob(a),new vb(e,null,new ud(a))}if(!(e instanceof vb||e instanceof yb))throw new bf(wf.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Wf.fromString.apply(Wf,[t].concat(r)));return ob(o),new vb(e.firestore,e instanceof yb?e.converter:null,new ud(o))}function kb(e,t){return e=st(e),t=st(t),(e instanceof vb||e instanceof yb)&&(t instanceof vb||t instanceof yb)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function _b(e,t){return e=st(e),t=st(t),e instanceof pb&&t instanceof pb&&e.firestore===t.firestore&&yv(e._query,t._query)&&e.converter===t.converter}var wb=function(){function e(){var t=this;me(this,e),this.Na=Promise.resolve(),this.ka=[],this.Ma=!1,this.Oa=[],this.Fa=null,this.$a=!1,this.Ba=!1,this.La=[],this.So=new yk(this,"async_queue_retry"),this.Ua=function(){var e=vk();e&&vf("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=vk();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Ua)}return ke(e,[{key:"isShuttingDown",get:function(){return this.Ma}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.qa(),this.Ga(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Ma){this.Ma=!0,this.Ba=e||!1;var t=vk();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ua)}}},{key:"enqueue",value:function(e){var t=this;if(this.qa(),this.Ma)return new Promise((function(){}));var n=new xf;return this.Ga((function(){return t.Ma&&t.Ba?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.ka.push(e),t.Ka()}))}},{key:"Ka",value:function(){var e=ie(oe().mark((function e(){var t=this;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.ka.length){e.next=14;break}return e.prev=1,e.next=4,this.ka[0]();case 4:this.ka.shift(),this.So.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),zy(e.t0)){e.next=12;break}throw e.t0;case 12:vf("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.ka.length>0&&this.So.Io((function(){return t.Ka()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"Ga",value:function(e){var t=this,n=this.Na.then((function(){return t.$a=!0,e().catch((function(e){t.Fa=e,t.$a=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw pf("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.$a=!1,e}))}));return this.Na=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.qa(),this.La.indexOf(e)>-1&&(t=0);var i=l_.createAndSchedule(this,e,t,n,(function(e){return r.Qa(e)}));return this.Oa.push(i),i}},{key:"qa",value:function(){this.Fa&&gf()}},{key:"verifyOperationInProgress",value:function(){}},{key:"ja",value:function(){var e=ie(oe().mark((function e(){var t;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Na,e.next=3,t;case 3:if(t!==this.Na){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Wa",value:function(e){var t,n=ye(this.Oa);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"za",value:function(e){var t=this;return this.ja().then((function(){t.Oa.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=ye(t.Oa);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.ja()}))}},{key:"Ha",value:function(e){this.La.push(e)}},{key:"Qa",value:function(e){var t=this.Oa.indexOf(e);this.Oa.splice(t,1)}}]),e}();function bb(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,i=ye(["next","error","complete"]);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"==typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e)}var xb=function(){function e(){me(this,e),this._progressObserver={},this._taskCompletionResolver=new xf,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return ke(e,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),e}(),Eb=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new wb,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return ke(n,[{key:"_terminate",value:function(){return this._firestoreClient||Cb(this),this._firestoreClient.terminate()}}]),n}(fb);function Sb(e){return e._firestoreClient||Cb(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Cb(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new nd(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new Uw(e._authCredentials,e._appCheckCredentials,e._queue,r)}function Ib(e,t,n){var r=new xf;return e.asyncQueue.enqueue(ie(oe().mark((function i(){return oe().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,jw(e,n);case 3:return i.next=5,zw(e,t);case 5:r.resolve(),i.next=13;break;case 8:if(i.prev=8,i.t0=i.catch(0),function(e){return"FirebaseError"===e.name?e.code===wf.FAILED_PRECONDITION||e.code===wf.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(i.t0)){i.next=12;break}throw i.t0;case 12:console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i.t0),r.reject(i.t0);case 13:case"end":return i.stop()}}),i,null,[[0,8]])})))).then((function(){return r.promise}))}function Tb(e){return function(e){return e.asyncQueue.enqueue(ie(oe().mark((function t(){var n,r;return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Yw(e);case 2:return n=t.sent,t.next=5,Xw(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!0),function(e){var t=_f(e);return t.lu.delete(0),xk(t)}(r)));case 7:case"end":return t.stop()}}),t)}))))}(Sb(e=cb(e,Eb)))}function Nb(e){return function(e){return e.asyncQueue.enqueue(ie(oe().mark((function t(){var n,r;return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Yw(e);case 2:return n=t.sent,t.next=5,Xw(e);case 5:return r=t.sent,t.abrupt("return",(n.setNetworkEnabled(!1),function(){var e=ie(oe().mark((function e(t){var n;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=_f(t)).lu.add(0),e.next=4,Sk(n);case 4:n._u.set("Offline");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(r)));case 7:case"end":return t.stop()}}),t)}))))}(Sb(e=cb(e,Eb)))}function Db(e,t){var n=Sb(e=cb(e,Eb)),r=new xb;return function(e,t,n,r){var i=function(e,t){return function(e,t){return new Fw(e,t)}(function(e,t){if(e instanceof Uint8Array)return Lw(e,t);if(e instanceof ArrayBuffer)return Lw(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),t)}(n,pk(t));e.asyncQueue.enqueueAndForget(ie(oe().mark((function t(){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Dw,t.next=3,Jw(e);case 3:t.t1=t.sent,t.t2=i,t.t3=r,(0,t.t0)(t.t1,t.t2,t.t3);case 7:case"end":return t.stop()}}),t)}))))}(n,e._databaseId,t,r),r}function Ab(e,t){return function(e,t){return e.asyncQueue.enqueue(ie(oe().mark((function n(){return oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=function(e,t){var n=_f(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.ds.getNamedQuery(e,t)}))},n.next=3,$w(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)}))))}(Sb(e=cb(e,Eb)),t).then((function(t){return t?new pb(e,null,t.query):null}))}function Pb(e){if(e._initialized||e._terminated)throw new bf(wf.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Rb=function(){function e(){me(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new bf(wf.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gf(n)}return ke(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var Ob=function(){function e(t){me(this,e),this._byteString=t}return ke(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Qf.fromBase64String(t))}catch(t){throw new bf(wf.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(Qf.fromUint8Array(t))}}]),e}(),Lb=ke((function e(t){me(this,e),this._methodName=t})),Mb=function(){function e(t,n){if(me(this,e),!isFinite(t)||t<-90||t>90)throw new bf(wf.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new bf(wf.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return ke(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Lf(this._lat,e._lat)||Lf(this._long,e._long)}}]),e}(),Fb=/^__.*__$/,Vb=function(){function e(t,n,r){me(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return ke(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new Yv(e,this.data,this.fieldMask,t,this.fieldTransforms):new Qv(e,this.data,t,this.fieldTransforms)}}]),e}(),qb=function(){function e(t,n,r){me(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return ke(e,[{key:"toMutation",value:function(e,t){return new Yv(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function Ub(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw gf()}}var jb=function(){function e(t,n,r,i,a,o){me(this,e),this.settings=t,this.databaseId=n,this.M=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Ja(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return ke(e,[{key:"path",get:function(){return this.settings.path}},{key:"Ya",get:function(){return this.settings.Ya}},{key:"Xa",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.M,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"Za",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Xa({path:n,tc:!1});return r.ec(e),r}},{key:"nc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Xa({path:n,tc:!1});return r.Ja(),r}},{key:"sc",value:function(e){return this.Xa({path:void 0,tc:!0})}},{key:"ic",value:function(e){return ux(e,this.settings.methodName,this.settings.rc||!1,this.path,this.settings.oc)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"Ja",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.ec(this.path.get(e))}},{key:"ec",value:function(e){if(0===e.length)throw this.ic("Document fields must not be empty");if(Ub(this.Ya)&&Fb.test(e))throw this.ic('Document fields cannot begin and end with "__"')}}]),e}(),Bb=function(){function e(t,n,r){me(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.M=r||pk(t)}return ke(e,[{key:"uc",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new jb({Ya:e,methodName:t,oc:n,path:Gf.emptyPath(),tc:!1,rc:r},this.databaseId,this.M,this.ignoreUndefinedProperties)}}]),e}();function zb(e){var t=e._freezeSettings(),n=pk(e._databaseId);return new Bb(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Wb(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.uc(a.merge||a.mergeFields?2:0,t,n,i);rx("Data must be an object, but it was:",o,r);var u,s,c=tx(r,o);if(a.merge)u=new Hf(o.fieldMask),s=o.fieldTransforms;else if(a.mergeFields){var l,h=[],f=ye(a.mergeFields);try{for(f.s();!(l=f.n()).done;){var d=l.value,v=ix(t,d,n);if(!o.contains(v))throw new bf(wf.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));sx(h,v)||h.push(v)}}catch(p){f.e(p)}finally{f.f()}u=new Hf(h),s=o.fieldTransforms.filter((function(e){return u.covers(e.field)}))}else u=null,s=o.fieldTransforms;return new Vb(new Id(c),u,s)}var Kb=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Ya)throw 1===e.Ya?e.ic("".concat(this._methodName,"() can only appear at the top level of your update data")):e.ic("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(Lb);function Gb(e,t,n){return new jb({Ya:3,oc:t.settings.oc,methodName:e._methodName,tc:n},t.databaseId,t.M,t.ignoreUndefinedProperties)}var Hb=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"_toFieldTransform",value:function(e){return new Vv(e.path,new Dv)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(Lb),Qb=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e)).ac=r,i}return ke(n,[{key:"_toFieldTransform",value:function(e){var t=Gb(this,e,!0),n=this.ac.map((function(e){return ex(e,t)})),r=new Av(n);return new Vv(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(Lb),Yb=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e)).ac=r,i}return ke(n,[{key:"_toFieldTransform",value:function(e){var t=Gb(this,e,!0),n=this.ac.map((function(e){return ex(e,t)})),r=new Rv(n);return new Vv(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),n}(Lb),$b=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e)).cc=r,i}return ke(n,[{key:"_toFieldTransform",value:function(e){var t=new Lv(e.M,Sv(e.M,this.cc));return new Vv(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),n}(Lb);function Xb(e,t,n,r){var i=e.uc(1,t,n);rx("Data must be an object, but it was:",i,r);var a=[],o=Id.empty();jf(r,(function(e,r){var u=ox(t,e,n);r=st(r);var s=i.nc(u);if(r instanceof Kb)a.push(u);else{var c=ex(r,s);null!=c&&(a.push(u),o.set(u,c))}}));var u=new Hf(a);return new qb(o,u,i.fieldTransforms)}function Jb(e,t,n,r,i,a){var o=e.uc(1,t,n),u=[ix(t,r,n)],s=[i];if(a.length%2!=0)throw new bf(wf.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)u.push(ix(t,a[c])),s.push(a[c+1]);for(var l=[],h=Id.empty(),f=u.length-1;f>=0;--f)if(!sx(l,u[f])){var d=u[f],v=s[f];v=st(v);var p=o.nc(d);if(v instanceof Kb)l.push(d);else{var y=ex(v,p);null!=y&&(l.push(d),h.set(d,y))}}var m=new Hf(l);return new qb(h,m,o.fieldTransforms)}function Zb(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return ex(n,e.uc(r?4:3,t))}function ex(e,t){if(nx(e=st(e)))return rx("Unsupported field value:",t,e),tx(e,t);if(e instanceof Lb)return function(e,t){if(!Ub(t.Ya))throw t.ic("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.ic("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.tc&&4!==t.Ya)throw t.ic("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=ye(e);try{for(a.s();!(n=a.n()).done;){var o=ex(n.value,t.sc(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(u){a.e(u)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=st(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Sv(t.M,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Vf.fromDate(e);return{timestampValue:Lp(t.M,n)}}if(e instanceof Vf){var r=new Vf(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Lp(t.M,r)}}if(e instanceof Mb)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Ob)return{bytesValue:Mp(t.M,e._byteString)};if(e instanceof vb){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.ic("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:qp(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ic("Unsupported field value: ".concat(sb(e)))}(e,t)}function tx(e,t){var n={};return Bf(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):jf(e,(function(e,r){var i=ex(r,t.Za(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function nx(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Vf||e instanceof Mb||e instanceof Ob||e instanceof vb||e instanceof Lb)}function rx(e,t,n){if(!nx(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=sb(n);throw"an object"===r?t.ic(e+" a custom object"):t.ic(e+" "+r)}}function ix(e,t,n){if((t=st(t))instanceof Rb)return t._internalPath;if("string"==typeof t)return ox(e,t);throw ux("Field path arguments must be of type string or ",e,!1,void 0,n)}var ax=new RegExp("[~\\*/\\[\\]]");function ox(e,t,n){if(t.search(ax)>=0)throw ux("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return we(Rb,pe(t.split(".")))._internalPath}catch(r){throw ux("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function ux(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,u="Function ".concat(t,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(a||o)&&(s+=" (found",a&&(s+=" in field ".concat(r)),o&&(s+=" in document ".concat(i)),s+=")"),new bf(wf.INVALID_ARGUMENT,u+e+s)}function sx(e,t){return e.some((function(e){return e.isEqual(t)}))}var cx=function(){function e(t,n,r,i,a){me(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return ke(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new vb(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new lx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(hx("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),lx=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"data",value:function(){return Qu(le(n.prototype),"data",this).call(this)}}]),n}(cx);function hx(e,t){return"string"==typeof t?ox(e,t):t instanceof Rb?t._internalPath:t._delegate._internalPath}var fx=function(){function e(t,n){me(this,e),this.hasPendingWrites=t,this.fromCache=n}return ke(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),dx=function(e){ce(n,e);var t=ve(n);function n(e,r,i,a,o,u){var s;return me(this,n),(s=t.call(this,e,r,i,a,u))._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return ke(n,[{key:"exists",value:function(){return Qu(le(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new vx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(hx("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(cx),vx=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qu(le(n.prototype),"data",this).call(this,e)}}]),n}(dx),px=function(){function e(t,n,r,i){me(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new fx(i.hasPendingWrites,i.fromCache),this.query=r}return ke(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new vx(n._firestore,n._userDataWriter,r.key,r,new fx(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new bf(wf.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){return{type:"added",doc:new vx(e._firestore,e._userDataWriter,t.doc.key,t.doc,new fx(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new vx(e._firestore,e._userDataWriter,t.doc.key,t.doc,new fx(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:yx(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function yx(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return gf()}}function mx(e,t){return e instanceof dx&&t instanceof dx?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof px&&t instanceof px&&e._firestore===t._firestore&&_b(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function gx(e){if(cv(e)&&0===e.explicitOrderBy.length)throw new bf(wf.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var kx=ke((function e(){me(this,e)}));function _x(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e}var wx=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this)).hc=e,a.lc=r,a.fc=i,a.type="where",a}return ke(n,[{key:"_apply",value:function(e){var t=zb(e.firestore),n=function(e,t,n,r,i,a,o){var u;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new bf(wf.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){Px(o,a);var s,c=[],l=ye(o);try{for(l.s();!(s=l.n()).done;){var h=s.value;c.push(Ax(r,e,h))}}catch(d){l.e(d)}finally{l.f()}u={arrayValue:{values:c}}}else u=Ax(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Px(o,a),u=Zb(n,"where",o,"in"===a||"not-in"===a);var f=Kd.create(i,a,u);return function(e,t){if(t.S()){var n=hv(e);if(null!==n&&!n.isEqual(t.field))throw new bf(wf.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=lv(e);null!==r&&Rx(e,t.field,r)}var i=function(e,t){var n,r=ye(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new bf(wf.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new bf(wf.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,f),f}(e._query,0,t,e.firestore._databaseId,this.hc,this.lc,this.fc);return new pb(e.firestore,e.converter,function(e,t){var n=e.filters.concat([t]);return new av(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}]),n}(kx);var bx=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this)).hc=e,i.dc=r,i.type="orderBy",i}return ke(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new bf(wf.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new bf(wf.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new tv(t,n);return function(e,t){if(null===lv(e)){var n=hv(e);null!==n&&Rx(e,n,t.field)}}(e,r),r}(e._query,this.hc,this.dc);return new pb(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new av(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}]),n}(kx);var xx=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this)).type=e,a._c=r,a.wc=i,a}return ke(n,[{key:"_apply",value:function(e){return new pb(e.firestore,e.converter,pv(e._query,this._c,this.wc))}}]),n}(kx);var Ex=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this)).type=e,a.mc=r,a.gc=i,a}return ke(n,[{key:"_apply",value:function(e){var t=Dx(e,this.type,this.mc,this.gc);return new pb(e.firestore,e.converter,function(e,t){return new av(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}]),n}(kx);function Sx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Ex("startAt",t,!0)}function Cx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Ex("startAfter",t,!1)}var Ix=function(e){ce(n,e);var t=ve(n);function n(e,r,i){var a;return me(this,n),(a=t.call(this)).type=e,a.mc=r,a.gc=i,a}return ke(n,[{key:"_apply",value:function(e){var t=Dx(e,this.type,this.mc,this.gc);return new pb(e.firestore,e.converter,function(e,t){return new av(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}]),n}(kx);function Tx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Ix("endBefore",t,!1)}function Nx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Ix("endAt",t,!0)}function Dx(e,t,n,r){if(n[0]=st(n[0]),n[0]instanceof cx)return function(e,t,n,r,i){if(!r)throw new bf(wf.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a,o=[],u=ye(dv(e));try{for(u.s();!(a=u.n()).done;){var s=a.value;if(s.field.isKeyField())o.push(md(t,r.key));else{var c=r.data.field(s.field);if(Zf(c))throw new bf(wf.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=s.field.canonicalString();throw new bf(wf.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(l,"' (used as the orderBy) does not exist."))}o.push(c)}}}catch(h){u.e(h)}finally{u.f()}return new ev(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);var i=zb(e.firestore);return function(e,t,n,r,i,a){var o=e.explicitOrderBy;if(i.length>o.length)throw new bf(wf.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var u=[],s=0;s<i.length;s++){var c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new bf(wf.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof c));if(!fv(e)&&-1!==c.indexOf("/"))throw new bf(wf.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(c,"' contains a slash."));var l=e.path.child(Wf.fromString(c));if(!ud.isDocumentKey(l))throw new bf(wf.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(l,"' is not because it contains an odd number of segments."));var h=new ud(l);u.push(md(t,h))}else{var f=Zb(n,r,c);u.push(f)}}return new ev(u,a)}(e._query,e.firestore._databaseId,i,t,n,r)}function Ax(e,t,n){if("string"==typeof(n=st(n))){if(""===n)throw new bf(wf.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fv(t)&&-1!==n.indexOf("/"))throw new bf(wf.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(Wf.fromString(n));if(!ud.isDocumentKey(r))throw new bf(wf.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return md(e,new ud(r))}if(n instanceof vb)return md(e,n._key);throw new bf(wf.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(sb(n),"."))}function Px(e,t){if(!Array.isArray(e)||0===e.length)throw new bf(wf.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new bf(wf.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function Rx(e,t,n){if(!n.isEqual(t))throw new bf(wf.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var Ox=function(){function e(){me(this,e)}return ke(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(ld(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xf(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Jf(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw gf()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return jf(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new Mb(Xf(e.latitude),Xf(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=ed(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(td(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=$f(e);return new Vf(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=Wf.fromString(e);kf(cy(n));var r=new rd(n.get(1),n.get(3)),i=new ud(n.popFirst(5));return r.isEqual(t)||pf("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();function Lx(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var Mx=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this)).firestore=e,r}return ke(n,[{key:"convertBytes",value:function(e){return new Ob(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new vb(this.firestore,null,t)}}]),n}(Ox),Fx=function(){function e(t,n){me(this,e),this._firestore=t,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=zb(t)}return ke(e,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=Vx(e,this._firestore),i=Lx(r.converter,t,n),a=Wb(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,Uv.none())),this}},{key:"update",value:function(e,t,n){this._verifyNotCommitted();for(var r,i=Vx(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=st(t))||t instanceof Rb?Jb(this._dataReader,"WriteBatch.update",i._key,t,n,o):Xb(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,Uv.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=Vx(e,this._firestore);return this._mutations=this._mutations.concat(new tp(t._key,Uv.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new bf(wf.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),e}();function Vx(e,t){if((e=st(e)).firestore!==t)throw new bf(wf.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var qx=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this)).firestore=e,r}return ke(n,[{key:"convertBytes",value:function(e){return new Ob(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new vb(this.firestore,null,t)}}]),n}(Ox);function Ux(e){e=cb(e,vb);var t=cb(e.firestore,Eb),n=Sb(t),r=new qx(t);return function(e,t){var n=new xf;return e.asyncQueue.enqueueAndForget(ie(oe().mark((function r(){return oe().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=ie(oe().mark((function e(t,n,r){var i,a;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=_f(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.ai.Bs(e,t)}))}(t,n);case 3:(i=e.sent).isFoundDocument()?r.resolve(i):i.isNoDocument()?r.resolve(null):r.reject(new bf(wf.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=h_(e.t0,"Failed to get document '".concat(n," from cache")),r.reject(a);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,$w(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._key).then((function(n){return new dx(t,r,e._key,n,new fx(null!==n&&n.hasLocalMutations,!0),e.converter)}))}function jx(e){e=cb(e,pb);var t=cb(e.firestore,Eb),n=Sb(t),r=new qx(t);return function(e,t){var n=new xf;return e.asyncQueue.enqueueAndForget(ie(oe().mark((function r(){return oe().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=function(){var e=ie(oe().mark((function e(t,n,r){var i,a,o,u,s;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Rg(t,n,!0);case 3:i=e.sent,a=new A_(n,i.hi),o=a.Gu(i.documents),u=a.applyChanges(o,!1),r.resolve(u.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),s=h_(e.t0,"Failed to execute query '".concat(n," against cache")),r.reject(s);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.next=3,$w(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(n,e._query).then((function(n){return new px(t,r,e,n)}))}function Bx(e,t,n){e=cb(e,vb);var r=cb(e.firestore,Eb),i=Lx(e.converter,t,n);return Gx(r,[Wb(zb(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Uv.none())])}function zx(e,t,n){e=cb(e,vb);for(var r=cb(e.firestore,Eb),i=zb(r),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return Gx(r,[("string"==typeof(t=st(t))||t instanceof Rb?Jb(i,"updateDoc",e._key,t,n,o):Xb(i,"updateDoc",e._key,t)).toMutation(e._key,Uv.exists(!0))])}function Wx(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=st(e);var u={includeMetadataChanges:!1},s=0;"object"!=typeof n[s]||bb(n[s])||(u=n[s],s++);var c,l,h,f={includeMetadataChanges:u.includeMetadataChanges};if(bb(n[s])){var d=n[s];n[s]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[s+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[s+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof vb)l=cb(e.firestore,Eb),h=uv(e._key.path),c={next:function(t){n[s]&&n[s](Hx(l,e,t))},error:n[s+1],complete:n[s+2]};else{var v=cb(e,pb);l=cb(v.firestore,Eb),h=v._query;var p=new qx(l);c={next:function(e){n[s]&&n[s](new px(l,p,v,e))},error:n[s+1],complete:n[s+2]},gx(e._query)}return function(e,t,n,r){var i=new Mw(r),a=new E_(t,i,n);return e.asyncQueue.enqueueAndForget(ie(oe().mark((function t(){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=m_,t.next=3,Zw(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){i.pa(),e.asyncQueue.enqueueAndForget(ie(oe().mark((function t(){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=k_,t.next=3,Zw(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(Sb(l),h,f,c)}function Kx(e,t){return function(e,t){var n=new Mw(t);return e.asyncQueue.enqueueAndForget(ie(oe().mark((function t(){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){_f(e).Tu.add(t),t.next()},t.next=3,Zw(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)})))),function(){n.pa(),e.asyncQueue.enqueueAndForget(ie(oe().mark((function t(){return oe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t){_f(e).Tu.delete(t)},t.next=3,Zw(e);case 3:return t.t1=t.sent,t.t2=n,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))}}(Sb(e=cb(e,Eb)),bb(t)?t:{next:t})}function Gx(e,t){return function(e,t){var n=new xf;return e.asyncQueue.enqueueAndForget(ie(oe().mark((function r(){return oe().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=j_,r.next=3,Jw(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(Sb(e),t)}function Hx(e,t,n){var r=n.docs.get(t._key),i=new qx(e);return new dx(e,i,t._key,r,new fx(n.hasPendingWrites,n.fromCache),t.converter)}var Qx=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e,r))._firestore=e,i}return ke(n,[{key:"get",value:function(e){var t=this,r=Vx(e,this._firestore),i=new qx(this._firestore);return Qu(le(n.prototype),"get",this).call(this,e).then((function(e){return new dx(t._firestore,i,r._key,e._document,new fx(!1,!1),r.converter)}))}}]),n}(function(){function e(t,n){me(this,e),this._firestore=t,this._transaction=n,this._dataReader=zb(t)}return ke(e,[{key:"get",value:function(e){var t=this,n=Vx(e,this._firestore),r=new Mx(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return gf();var i=e[0];if(i.isFoundDocument())return new cx(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new cx(t._firestore,r,n._key,null,n.converter);throw gf()}))}},{key:"set",value:function(e,t,n){var r=Vx(e,this._firestore),i=Lx(r.converter,t,n),a=Wb(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r,i=Vx(e,this._firestore),a=arguments.length,o=new Array(a>3?a-3:0),u=3;u<a;u++)o[u-3]=arguments[u];return r="string"==typeof(t=st(t))||t instanceof Rb?Jb(this._dataReader,"Transaction.update",i._key,t,n,o):Xb(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,r),this}},{key:"delete",value:function(e){var t=Vx(e,this._firestore);return this._transaction.delete(t._key),this}}]),e}());function Yx(e,t){return function(e,t){var n=new xf;return e.asyncQueue.enqueueAndForget(ie(oe().mark((function r(){var i;return oe().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e){return Hw(e).then((function(e){return e.datastore}))}(e);case 2:i=r.sent,new qw(e.asyncQueue,i,t,n).run();case 4:case"end":return r.stop()}}),r)})))),n.promise}(Sb(e=cb(e,Eb)),(function(n){return t(new Qx(e,n))}))}function $x(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Qb("arrayUnion",t)}function Xx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Yb("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){hf=e}(Kt),Vt(new vt("firestore",(function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new Eb(i,new If(e.getProvider("auth-internal")),new Af(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a}),"PUBLIC")),Xt(cf,"3.4.7",e),Xt(cf,"3.4.7","esm2017")}();function Jx(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new bf("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}function Zx(){if("undefined"===typeof Uint8Array)throw new bf("unimplemented","Uint8Arrays are not available in this environment.")}function eE(){if("undefined"==typeof atob)throw new bf("unimplemented","Blobs are unavailable in Firestore in this environment.")}var tE=function(){function e(t){me(this,e),this._delegate=t}return ke(e,[{key:"toBase64",value:function(){return eE(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return Zx(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(t){return eE(),new e(Ob.fromBase64String(t))}},{key:"fromUint8Array",value:function(t){return Zx(),new e(Ob.fromUint8Array(t))}}]),e}();function nE(e){return function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=e,i=ye(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a in r&&"function"===typeof r[a])return!0}}catch(o){i.e(o)}finally{i.f()}return!1}(e,["next","error","complete"])}var rE=function(){function e(){me(this,e)}return ke(e,[{key:"enableIndexedDbPersistence",value:function(e,t){return function(e,t){Pb(e=cb(e,Eb));var n=Sb(e),r=e._freezeSettings(),i=new Ow;return Ib(n,i,new Pw(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return function(e){Pb(e=cb(e,Eb));var t=Sb(e),n=e._freezeSettings(),r=new Ow;return Ib(t,r,new Rw(r,n.cacheSizeBytes))}(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return function(e){if(e._initialized&&!e._terminated)throw new bf(wf.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var t=new xf;return e._queue.enqueueAndForgetEvenWhileRestricted(ie(oe().mark((function n(){return oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,function(){var e=ie(oe().mark((function e(t){var n;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Uy.vt()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return n=t+"main",e.next=5,Uy.delete(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(mg(e._databaseId,e._persistenceKey));case 3:t.resolve(),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),t.reject(n.t0);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))),t.promise}(e._delegate)}}]),e}(),iE=function(){function e(t,n,r){var i=this;me(this,e),this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:function(){return i.terminate()}},t instanceof rd||(this._appCompat=t)}return ke(e,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||yf("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};db(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return Tb(this._delegate)}},{key:"disableNetwork",value:function(){return Nb(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&ab("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return function(e){return function(e){var t=new xf;return e.asyncQueue.enqueueAndForget(ie(oe().mark((function n(){return oe().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=J_,n.next=3,Jw(e);case 3:return n.t1=n.sent,n.t2=t,n.abrupt("return",(0,n.t0)(n.t1,n.t2));case 6:case"end":return n.stop()}}),n)})))),t.promise}(Sb(e=cb(e,Eb)))}(this._delegate)}},{key:"onSnapshotsInSync",value:function(e){return Kx(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new bf("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new gE(this,mb(this._delegate,e))}catch(t){throw lE(t,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new cE(this,gb(this._delegate,e))}catch(t){throw lE(t,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new pE(this,function(e,t){if(e=cb(e,fb),ib("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new bf(wf.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new pb(e,null,function(e){return new av(Wf.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw lE(t,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return Yx(this._delegate,(function(n){return e(new oE(t,n))}))}},{key:"batch",value:function(){var e=this;return Sb(this._delegate),new uE(new Fx(this._delegate,(function(t){return Gx(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return Db(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return Ab(this._delegate,e).then((function(e){return e?new pE(t,e):null}))}}]),e}(),aE=function(e){ce(n,e);var t=ve(n);function n(e){var r;return me(this,n),(r=t.call(this)).firestore=e,r}return ke(n,[{key:"convertBytes",value:function(e){return new tE(new Ob(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return cE.forKey(t,this.firestore,null)}}]),n}(Ox);var oE=function(){function e(t,n){me(this,e),this._firestore=t,this._delegate=n,this._userDataWriter=new aE(t)}return ke(e,[{key:"get",value:function(e){var t=this,n=kE(e);return this._delegate.get(n).then((function(e){return new dE(t._firestore,new dx(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=kE(e);return n?(Jx("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=kE(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=kE(e);return this._delegate.delete(t),this}}]),e}(),uE=function(){function e(t){me(this,e),this._delegate=t}return ke(e,[{key:"set",value:function(e,t,n){var r=kE(e);return n?(Jx("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=kE(e);2===arguments.length?this._delegate.update(u,t):(o=this._delegate).update.apply(o,[u,t,n].concat(i));return this}},{key:"delete",value:function(e){var t=kE(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),e}(),sE=function(){function e(t,n,r){me(this,e),this._firestore=t,this._userDataWriter=n,this._delegate=r}return ke(e,[{key:"fromFirestore",value:function(e,t){var n=new vx(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new vE(this._firestore,n),null!==t&&void 0!==t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(t,n){var r=e.INSTANCES,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var a=i.get(n);return a||(a=new e(t,new aE(t),n),i.set(n,a)),a}}]),e}();sE.INSTANCES=new WeakMap;var cE=function(){function e(t,n){me(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new aE(t)}return ke(e,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new gE(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new gE(this.firestore,mb(this._delegate,e))}catch(t){throw lE(t,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=st(e))instanceof vb&&kb(this._delegate,e)}},{key:"set",value:function(e,t){t=Jx("DocumentReference.set",t);try{return t?Bx(this._delegate,e,t):Bx(this._delegate,e)}catch(n){throw lE(n,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?zx(this._delegate,e):zx.apply(void 0,[this._delegate,e,t].concat(r))}catch(a){throw lE(a,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return function(e){return Gx(cb(e.firestore,Eb),[new tp(e._key,Uv.none())])}(this._delegate)}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=hE(n),a=fE(n,(function(t){return new dE(e.firestore,new dx(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}));return Wx(this._delegate,i,a)}},{key:"get",value:function(e){var t,n=this;return t="cache"===(null===e||void 0===e?void 0:e.source)?Ux(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=cb(e,vb);var t=cb(e.firestore,Eb);return tb(Sb(t),e._key,{source:"server"}).then((function(n){return Hx(t,e,n)}))}(this._delegate):function(e){e=cb(e,vb);var t=cb(e.firestore,Eb);return tb(Sb(t),e._key).then((function(n){return Hx(t,e,n)}))}(this._delegate),t.then((function(e){return new dE(n.firestore,new dx(n.firestore._delegate,n._userDataWriter,e._key,e._document,e.metadata,n._delegate.converter))}))}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(sE.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(t,n,r){if(t.length%2!==0)throw new bf("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(t.canonicalString()," has ").concat(t.length));return new e(n,new vb(n._delegate,r,new ud(t)))}},{key:"forKey",value:function(t,n,r){return new e(n,new vb(n._delegate,r,t))}}]),e}();function lE(e,t,n){return e.message=e.message.replace(t,n),e}function hE(e){var t,n=ye(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if("object"===typeof r&&!nE(r))return r}}catch(i){n.e(i)}finally{n.f()}return{}}function fE(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=nE(e[0])?e[0]:nE(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var dE=function(){function e(t,n){me(this,e),this._firestore=t,this._delegate=n}return ke(e,[{key:"ref",get:function(){return new cE(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return mx(this._delegate,e._delegate)}}]),e}(),vE=function(e){ce(n,e);var t=ve(n);function n(){return me(this,n),t.apply(this,arguments)}return ke(n,[{key:"data",value:function(e){var t=this._delegate.data(e);return function(e,t){e||gf()}(void 0!==t),t}}]),n}(dE),pE=function(){function e(t,n){me(this,e),this.firestore=t,this._delegate=n,this._userDataWriter=new aE(t)}return ke(e,[{key:"where",value:function(t,n,r){try{return new e(this.firestore,_x(this._delegate,function(e,t,n){var r=t,i=hx("where",e);return new wx(i,r,n)}(t,n,r)))}catch(i){throw lE(i,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(t,n){try{return new e(this.firestore,_x(this._delegate,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=hx("orderBy",e);return new bx(n,t)}(t,n)))}catch(r){throw lE(r,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(t){try{return new e(this.firestore,_x(this._delegate,function(e){return lb("limit",e),new xx("limit",e,"F")}(t)))}catch(n){throw lE(n,"limit()","Query.limit()")}}},{key:"limitToLast",value:function(t){try{return new e(this.firestore,_x(this._delegate,function(e){return lb("limitToLast",e),new xx("limitToLast",e,"L")}(t)))}catch(n){throw lE(n,"limitToLast()","Query.limitToLast()")}}},{key:"startAt",value:function(){try{return new e(this.firestore,_x(this._delegate,Sx.apply(void 0,arguments)))}catch(t){throw lE(t,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){try{return new e(this.firestore,_x(this._delegate,Cx.apply(void 0,arguments)))}catch(t){throw lE(t,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){try{return new e(this.firestore,_x(this._delegate,Tx.apply(void 0,arguments)))}catch(t){throw lE(t,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){try{return new e(this.firestore,_x(this._delegate,Nx.apply(void 0,arguments)))}catch(t){throw lE(t,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return _b(this._delegate,e._delegate)}},{key:"get",value:function(e){var t,n=this;return t="cache"===(null===e||void 0===e?void 0:e.source)?jx(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=cb(e,pb);var t=cb(e.firestore,Eb),n=Sb(t),r=new qx(t);return nb(n,e._query,{source:"server"}).then((function(n){return new px(t,r,e,n)}))}(this._delegate):function(e){e=cb(e,pb);var t=cb(e.firestore,Eb),n=Sb(t),r=new qx(t);return gx(e._query),nb(n,e._query).then((function(n){return new px(t,r,e,n)}))}(this._delegate),t.then((function(e){return new mE(n.firestore,new px(n.firestore._delegate,n._userDataWriter,n._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=hE(n),a=fE(n,(function(t){return new mE(e.firestore,new px(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return Wx(this._delegate,i,a)}},{key:"withConverter",value:function(t){return new e(this.firestore,t?this._delegate.withConverter(sE.getInstance(this.firestore,t)):this._delegate.withConverter(null))}}]),e}(),yE=function(){function e(t,n){me(this,e),this._firestore=t,this._delegate=n}return ke(e,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new vE(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),e}(),mE=function(){function e(t,n){me(this,e),this._firestore=t,this._delegate=n}return ke(e,[{key:"query",get:function(){return new pE(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new vE(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new yE(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new vE(n._firestore,r))}))}},{key:"isEqual",value:function(e){return mx(this._delegate,e._delegate)}}]),e}(),gE=function(e){ce(n,e);var t=ve(n);function n(e,r){var i;return me(this,n),(i=t.call(this,e,r)).firestore=e,i._delegate=r,i}return ke(n,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new cE(this.firestore,e):null}},{key:"doc",value:function(e){try{return new cE(this.firestore,void 0===e?gb(this._delegate):gb(this._delegate,e))}catch(t){throw lE(t,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return function(e,t){var n=cb(e.firestore,Eb),r=gb(e),i=Lx(e.converter,t);return Gx(n,[Wb(zb(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Uv.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new cE(t.firestore,e)}))}},{key:"isEqual",value:function(e){return kb(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new n(this.firestore,e?this._delegate.withConverter(sE.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),n}(pE);function kE(e){return cb(e,vb)}var _E,wE=function(){function e(){me(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._delegate=we(Rb,n)}return ke(e,[{key:"isEqual",value:function(e){return(e=st(e))instanceof Rb&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new e(Gf.keyField().canonicalString())}}]),e}(),bE=function(){function e(t){me(this,e),this._delegate=t}return ke(e,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var t=new Hb("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)}},{key:"delete",value:function(){var t=new Kb("deleteField");return t._methodName="FieldValue.delete",new e(t)}},{key:"arrayUnion",value:function(){var t=$x.apply(void 0,arguments);return t._methodName="FieldValue.arrayUnion",new e(t)}},{key:"arrayRemove",value:function(){var t=Xx.apply(void 0,arguments);return t._methodName="FieldValue.arrayRemove",new e(t)}},{key:"increment",value:function(t){var n=function(e){return new $b("increment",e)}(t);return n._methodName="FieldValue.increment",new e(n)}}]),e}(),xE={Firestore:iE,GeoPoint:Mb,Timestamp:Vf,Blob:tE,Transaction:oE,WriteBatch:uE,DocumentReference:cE,DocumentSnapshot:dE,Query:pE,QueryDocumentSnapshot:vE,QuerySnapshot:mE,CollectionReference:gE,FieldPath:wE,FieldValue:bE,setLogLevel:function(e){!function(e){ff.setLogLevel(e)}(e)},CACHE_SIZE_UNLIMITED:-1};(function(e,t){e.INTERNAL.registerComponent(new vt("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},xE)))})(_E=Gu,(function(e,t){return new iE(e,t,new rE)})),_E.registerVersion("@firebase/firestore-compat","0.1.16");var EE={apiKey:"AIzaSyDs8CaWFY-Cun64ThymTiHcpD5achpDyV8",authDomain:"banda-database.firebaseapp.com",databaseURL:"https://banda-database-default-rtdb.firebaseio.com",projectId:"banda-database",storageBucket:"banda-database.appspot.com",messagingSenderId:"544289795038",appId:"1:544289795038:web:255e10d3dbf4442c6ecb4f",measurementId:"G-V036DKFVH5"};Gu.initializeApp(EE);var SE=Vu(Gu.initializeApp(EE)),CE=Gu.firestore(),IE={firebase:Gu,db:CE,database:SE};function TE(){var e=function(){var e=(0,r.useContext)(_).matches,t=e[e.length-1];return t?t.params:{}}().id,t=u((0,r.useState)([]),2),n=t[0],i=t[1],a=u((0,r.useState)([]),2),o=a[0],s=a[1],c=u((0,r.useState)([]),2),l=c[0],h=c[1];return(0,r.useEffect)((function(){var t=function(){var e=ie(oe().mark((function e(t){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:IE.db.collection("actuaciones").doc(t).get().then((function(e){var t=e.data();s(t),h(t.fecha)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t(e),function(e){Ru(Tu(Vu(),"repertorios/"+e),(function(e){var t=e.val();t&&i(Object.values(t))}))}(e)}),[]),(0,X.jsxs)("div",{className:"container",children:[(0,X.jsxs)("div",{className:"infoHeader text-white",children:[o.isLive?(0,X.jsx)("span",{className:"badge bg-danger blink text-uppercase",children:"En directo"}):(0,X.jsx)("span",{className:"sticky-top text-uppercase",children:"Finalizado"}),(0,X.jsx)("h1",{className:"text-uppercase border rounded mt-3 p-2",children:o.concepto}),(0,X.jsxs)("div",{className:"fs-6",children:[(0,X.jsx)("h6",{className:"",children:o.tipo}),(0,X.jsxs)("p",{className:"font-monospace d-flex text-wrap fs-6",children:[(0,X.jsx)("span",{className:"material-icons",children:"person"}),o.organizador1]}),o.organizador2?(0,X.jsxs)("p",{className:"font-monospace d-flex",children:[(0,X.jsx)("span",{className:"material-icons",children:"person"}),o.organizador2]}):(0,X.jsx)(X.Fragment,{}),(0,X.jsxs)("p",{className:"font-monospace d-flex",children:[(0,X.jsx)("span",{className:"material-icons",children:"location_on"}),o.ubicacion]}),(0,X.jsx)("p",{className:"font-monospace d-flex",children:o.ciudad}),(0,X.jsx)("p",{className:"font-monospace d-flex",children:new Date(1e3*l.seconds).toLocaleString()})]})]}),0===n.length?(0,X.jsx)("p",{children:"No hay datos"}):(0,X.jsxs)("div",{className:"border rounded container scrolleable",children:[n.map((function(e){var t=e.time;return(0,X.jsxs)("div",{className:"row align-items-center border",children:[(0,X.jsx)("div",{className:"col align-middle",children:e.tituloMarcha}),(0,X.jsx)("div",{className:"col",children:(0,X.jsx)("small",{className:"",children:e.compositor})}),"Concierto"!=o.tipo&&"Preg\xf3n"!=o.tipo?(0,X.jsx)("div",{className:"col",children:(0,X.jsx)("small",{className:"",children:e.ubicacion})}):(0,X.jsx)(X.Fragment,{}),"Concierto"!=o.tipo&&"Preg\xf3n"!=o.tipo?(0,X.jsx)("div",{className:"col",children:(0,X.jsx)("small",{className:"",children:t.substring(t.indexOf(",")+2,t.length)})}):(0,X.jsx)(X.Fragment,{})]},e.idRepertorio)})),(0,X.jsxs)("small",{className:"font-monospace text-dark bg-light px-2",children:["Marchas interpretadas: ",n.length]})]})]})}function NE(){var e=u((0,r.useState)([]),2),t=e[0],n=e[1],i=u((0,r.useState)(),2),a=i[0],o=i[1];return(0,r.useEffect)((function(){IE.db.collection("actuaciones").orderBy("fecha","desc").get().then((function(e){var t=[];e.forEach((function(e){var n=e.data();t.push({id:n.idActuacion,concepto:n.concepto,organizador:n.organizador1,fecha:n.fecha,ciudad:n.ciudad,tipo:n.tipo,isLive:n.isLive})})),n(t),o(document.getElementById("table").rows.length-1)}))}),[]),(0,X.jsxs)("div",{className:"container scrolleableTBody",children:[(0,X.jsx)("h1",{children:"Actuaciones"}),(0,X.jsxs)("p",{className:"infoText",children:["Actualmente hay ",(0,X.jsx)("b",{className:"bold",children:a})," eventos en nuestra base de datos"]}),(0,X.jsx)("div",{className:"table-responsive-sm mt-5",children:(0,X.jsxs)("table",{className:"table table-hover",id:"table",children:[(0,X.jsx)("thead",{className:"thead-light",children:(0,X.jsxs)("tr",{className:"text-white",children:[(0,X.jsx)("th",{scope:"col",children:(0,X.jsx)("small",{children:"Concepto"})}),(0,X.jsx)("th",{scope:"col",children:(0,X.jsx)("small",{children:"Organizador"})}),(0,X.jsx)("th",{scope:"col",children:(0,X.jsx)("small",{children:"Ciudad"})}),(0,X.jsx)("th",{scope:"col",children:(0,X.jsx)("small",{children:"Fecha"})}),(0,X.jsx)("th",{scope:"col",children:(0,X.jsx)("small",{children:"Info"})})]})}),(0,X.jsx)("tbody",{className:"scrolleableTBody",children:t.map((function(e){var t=new Date(1e3*e.fecha.seconds).toLocaleString().toString();return(0,X.jsxs)("tr",{className:"trTable",children:[(0,X.jsxs)("td",{className:"align-self-center align-middle",children:[(0,X.jsx)("small",{children:e.concepto}),!0===e.isLive?(0,X.jsx)("span",{className:"material-icons blink toRed",children:"sensors"}):(0,X.jsx)(X.Fragment,{})]}),(0,X.jsx)("td",{className:"limit align-self-center",children:(0,X.jsx)("p",{className:"align-self-center",children:e.organizador})}),(0,X.jsx)("td",{className:"",children:(0,X.jsx)("small",{className:"align-self-center",children:e.ciudad})}),(0,X.jsx)("td",{children:(0,X.jsx)("small",{children:t})}),(0,X.jsx)("td",{children:(0,X.jsx)(Q,{className:"btn btn-outline-light button",to:"/actuaciones/".concat(e.id),children:"Ir"})})]},e.id)}))})]})})]})}function DE(){return(0,X.jsxs)(H,{children:[(0,X.jsx)(J,{}),(0,X.jsxs)(x,{children:[(0,X.jsx)(w,{path:"/",element:(0,X.jsx)(te,{})},1),(0,X.jsx)(w,{path:"/about",element:(0,X.jsx)(Z,{})},2),(0,X.jsx)(w,{path:"/actuaciones",element:(0,X.jsx)(NE,{})},3),(0,X.jsx)(w,{path:"/actuaciones/:id",element:(0,X.jsx)(TE,{})},4),(0,X.jsx)(w,{path:"/dashboard/*",element:(0,X.jsx)(ee,{})},5),(0,X.jsx)(w,{path:"*",element:(0,X.jsx)(ne,{})},6)]})]})}i.render((0,X.jsx)(DE,{}),document.getElementById("root"))}()}();
//# sourceMappingURL=main.d86ec876.js.map